{
    "1": {
        "content": "<h3 id=\"å†™åšå®¢çš„åŸå› \">å†™åšå®¢çš„åŸå› </h3>\n<p>ä¸»è¦æ˜¯å¯¹è‡ªå·±å¹³æ—¶çš„å·¥ä½œåšæŠ€æœ¯æ²‰æ·€ï¼Œç”¨æœ‰é“äº‘ç¬”è®°å…¶å®ä¹Ÿå¤Ÿç”¨ã€‚ä½†æ˜¯æˆ‘è¿˜æ˜¯å¸Œæœ›èƒ½å¤Ÿåœ¨å…¬å…±å¹³å°è¿›è¡Œå‘å¸ƒï¼Œå¸Œæœ›è‡ªå·±é‡åˆ°çš„ä¸€äº›é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆå¯ä»¥å¯¹å…¶ä»–äººæœ‰äº›å¸®åŠ©ã€‚</p>\n<h3 id=\"æŠ€æœ¯é€‰å‹\">æŠ€æœ¯é€‰å‹</h3>\n<p>å¯¹è‡ªå·±çš„æŠ€æœ¯åšå®¢é€‰å‹äº†å¾ˆä¹…ï¼Œæœ€åè¿˜æ˜¯é€‰æ‹©äº†githubã€‚ä¸»è¦åŸå› è¿˜æ˜¯å› ä¸ºæ‡’ï¼Œgithub issuesä½œä¸ºCMSå®Œå…¨å¤Ÿç”¨äº†ã€‚åç»­é…åˆSSGç”Ÿäº§é™æ€ç½‘é¡µæ˜¯æ¯”è¾ƒå¥½çš„æ–¹æ¡ˆäº†ã€‚</p>\n<h3 id=\"å†™åœ¨æœ€å\">å†™åœ¨æœ€å</h3>\n<p>ç°åœ¨æ˜¯2022å¹´çš„1æœˆï¼Œå¸Œæœ›ä»ä»Šå¹´å¼€å§‹èƒ½å¤Ÿç»å¸¸è¿›è¡Œå†™ä½œï¼Œæé«˜è‡ªå·±çš„æ–‡å­—è¡¨è¾¾èƒ½åŠ›ã€‚</p>\n",
        "title": "ç¬¬ä¸€ç¯‡åšå®¢",
        "created": "2022-01-16 13:10:28  ",
        "updated": "2022-05-25 13:32:29 ",
        "excerpt": "å†™åšå®¢çš„åŸå›  ä¸»è¦æ˜¯å¯¹è‡ªå·±å¹³æ—¶çš„å·¥ä½œåšæŠ€æœ¯æ²‰æ·€ï¼Œç”¨æœ‰é“äº‘ç¬”è®°å…¶å®ä¹Ÿå¤Ÿç”¨ã€‚ä½†æ˜¯æˆ‘è¿˜æ˜¯å¸Œæœ›èƒ½å¤Ÿåœ¨å…¬å…±å¹³å°è¿›è¡Œå‘å¸ƒï¼Œå¸Œæœ›è‡ªå·±é‡åˆ°çš„ä¸€äº›é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆå¯ä»¥å¯¹å…¶ä»–äººæœ‰äº›å¸®åŠ©ã€‚ æŠ€æœ¯é€‰å‹ å¯¹è‡ªå·±çš„æŠ€æœ¯åšå®¢é€‰å‹äº†å¾ˆä¹…ï¼Œæœ€åè¿˜æ˜¯é€‰æ‹©äº†githubã€‚ä¸»è¦åŸå› ...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "1"
    },
    "2": {
        "content": "<p>ç°ä»£å‰ç«¯å¼€å‘éƒ½è®²ç©¶æ¨¡å—åŒ–å¼€å‘ï¼Œä½œä¸ºæ‰“åŒ…ç•Œçš„æ‰›æŠŠå­ï¼ŒWebpackå¯¹ä¸æ•´ä¸ªå‰ç«¯ç”Ÿæ€æœ‰ç€å·¨å¤§çš„å½±å“ã€‚ä½†æ˜¯éšç€Vite,ESBuildç­‰åèµ·ä¹‹ç§€çš„å´›èµ·ï¼Œwebpackæœ¬èº«å­˜åœ¨çš„é—®é¢˜å°±æ„ˆå‘æ˜æ˜¾ã€‚æ— è®ºæ˜¯ç¹ççš„é…ç½®æ–‡ä»¶ï¼Œè¿˜æ˜¯å¥‡æ…¢æ— æ¯”çš„æ„å»ºé€Ÿåº¦éƒ½ä»¤äººæœ›è€Œå´æ­¥ã€‚ </p>\n<p>Webpackå®˜æ–¹ä¹ŸçŸ¥é“è‡ªèº«çš„é—®é¢˜ï¼Œäºæ˜¯Webpack 5 æ¥äº†</p>\n<h1 id=\"1-å®ƒçš„å˜åŒ–\">1. å®ƒçš„å˜åŒ–</h1>\n<p>ç‰ˆæœ¬æ¥åˆ°äº†5ï¼ŒWebpackæœ‰äº†ä»¥ä¸‹è¿™äº›å˜åŒ–ï¼š</p>\n<h2 id=\"11-åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„ç¼“å­˜\">1.1 åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„ç¼“å­˜</h2>\n<pre><code class=\"language-jsx\">{\n    cache: &quot;filesystem&quot;\n}\n</code></pre>\n<p>æ–°å¢çš„ç¼“å­˜çš„åŠŸèƒ½è®©å¼€å‘è€…åœ¨é¦–æ¬¡æ„å»ºåäº«å—ç¼“å­˜å¸¦æ¥çš„æ„å»ºé€Ÿåº¦æå‡ï¼ˆæ˜¯çš„ï¼Œé¦–æ¬¡è¿˜æ˜¯å¾ˆæ…¢ï¼‰ï¼Œå®é™…æµ‹è¯•åï¼Œæ— è®ºæ˜¯ç›´æ¥æ„å»ºè¿˜æ˜¯çƒ­æ›´æ–°å¼€å‘ï¼Œé¦–æ¬¡ä¹‹åçš„é‡æ–°æ„å»ºæ—¶é—´åªæœ‰å‡ ç§’ï¼Œçƒ­æ›´æ–°ç”šè‡³å°‘äº1s.</p>\n<p>å¼€å¯äº†è¿™ä¸ªåŠŸèƒ½ä¹‹åï¼Œä¼šåœ¨<code>node_modules</code>æ–‡ä»¶ä¸‹å¤šä¸€ä¸ª<code>.cache</code>çš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢ä¼šå­˜æ”¾ä¹‹å‰æ„å»ºäº§ç”Ÿçš„ç¼“å­˜ã€‚ä½†æ˜¯è¿™ä¸ªåŠŸèƒ½è¿˜æ˜¯å­˜åœ¨é—®é¢˜ï¼Œç”±äºç¼“å­˜çš„å­˜åœ¨ï¼Œ<strong>æ–°æ·»åŠ çš„æ’ä»¶æˆ–è€…çƒ­æ›´æ–°è¢«æ‰“æ–­åé‡æ–°è¿è¡Œéƒ½æœ‰å‡ ç‡æŠ¥é”™</strong>ã€‚é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œåˆ é™¤<code>.cache</code>æ–‡ä»¶å¤¹å°±å¥½äº†\n<img src=\"https://user-images.githubusercontent.com/26271337/168218613-bf34cc73-facf-4c9c-a66c-f0c73ba3fdd5.png\" alt=\"image\"></p>\n<h2 id=\"12-asset-modules\">1.2 Asset Modules</h2>\n<p>Webpack 5 æ–°å¢äº†Asset Module,å–ä»£äº†ä¹‹å‰ç‰ˆæœ¬éœ€è¦ä¸‹è½½çš„ <code>raw-load,</code> <code>url-loader</code>, <code>file-loader</code>.</p>\n<p>Asset Modulesæ€»å…±æœ‰å››ç§ç±»å‹</p>\n<ol>\n<li><p>asset/resource </p>\n<p> ç”¨äºæ–‡ä»¶çš„å¤„ç†ï¼Œæ›¿æ¢äº†<code>file-loader</code></p>\n<pre><code class=\"language-jsx\">{\n    test: /\\.(mp4|mp3|wav)$/,\n    type: &#39;asset/resource&#39;,\n    generator: {\n        filename: &#39;res/video/[name][ext]&#39;,\n    }\n},\n</code></pre>\n</li>\n<li><p>asset/inline </p>\n<p>   æ›¿æ¢äº† <code>url-loader</code>, ä¼šå°†æ–‡ä»¶è½¬åŒ–ä¸ºdata URL</p>\n</li>\n<li><p>asset/source </p>\n<p> æ›¿æ¢äº† <code>raw-loader</code> ,ä¼šç›´æ¥å¯¼å…¥æ–‡ä»¶çš„å†…å®¹</p>\n</li>\n<li><p>asset (é»˜è®¤)</p>\n<p> ä¼šè‡ªåŠ¨é€‰æ‹©ç”Ÿäº§æ–‡ä»¶è¿˜æ˜¯ç”Ÿæˆdata URL, å¯ä»¥è¿›è¡Œè®¾ç½®maxSizeæ¥è¿›è¡Œåˆ¤æ–­å¤„ç†</p>\n</li>\n</ol>\n<pre><code class=\"language-jsx\">{\n    test: /\\.(woff2|ttf|woff|png|svg|eot|jpg)$/,\n    type: &#39;asset&#39;,\n    parser: {\n        dataUrlCondition: {\n            maxSize: 100000\n        }\n    },\n    generator: {\n        filename: &#39;res/[hash][ext]&#39;,\n    }\n}\n</code></pre>\n<p>å› ä¸ºWebpack å†…ç½®äº†è¿™ä¸ªæ‰€ä»¥ä¹‹å‰çš„<code>url-loader</code>  ç­‰ä¾èµ–ä¹Ÿæ— æ³•åœ¨Webpack 5ä¸‹ç”Ÿæ•ˆ</p>\n<h2 id=\"13-module-federation\">1.3 Module Federation</h2>\n<p>Webpack 5çš„æ›´æ–°ä¸­ï¼Œè¿™ä¸ªåŠŸèƒ½æœ€æœ‰ç”¨ï¼ˆæˆ‘è¯´çš„ï¼‰ã€‚Module Federation å³æ¨¡å—è”é‚¦ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®åå¯ä»¥è®©å½“å‰é¡¹ç›®å…±äº«å…¶ä»–é¡¹ç›®çš„ä»£ç ï¼Œä¹Ÿå¯ä»¥å…±äº«æœ¬èº«çš„ä»£ç ç»™å…¶ä»–æœåŠ¡ã€‚ </p>\n<p>åœ¨å®é™…ä½¿ç”¨ä¸­å°±å¯ä»¥ç”¨æ¥åšç»„ä»¶åº“ï¼Œç„¶åå…±äº«ç»™æ‰€æœ‰é¡¹ç›®ã€‚å®Œç¾è§£å†³äº†ä»¥å¾€é€šç”¨ç»„ä»¶åº“å­˜åœ¨çš„ç—›ç‚¹ï¼Œå³æ¯æ¬¡æ›´æ–°åï¼Œæ‰€æœ‰ä½¿ç”¨åˆ°ç»„ä»¶åº“çš„æœåŠ¡éƒ½éœ€è¦é‡æ–°è¿›è¡Œä¾èµ–ä¸‹è½½å’Œæ„å»ºã€‚ è€ŒModule Federationåªç”¨æ„å»ºç»„ä»¶åº“å³å¯ï¼Œä¾èµ–ç»„ä»¶åº“çš„æœåŠ¡å¯ä»¥ç›´æ¥ä½¿ç”¨åˆ°æœ€æ–°çš„ç»„ä»¶ã€‚</p>\n<p>Module Federation çš„é…ç½®å¦‚ä¸‹</p>\n<pre><code class=\"language-jsx\">// æœåŠ¡\nnew ModuleFederationPlugin({\n    name: &#39;service-name&#39;,\n    remotes: {\n        microFE: `microFE@http://localhost:7777/remoteEntry.js`\n    },\n    shared: {\n        ...deps\n    }\n})\n// ç»„ä»¶åº“\nnew ModuleFederation({\n    name: &quot;microFE&quot;,\n    filename: &#39;remoteEntry.js&#39;,\n    exposes: {\n        &#39;./Button&#39;: &#39;./src/components/Button/index.vue&#39;,\n    },\n        shared: {\n            ...deps, // packjson.dependencies\n            vue: ..., // æœ‰äº›æ¨¡å—éœ€è¦å£°æ˜å…±äº«çš„ç¨‹åº¦\n        }\n})\n</code></pre>\n<p>æœåŠ¡æœ¬èº«è¦åˆ‡æ¢æˆåŠ¨æ€å¯¼å…¥çš„æ¨¡å¼</p>\n<pre><code class=\"language-jsx\">// main.js å…¥å£æ–‡ä»¶\nimport(&#39;bootloader.js&#39;)\n</code></pre>\n<pre><code class=\"language-jsx\">// main.js å…¥å£æ–‡ä»¶\nimport(&#39;bootloader.js&#39;)\n\n// bootloader.js\nimport Vue from &#39;vue\nimport App from &#39;App.vue&#39;\n\nnew Vue({\n    render: h =&gt; h(App)\n}).$mount(&quot;#app&quot;)\n\n// é¡µé¢ä¸­ä½¿ç”¨\nimport Button from &#39;microFE/Button&#39;\n</code></pre>\n<p>Module Federation æœ¬èº«çš„åŸç†è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œå°±æ˜¯åˆ©ç”¨åŠ¨æ€å¯¼å…¥æ‰“åŒ…æˆå•ç‹¬çš„åŒ…ï¼Œç„¶åå…¶ä»–æœåŠ¡ä½¿ç”¨æ—¶é€šè¿‡urlåŠ è½½å¯¹åº”çš„bundleå³å¯ã€‚æœ‰äº†è¿™ä¸ªç‰¹æ€§æ— è®ºå‰ç«¯æ¡†æ¶æ˜¯ä»€ä¹ˆï¼Œéƒ½å¯ä»¥åšåˆ°ç»„ä»¶å…±äº«ã€‚</p>\n<p>ç„¶åè®²ä¸€ä¸‹é…ç½®é¡¹</p>\n<ul>\n<li>name: &#39;service-name&#39;  å®šä¹‰æœåŠ¡çš„åç§°</li>\n<li>remotes  å…±äº«çš„æœåŠ¡çš„åœ°å€</li>\n<li>shared å£°æ˜å…¬ç”¨çš„ä¾èµ–</li>\n<li>exposed å£°æ˜æš´éœ²ç»™å…¶ä»–æœåŠ¡ä½¿ç”¨çš„æ¨¡å—</li>\n<li>filename æœåŠ¡æ„å»ºåç”Ÿäº§çš„å•ç‹¬æ–‡ä»¶ï¼Œç”¨äºå…¶ä»–æœåŠ¡remotesä½¿ç”¨</li>\n</ul>\n<h1 id=\"14-å…¶ä»–ä¿®æ”¹\">1.4 å…¶ä»–ä¿®æ”¹</h1>\n<p>Webpack 5è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ä¿®æ”¹ï¼Œä¾‹å¦‚ä¸€äº›é…ç½®é¡¹çš„æ›´æ”¹, å†…ç½®äº†Terserè¿›è¡Œä»£ç å‹ç¼©ç­‰ã€‚</p>\n<h1 id=\"2-å­˜åœ¨çš„é—®é¢˜\">2. å­˜åœ¨çš„é—®é¢˜</h1>\n<p>æ–°çš„ç‰ˆæœ¬ï¼Œæ–°çš„åŠŸèƒ½ã€‚æ€»çš„æ¥è¯´å¯¹äºå¼€å‘è€…çš„ä½¿ç”¨ä½“éªŒæœ‰äº†å¾ˆå¤§çš„æå‡ã€‚</p>\n<p>åœ¨å‡çº§çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°äº†ä¸€äº›é—®é¢˜ï¼š</p>\n<ol>\n<li>plugin çš„å†™æ³•è¿˜æ˜¯è¿‡äºå¤æ‚ï¼Œç”¨æˆ·è‡ªå®šä¹‰æ’ä»¶å¼€å‘ä½“éªŒè¿˜æ˜¯å¾ˆç³Ÿç³•</li>\n<li>é¦–æ¬¡æ„å»ºé€Ÿåº¦å˜æ…¢äº†ï¼Œå› ä¸ºå†…ç½®äº†Terser</li>\n<li>å¼•å…¥çš„ç¼“å­˜ç³»ç»Ÿå¯¼è‡´æ„å»ºæ—¶çš„æŠ¥é”™</li>\n</ol>\n",
        "title": "Webpack 5 çš„å˜åŒ–",
        "created": "2022-05-10 15:31:41  ",
        "updated": "2022-10-20 13:50:21 ",
        "excerpt": "ç°ä»£å‰ç«¯å¼€å‘éƒ½è®²ç©¶æ¨¡å—åŒ–å¼€å‘ï¼Œä½œä¸ºæ‰“åŒ…ç•Œçš„æ‰›æŠŠå­ï¼ŒWebpackå¯¹ä¸æ•´ä¸ªå‰ç«¯ç”Ÿæ€æœ‰ç€å·¨å¤§çš„å½±å“ã€‚ä½†æ˜¯éšç€Vite,ESBuildç­‰åèµ·ä¹‹ç§€çš„å´›èµ·ï¼Œwebpackæœ¬èº«å­˜åœ¨çš„é—®é¢˜å°±æ„ˆå‘æ˜æ˜¾ã€‚æ— è®ºæ˜¯ç¹ççš„é…ç½®æ–‡ä»¶ï¼Œè¿˜æ˜¯å¥‡æ…¢æ— æ¯”çš„æ„å»ºé€Ÿåº¦éƒ½ä»¤äººæœ›è€Œ...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "2"
    },
    "3": {
        "content": "<h1 id=\"1-å†™åœ¨å‰é¢\">1. å†™åœ¨å‰é¢</h1>\n<p>Webpack ä½œä¸ºæ„å»ºå·¥å…·ï¼Œå‰ç«¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å¯ä»¥æ ¹æ®è‡ªèº«é¡¹ç›®çš„å®é™…æƒ…å†µè¿›è¡Œç›¸å…³é…ç½®ã€‚åˆç†çš„é…ç½®å¯¹äºå¼€å‘å’Œæ„å»ºé€Ÿåº¦æœ‰ç€ååˆ†æ˜¾è‘—çš„æå‡ã€‚å› æ­¤æœ¬æ–‡æˆ‘ä»¬æ¥äº†è§£ä¸‹webpackä¼˜åŒ–ç›¸å…³çš„çŸ¥è¯†ç‚¹</p>\n<h1 id=\"2-å…·ä½“æ–¹æ³•\">2. å…·ä½“æ–¹æ³•</h1>\n<ol>\n<li><p>cache  ğŸ’¯</p>\n<pre><code class=\"language-jsx\">cache: {\n    type: &#39;filesystem&#39;\n}\n</code></pre>\n<p>  Webpack 5æ–°å¢äº†åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„ç¼“å­˜ï¼Œé¦–æ¬¡æ„å»ºåçš„é‡æ–°æ„å»ºé€Ÿåº¦ååˆ†å¿«é€Ÿ</p>\n</li>\n<li><p>symlinks(ä¸€èˆ¬ï¼Œæœ‰å°‘é‡æå‡)</p>\n<p> é¡¹ç›®æœªä½¿ç”¨npm linkæ—¶å¯ä»¥å°†symlinksè®¾ç½®ä¸ºfalse, ä¹Ÿä¼šå‡å°‘æ„å»ºæ—¶é—´</p>\n<pre><code class=\"language-jsx\">resolve: {\n    symlinks: false,\n}\n</code></pre>\n</li>\n<li><p>æ–‡ä»¶å‹ç¼©å’Œä»£ç æŠ½ç¦»ï¼ˆ ğŸ‘ï¼‰</p>\n<p> Webpack 5å†…ç½®äº†Terser, å¯ä»¥åœ¨ <code>optimization/minimizer</code> ä¸­å¯¹TerserPluginè¿›è¡Œè¯¦ç»†é…ç½®</p>\n<p> <code>css-minimizer-webpack-plugin</code> ç”¨æ¥å‹ç¼©css</p>\n<p> é€šè¿‡ <code>splitChunks</code>ä¸­è¿›è¡Œé…ç½®ï¼Œå¯ä»¥å°†å¸¸ç”¨çš„å…¬å…±æ¨¡å—æå–åˆ°å…¥å£chunkä¸­</p>\n<p> é€šè¿‡<code>mini-css-extract-plugin</code> å°†æ‰€æœ‰çš„cssæå–åˆ°å•ç‹¬æ–‡ä»¶ä¸­</p>\n<p> <code>purgecss-webpack-plugin</code>  å¯ä»¥åˆ†ç¦»å‡ºæœªä½¿ç”¨çš„css</p>\n</li>\n<li><p>tree-shaking( ğŸ‘)</p>\n<p> å¯ä»¥é€šè¿‡package.json ä¸­çš„sideEffectæ¥æ ‡è®°æœ‰å‰¯ä½œç”¨çš„æ–‡ä»¶ï¼ˆéESMæ¨¡å—ï¼‰ï¼Œtree-shakingé€šè¿‡ESMè¿›è¡Œä»£ç ä¼˜åŒ–ï¼Œå°†æœªä½¿ç”¨çš„ä»£ç å‰”é™¤å‡ºå»ã€‚</p>\n<p> å¯¹äºç¬¬ä¸‰æ–¹çš„åŒ…ï¼Œå¦‚æœæœ‰æä¾›ESåŒ…çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å¼•ç”¨ä¸‰æ–¹åŒ…çš„ESåŒ…æ¥ä½¿ç”¨</p>\n</li>\n<li><p>é™æ€æ–‡ä»¶å¤„ç†( ğŸ‘)</p>\n<p>  å¯¹äºé¡¹ç›®ä¸­å­˜åœ¨çš„é™æ€æ–‡ä»¶ï¼Œä¾‹å¦‚å›¾ç‰‡ç­‰ï¼Œå¯ä»¥ä¸Šä¼ åˆ°cdn,æé«˜è®¿é—®é€Ÿåº¦çš„</p>\n<pre><code class=\"language-jsx\">output: {\n    publicPath: isProd?&#39;${cdnPath}&#39;:&#39;&#39;\n}\n</code></pre>\n</li>\n<li><p>ç¬¬ä¸‰æ–¹åº“å¤„ç†(ä¸€èˆ¬)</p>\n<p> é€šè¿‡ <code>webpack-bundle-analyzer</code>  æ’ä»¶æ˜¾ç¤ºæ‰“åŒ…åæ¯ä¸ªæ¨¡å—æ‰€å ç”¨çš„å¤§å°ï¼Œå¯ä»¥å¯¹æ‰“åŒ…ä½“ç§¯åˆ†æ</p>\n<p> å¯¹äºå ç”¨ä½“ç§¯è¾ƒå¤§çš„ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œå¯ä»¥è€ƒè™‘cdnå¼•å…¥ï¼Œå‡å°‘æ‰“åŒ…ä½“ç§¯</p>\n</li>\n<li><p>JSå¤„ç†( ğŸ’¯)</p>\n<p>  å¯ä»¥ä½¿ç”¨ <code>esbuild-loader</code> æ›¿æ¢<code>babel-loader</code>  æ¥å¤„ç†JSæ–‡ä»¶ï¼Œå¯¹äºæ„å»ºé€Ÿåº¦æœ‰å¾ˆå¤§çš„æå‡</p>\n<p> åŒæ—¶<code>ESBuildMinifyPlugin</code> æ’ä»¶å¯ä»¥ä»£æ›¿<code>TerserPlugin</code>æ’ä»¶è¿›è¡Œè¦é”ä»£ç </p>\n</li>\n</ol>\n",
        "title": "Webpack ä¼˜åŒ–",
        "created": "2022-05-11 14:21:16  ",
        "updated": "2022-06-27 15:27:40 ",
        "excerpt": "1. å†™åœ¨å‰é¢ Webpack ä½œä¸ºæ„å»ºå·¥å…·ï¼Œå‰ç«¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å¯ä»¥æ ¹æ®è‡ªèº«é¡¹ç›®çš„å®é™…æƒ…å†µè¿›è¡Œç›¸å…³é…ç½®ã€‚åˆç†çš„é…ç½®å¯¹äºå¼€å‘å’Œæ„å»ºé€Ÿåº¦æœ‰ç€ååˆ†æ˜¾è‘—çš„æå‡ã€‚å› æ­¤æœ¬æ–‡æˆ‘ä»¬æ¥äº†è§£ä¸‹webpackä¼˜åŒ–ç›¸å…³çš„çŸ¥è¯†ç‚¹ 2. å…·ä½“æ–¹æ³• cache ğŸ’¯ `j...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "3"
    },
    "4": {
        "content": "<h1 id=\"tldr\">TL.DR</h1>\n<p>å‰ç«¯å¼€å‘å·²ç»å‡ å¹´äº†ï¼Œå¯¹äºä¸šåŠ¡åœºæ™¯ä¸­çš„ç»„ä»¶å¼€å‘ä¹Ÿæœ‰è‡ªå·±çš„ä¸€äº›å¿ƒå¾—ã€‚å¹³æ—¶å¼€å‘ä¸­é‡åˆ°çš„ç—›ç‚¹å’Œç–‘æƒ‘ä¹‹å¤„ä¹Ÿå¸¸å¸¸ä»¤æˆ‘çƒ¦èºã€‚å› æ­¤ä¸‹æ–‡å°†è°ˆè°ˆæˆ‘å¯¹ç»„ä»¶å¼€å‘å’Œè®¾è®¡çš„ç†è§£ã€‚</p>\n<h1 id=\"1-what-why\">1. What? Why?</h1>\n<p>ç»„ä»¶åŒ–å°±æ˜¯å°†ä¸šåŠ¡é€»è¾‘è¿›è¡ŒæŠ½ç¦»ï¼Œå°†ä¸åŒçš„ä¸šåŠ¡é€»è¾‘æŠ½ç¦»æˆä¸åŒçš„æ–‡ä»¶ï¼Œé¿å…ä»£ç çš„è€¦åˆï¼Œæ–¹ä¾¿å¤ç”¨å’Œç»´æŠ¤ã€‚</p>\n<h2 id=\"11-æŠ½ç¦»ï¼Œé™ä½è€¦åˆ\">1.1 æŠ½ç¦»ï¼Œé™ä½è€¦åˆ</h2>\n<p>å¹³æ—¶å¼€å‘ä¸­æ¥æ‰‹å’Œç»´æŠ¤æ—§ä»£ç ï¼Œé‡åˆ°ä¸Šåƒè¡Œçš„ç»„ä»¶ï¼Œæ•´ä¸ªäººéƒ½å¿«è¦æ˜å¥äº†ã€‚</p>\n<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¸¸è§çš„è¡¨æ ¼æ•°æ®å±•ç¤ºé¡µé¢ä¼šä¼´éšç€ç›¸å…³çš„æ•°æ®æ“ä½œã€‚ä¸åŒçš„æ“ä½œå¾€å¾€ä¼šæœ‰ä¸åŒçš„æ•°æ®å’Œæ¥å£å¤„ç†ï¼Œè¿™ä¸ªæ—¶å€™å°†å¯¹åº”æ“ä½œçš„å¼¹çª—æŠ½ç¦»ä¸ºå•ä¸ªç»„ä»¶ï¼Œå°†ç›¸å…³çš„æ•°æ®éš”ç¦»åœ¨ç»„ä»¶ä¸­ï¼Œå¯¹ä¸»ç»„ä»¶çš„å½±å“å°½é‡é™ä½æ˜¯æ¯”è¾ƒå¥½çš„åšæ³•ã€‚ </p>\n<p>åä¾‹åˆ™æ˜¯å°†æ•°æ®çš„æ–°å¢ï¼Œç¼–è¾‘ç­‰å¼¹çª—æ“ä½œï¼ŒçŠ¶æ€éƒ½ç»´æŠ¤åœ¨ä¸»é¡µé¢ä¸­ã€‚åæœŸçš„éœ€æ±‚å˜æ›´å’Œæ•°æ®æ›´è¿­ä¼šè®©å½“å‰é¡µé¢çš„é€»è¾‘è¶Šæ¥è¶Šæ··ä¹±ã€‚</p>\n<h2 id=\"12-å¤ç”¨ï¼Œdry\">1.2 å¤ç”¨ï¼ŒDRY</h2>\n<p>å¤ç”¨å…¶å®å¤§å®¶éƒ½å¾ˆèƒ½ç†è§£ï¼Œå¹³æ—¶ä½¿ç”¨çš„UIåº“éƒ½æ˜¯å¤ç”¨çš„ç»„ä»¶ã€‚å¯¹äºå¹³æ—¶å¼€å‘çš„ç»„ä»¶ï¼Œæˆ‘ä¹ æƒ¯åˆ†ä¸ºä¸šåŠ¡ç»„ä»¶å’Œé€šç”¨ç»„ä»¶ã€‚</p>\n<p><strong>é€šç”¨ç»„ä»¶</strong>å°±æ˜¯åŸºæœ¬çš„ç»„æˆå…ƒç´ ï¼Œä¾‹å¦‚è¡¨å•ï¼ŒæŒ‰é’®ç­‰ã€‚å¯¹äºæˆ‘ä»¬çš„ä¸šåŠ¡ç³»ç»Ÿï¼Œæ²‰æ·€å‡ºè‡ªå·±çš„é€šç”¨ç»„ä»¶åº“ï¼Œå¯¹äºä¸šåŠ¡è®¾è®¡ç³»ç»Ÿçš„ä¸€è‡´æ€§æœ‰å¾ˆå¤§çš„ç”¨å¤„ã€‚å¦‚æœä¸€ä¸ªappçš„å„ç§æŒ‰é’®å’Œè¾“å…¥éƒ½ä¸ä¸€è‡´çš„è¯ï¼Œå¯èƒ½æ²¡ä»€ä¹ˆç”¨æˆ·æƒ³å»ä½¿ç”¨ã€‚ </p>\n<p><strong>ä¸šåŠ¡ç»„ä»¶</strong>å°±æ˜¯é’ˆå¯¹å½“å‰ä¸šåŠ¡çš„ç»„ä»¶ï¼Œä¾‹å¦‚å¼€å‘æ—¶éœ€è¦ä»˜æ¬¾ç å¼¹çª—ï¼Œå¥½çš„æ–¹æ³•æ˜¯æŠ½ç¦»ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ç»„ä»¶ï¼Œåœ¨ä¸åŒéœ€è¦è°ƒç”¨æ”¯ä»˜çš„åœ°æ–¹è¿›è¡Œä½¿ç”¨ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªæ”¯ä»˜çš„åœ°æ–¹éƒ½é‡å†™ç›¸å…³çš„é€»è¾‘ã€‚è¿™æ ·åç»­æ›´æ”¹ä»˜æ¬¾ç çš„é€»è¾‘ï¼Œä¾‹å¦‚æ¥å£è°ƒç”¨æˆ–è€…æ ¡éªŒä¹‹ç±»çš„éƒ½ååˆ†æ–¹ä¾¿ã€‚</p>\n<p>æ•´ä¸ªä¸–ç•Œéƒ½æ˜¯ç†µå¢çš„ï¼Œå†åŸºç¡€çš„ä¸šåŠ¡éšç€ä¸æ–­çš„çš„è¿­ä»£ï¼Œéƒ½ä¼šå˜å¾—è¶Šæ¥è¶Šå¤æ‚ã€‚ä½œä¸ºå¼€å‘äººå‘˜ï¼Œåº”è¯¥ä¸¥æ ¼è¦æ±‚è‡ªå·±ã€‚å¯¹äºæ–°å¼€å‘çš„åŠŸèƒ½ï¼Œè¦æƒ³å¦‚æœç§»é™¤è¿™ä¸ªåŠŸèƒ½æ‰€éœ€çš„æ—¶é—´å’Œä»£ç æ”¹åŠ¨æ˜¯å¦åˆç†ï¼Œå½“å‰çš„ç»“æ„æ˜¯å¦æ»¡è¶³æ–°çš„éœ€æ±‚ï¼Œè¿™äº›éƒ½æ˜¯éœ€è¦å»å¥½å¥½æ€è€ƒçš„ã€‚å¼€å‘æ—¶é—´å’Œå¼€å‘è´¨é‡å¾ˆå¤šæ—¶å€™å¹¶ä¸æ˜¯å–èˆçš„é—®é¢˜ï¼Œåœ¨å±å±±ä¸Šæ‹‰å±æ˜¯é¿å…ä¸äº†çš„ï¼Œä½†æ˜¯åœ¨å‰æœŸå¯ä»¥é¿å…ä½†æ˜¯ä¸ºäº†çœäº‹è€ŒæŒ–æ›´å¤šçš„å‘ç®€ç›´å°±æ˜¯ ğŸ‘</p>\n<h1 id=\"2-how\">2. How?</h1>\n<p>å¼€å‘äººå‘˜å¦‚ä½•å»æ‹†åˆ†ç»„ä»¶å‘¢ï¼Ÿæˆ‘çš„æ–¹æ³•æ˜¯æ‰¾<code>å…³ç³»</code></p>\n<ol>\n<li>ä»¥é¡µé¢ä½œä¸ºåŸºæœ¬å•ä½ï¼Œå¦‚æœå‡ ä¸ªé¡µé¢éƒ½æœ‰ç›¸åŒçš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘æŠ½ç¦»å…¬ç”¨ï¼›</li>\n<li>å¦‚æœæŸä¸ªéƒ¨åˆ†çš„ä¸šåŠ¡é€»è¾‘ç›¸å¯¹ç‹¬ç«‹ï¼Œåªéœ€è¦å½“å‰é¡µé¢æä¾›å¾ˆå°‘çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆè¯·æŠ½ç¦»ã€‚</li>\n<li>ç»†åŒ–ç»„ä»¶çš„åŠŸèƒ½ï¼Œä¸è¦è´Ÿè´£å¤ªå¤šçš„é€»è¾‘ã€‚ä¸åŒåœºæ™¯å¯¹åº”ä¸åŒçš„ç»„ä»¶ï¼Œæ¯”æ‹¥æœ‰ä¸åŒåœºæ™¯çš„ç»„ä»¶è¦å¥½çš„å¤šï¼ŒUIè¦å…¬ç”¨ï¼Œé€»è¾‘è¦å°‘æ··ç”¨ã€‚</li>\n</ol>\n<p>å…¶å®ç»„ä»¶æ‹†åˆ†å¹¶ä¸éº»çƒ¦ï¼Œä¸åŒçš„å¼€å‘äººå‘˜æœ‰ä¸åŒçš„ç†è§£ã€‚æœ€å¥½çš„å‡†åˆ™å°±æ˜¯ <code>å¥½è¯»ï¼Œå¥½æ”¹</code>ã€‚</p>\n<h1 id=\"3-åœ¨æ¡†æ¶ä¸Šçš„ä½“ç°\">3. åœ¨æ¡†æ¶ä¸Šçš„ä½“ç°</h1>\n<p>å‰ç«¯çš„æ¡†æ¶æœ‰å¾ˆå¤šï¼Œéƒ½æ”¯æŒç»„ä»¶åŒ–çš„å¼€å‘ã€‚ç”±äºæ¡†æ¶æœ¬èº«çš„å®ç°åŸç†å’Œè®¾è®¡é£æ ¼ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬åœ¨ç”¨ä¸åŒçš„æ¡†æ¶è¿›è¡Œå¼€å‘æ—¶ä¹Ÿä¼šæœ‰å¯¹åº”çš„å¼€å‘å¿ƒå¾—ã€‚</p>\n<p>æ¯ä¸ªæ¡†æ¶éƒ½æœ‰è‡ªå·±çš„ç‰¹ç‚¹ï¼Œç»„ä»¶ä¸­çš„é€šä¿¡ï¼Œæ•°æ®ä¼ é€’éƒ½æœ‰å·®å¼‚ã€‚åé¢æˆ‘ä¼šæœ‰å¯¹åº”æ¡†æ¶çš„æ–‡ç« æ¥ä»‹ç»å®ƒä»¬å„è‡ªçš„ä¼˜ç¼ºç‚¹ã€‚</p>\n",
        "title": "ç»„ä»¶å¼€å‘å’Œè®¾è®¡",
        "created": "2022-06-05 14:13:43  ",
        "updated": "2022-06-05 16:12:20 ",
        "excerpt": "TL.DR å‰ç«¯å¼€å‘å·²ç»å‡ å¹´äº†ï¼Œå¯¹äºä¸šåŠ¡åœºæ™¯ä¸­çš„ç»„ä»¶å¼€å‘ä¹Ÿæœ‰è‡ªå·±çš„ä¸€äº›å¿ƒå¾—ã€‚å¹³æ—¶å¼€å‘ä¸­é‡åˆ°çš„ç—›ç‚¹å’Œç–‘æƒ‘ä¹‹å¤„ä¹Ÿå¸¸å¸¸ä»¤æˆ‘çƒ¦èºã€‚å› æ­¤ä¸‹æ–‡å°†è°ˆè°ˆæˆ‘å¯¹ç»„ä»¶å¼€å‘å’Œè®¾è®¡çš„ç†è§£ã€‚ 1. What? Why? ç»„ä»¶åŒ–å°±æ˜¯å°†ä¸šåŠ¡é€»è¾‘è¿›è¡ŒæŠ½ç¦»ï¼Œå°†ä¸åŒçš„ä¸šåŠ¡é€»è¾‘æŠ½...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "4"
    },
    "5": {
        "content": "<h1 id=\"tldr\">TL,DR</h1>\n<p>Vue2 ä½œä¸ºå¹³æ—¶å¼€å‘ä¸­æœ€å¸¸ç”¨çš„æ¡†æ¶ï¼Œæˆ‘åœ¨è¿›è¡Œä¸šåŠ¡å¼€å‘æ—¶å¯¹äºç»„ä»¶æ‹†åˆ†å’Œè®¾è®¡è¿˜æ˜¯æ¯”è¾ƒæœ‰å¿ƒå¾—çš„ã€‚å¼€å‘ä½“éªŒä¹Ÿè¿˜ç®—å‹å¥½ï¼Œä½†æ˜¯è¿˜æ˜¯å­˜åœ¨å¾ˆå¤šé—®é¢˜ã€‚æœ¬æ–‡ä¼šä»‹ç»ä¸€äº›å¸¸ç”¨çš„æŠ€å·§å’Œæ¡†æ¶æœ¬èº«å­˜åœ¨çš„ä¸€äº›é—®é¢˜ã€‚</p>\n<h1 id=\"ä¸€-åŸºæœ¬çŸ¥è¯†\">ä¸€. åŸºæœ¬çŸ¥è¯†</h1>\n<h2 id=\"11-ç»„ä»¶ä½¿ç”¨\">1.1 ç»„ä»¶ä½¿ç”¨</h2>\n<p>Vueä¸­ç»„ä»¶ä½¿ç”¨ååˆ†çš„ç®€å•ï¼Œ<code>import</code>+<code>componentsä¸­å£°æ˜</code>+<code>templateä¸­ä½¿ç”¨</code>ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨å…¨å±€ä¸­è¿›è¡Œæ³¨å†Œã€‚</p>\n<h2 id=\"12-ç»„ä»¶å¼€å‘\">1.2 ç»„ä»¶å¼€å‘</h2>\n<p>åœ¨å¼€å‘ä¸­ï¼ŒVueçš„æ¯ä¸ª<code>SFC</code> éƒ½æ˜¯ä¸€ä¸ªç»„ä»¶ã€‚Vue2 é€šè¿‡å£°æ˜Optionsæ¥å®šä¹‰ç»„ä»¶ã€‚</p>\n<h2 id=\"13-çŠ¶æ€ç®¡ç†\">1.3 çŠ¶æ€ç®¡ç†</h2>\n<p>åœ¨ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬åœ¨æ•°æ®å˜åŒ–åæ›´æ–° View , View æ§åˆ¶æ•°æ®çš„å˜åŒ–, <code>data-view-action</code>  å¯ä»¥ç®€å•æ¦‚è¿°ç»„ä»¶ä¸­æ•´ä½“å˜åŒ–çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚</p>\n<p>ä½†æ˜¯åœ¨å®é™…çš„å¼€å‘åœºæ™¯ä¸­ï¼Œå¾€å¾€æ˜¯å¤šä¸ªç»„ä»¶å…¬ç”¨ä¸€äº›çŠ¶æ€ï¼Œå¯èƒ½æ˜¯å…„å¼Ÿç»„ä»¶ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å±‚çº§å·®åˆ«è¾ƒå¤§çš„ç»„ä»¶ã€‚</p>\n<p>å¦‚æœæ¶‰åŠç»„ä»¶è¾ƒå°‘ï¼Œ<code>event-bus</code>ä¹Ÿèƒ½å¤Ÿç”¨ã€‚å¦‚æœéœ€è¦å…±äº«æ•°æ®çš„ç»„ä»¶è¾ƒå¤šçš„è¯ï¼Œé€‰æ‹©çŠ¶æ€ç®¡ç†åº“ä¼šæ¯”è¾ƒåˆé€‚ã€‚</p>\n<h1 id=\"äºŒ-é«˜çº§æŠ€å·§\">äºŒ. é«˜çº§æŠ€å·§</h1>\n<p>æ²¡é”™ï¼Œç¨å¾®è®²ä¸‹åŸºç¡€çŸ¥è¯†å°±ç›´æ¥æ¥åˆ°é«˜çº§æŠ€å·§äº†ã€‚</p>\n<h2 id=\"21-extends\">2.1 extends</h2>\n<blockquote>\n<p>ä¼˜é›…å…¶å®å¾ˆç®€å•</p>\n</blockquote>\n<p>å½“æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨UIåº“æ—¶ä¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚è¿›è¡Œæ”¹é€ ç»„ä»¶ï¼Œç®€å•çš„æ ·å¼æ›´æ”¹é€šè¿‡æ ·å¼ç©¿é€å’Œé‡ç½®å°±èƒ½å¤„ç†ã€‚å¯¹äºä¸šåŠ¡é€»è¾‘çš„ä¿®æ”¹ï¼Œå¾ˆå¤šåŒå­¦å¯èƒ½ä¼šç›´æ¥å¤åˆ¶æ–‡ä»¶è¿›è¡Œæ›´æ”¹ï¼Œè¿™æ˜¯ä¸€ä¸ªåŠæ³•ã€‚</p>\n<p>ä¹‹å‰é¡¹ç›®æ—¶ï¼Œæˆ‘é€šè¿‡æ‰‹åŠ¨å®ç°æ–¹æ³•ç»§æ‰¿å’Œè¦†ç›–ï¼Œä½†è¿˜æ˜¯æ¯”è¾ƒçš„éº»çƒ¦</p>\n<pre><code class=\"language-jsx\">export default {\n    componets: {\n        ComponentA,\n    },\n    render(h) {\n        return h(ComponentA,\n            {\n                props: this.$attrs,\n                on: this.listeners,\n                ref: &#39;A&#39;,\n            },...)\n    },\n    mounted() {\n        for (let key in this.$refs.A) {\n        if (!(key in this) &amp;&amp; typeof this.$refs.A[key] === &#39;function&#39;) {\n            this[key] = this.$refs.table[key]\n        }\n    }\n    }\n}\n</code></pre>\n<p>ä½¿ç”¨<code>extends</code> å°±å¾ˆç®€å•ï¼Œ<a href=\"https://v2.vuejs.org/v2/api/#extends\">extends</a> çš„ç”¨æ³•å°±æ˜¯æ‰©å±•ä¸€ä¸ªç»„ä»¶</p>\n<pre><code class=\"language-jsx\">// componentB\nexport default {\n    extends: ComponentA,\n    ...\n}\n</code></pre>\n<p>é€šç”¨extendså°±æ˜¯ç»§æ‰¿ä¸€ä¸ªç»„ä»¶ï¼Œå¯ä»¥è¦†ç›–å’Œæ‰©å±•ä¸€äº›æ–¹æ³•,å½“ç„¶ä¹Ÿå¯ä»¥æ›´æ”¹è§†å›¾çš„ä¸€äº›å±•ç¤ºã€‚</p>\n<h2 id=\"22-mixin\">2.2 Mixin</h2>\n<blockquote>\n<p>é€»è¾‘éš”ç¦»è¿˜æ˜¯å…¬ç”¨ï¼Œå®ƒéƒ½å¯ä»¥</p>\n</blockquote>\n<p><code>mixin</code> å¸¸ç”¨æ¥åšä¸€äº›é€»è¾‘çš„æŠ½ç¦»ã€‚è¿™é‡Œæˆ‘ä¸¾ä¸€ä¸ªæˆ‘å®é™…å¼€å‘ä¸­çš„ä½¿ç”¨åœºæ™¯ã€‚ </p>\n<p>eg: å½“å‰æœ‰ä¸€ä¸ªåˆ—è¡¨å±•ç¤ºæ•°æ®ï¼Œæ¯ä¸ªæ•°æ®éƒ½æœ‰10å‡ ç§æ“ä½œï¼Œä¼šè°ƒç”¨ä¸åŒçš„å¼¹çª—ï¼Œæ¥å£ï¼Œæé†’ç­‰ã€‚ä¸æ­¤åŒæ—¶åˆ—è¡¨è¿˜è¦æ”¯æŒä¸¤ç§å±•ç¤ºæ–¹å¼ï¼Œå¡ç‰‡å’ŒTable.</p>\n<p>åœ¨è¿™ä¸ªéœ€æ±‚é‡Œï¼Œæˆ‘é€šè¿‡minixå¯¹æ¯ä¸€ç§æ“ä½œè¿›è¡Œæ‹†åˆ†ï¼Œæ¯ä¸€ä¸ªæ“ä½œéƒ½æ˜¯å•ç‹¬çš„mixinã€‚æ¯ä¸ªminxiné‡Œé¢éƒ½åŒ…å«æ“ä½œå¯¹åº”çš„å±•ç¤ºæ ¡éªŒé€»è¾‘å’Œå®é™…çš„ä¸šåŠ¡é€»è¾‘ã€‚</p>\n<p>å¯¹äºæ¯ä¸ªmixinä¸­çš„å…¬ç”¨çš„å‡½æ•°å’ŒçŠ¶æ€ï¼Œå°±æ”¾åœ¨æ··å…¥çš„ç»„ä»¶ä¸­ï¼Œè¿›è¡Œå…¬ç”¨å³å¯ã€‚</p>\n<p>æœ€åå°†æ‰€æœ‰æ“ä½œå½¢æˆçš„æ•°ç»„ä¼ å…¥åˆ°åˆ—è¡¨çš„å±•ç¤ºé¡¹ä¸­ï¼Œå®ç°äº†ä¸åŒçš„å±•ç¤ºå½¢å¼å…¬ç”¨ç›¸åŒçš„é€»è¾‘ï¼Œé¿å…äº†ä»£ç çš„é‡å¤ã€‚</p>\n<p>å¥½å¤„ï¼š ä¸åŒçš„ä¸šåŠ¡é€»è¾‘è¿›è¡Œäº†éš”ç¦»ï¼Œé¿å…äº†ç»„ä»¶çš„è†¨èƒ€ï¼Œå¾ˆå¥½çš„æ”¯æŒä¿®æ”¹å’Œæ‰©å±•</p>\n<p>åå¤„ï¼š minixçš„ç¼ºç‚¹ä¹Ÿæ¯”è¾ƒæ˜æ˜¾ï¼Œåªèƒ½å…¬ç”¨é€»è¾‘ã€‚è§†å›¾è¿˜æ˜¯éœ€è¦æ”¾åˆ°ä¸»ç»„ä»¶ä¸­ï¼Œè¿™ä¼šé€ æˆè§†å›¾å’Œé€»è¾‘åˆ†ç¦»çš„é—®é¢˜ã€‚å› æ­¤åœ¨è¿›è¡Œè§†å›¾æ“ä½œå’Œå…¬ç”¨çŠ¶æ€çš„å¤„ç†æ—¶ï¼Œéœ€è¦è¿›è¡Œä»”ç»†æ ¸å¯¹ã€‚</p>\n<p>å®é™…åœºæ™¯ä¸­å¯ä»¥æ ¹æ®éœ€æ±‚å°è£…mixin, å¯ä»¥å°è£…æˆå‡½æ•°å¤„ç†ä¸åŒæ•°æ®çš„åœºæ™¯ï¼Œå¯ä»¥åœ¨mixinä¸­å¼€å‘å…¬ç”¨çš„é€»è¾‘ï¼Œç»´æŠ¤å…¬ç”¨çš„çŠ¶æ€ã€‚</p>\n<h2 id=\"23-vueextend\">2.3 Vue.extend</h2>\n<blockquote>\n<p>è¯´æ˜¯é“¶å¼¹ï¼Œæœªå°ä¸å¯ </p>\n</blockquote>\n<p>åœ¨ä½¿ç”¨Element-uiæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‡½æ•°çš„å½¢å¼è°ƒç”¨ç»„ä»¶ã€‚åœ¨ç¿»çœ‹ä»£ç åï¼Œæˆ‘çŸ¥é“äº†Vue.extendè¿™ä¸ªæ–¹æ³•ã€‚å…¶å®Vueæºç ä¸­ï¼ŒVueç»„ä»¶åœ¨å®é™…ä½¿ç”¨æ—¶ä¹Ÿä¼šé€šè¿‡è¿™ä¸ªæ–¹æ³•è¿›è¡Œç»„ä»¶çš„ç”Ÿäº§ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ä¸æ·±å…¥èŠä¸‹å»äº†ã€‚</p>\n<p>ä»‹ç»ä¸‹è¿™ä¸ªæ–¹æ³•ï¼ŒVue.extendå¯ä»¥å°†ç»„ä»¶è½¬åŒ–ä¸ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œé€šè¿‡å®ä¾‹åŒ–æ„é€ å‡½æ•°ï¼Œå°±èƒ½ç”Ÿæˆç»„ä»¶ã€‚</p>\n<p>å› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡Vue.extendå°†å¯¹åº”çš„ç»„ä»¶è½¬åŒ–æ„é€ å‡½æ•°ï¼Œç„¶åå°è£…ä¸€ä¸ªå‡½æ•°è¿›è¡Œç»„ä»¶çš„ç”Ÿæˆï¼ŒæŒ‚è½½å’Œæ›´æ–°ç­‰æ“ä½œã€‚å¸¸ç”¨çš„ä¸€äº›å¼¹çª—ç»„ä»¶éƒ½å¯ä»¥é€šè¿‡è¿™ç§å½¢å¼è¿›è¡Œå¼€å‘</p>\n<pre><code class=\"language-jsx\">import Vue from &#39;vue&#39;\n\nexport const componetToFunction = function (componet) {\n    return function (options = {}) {\n        let parent = document.body\n        const ComponetConstructor = Vue.extend(componet)\n        const dom = document.createElement(&#39;div&#39;)\n        parent.appendChild(dom)\n        const instance = new ComponetConstructor({\n            props: options,\n        })\n\n        for (let prop in options) {\n            if (options.hasOwnProperty(prop)) {\n                instance[prop] = options[prop]\n            }\n        }\n\n        instance.$mount(dom)\n\n        return instance\n    }\n}\n\n// ä½¿ç”¨æ—¶\nconst renderA = componetToFunction(ComponentA)\nrenderA({a:1,b:2})\n</code></pre>\n<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡ é—­åŒ…å®ç°å•ä¾‹å’Œç»„ä»¶æ›´æ–°ç­‰é€»è¾‘ï¼Œæ ¹æ®å…·ä½“åœºæ™¯è¿›è¡Œä½¿ç”¨ã€‚éå¸¸å¥½ç”¨</p>\n<p>å…³äºVue.extendçš„å‘ï¼Œæˆ‘ä¹Ÿä¸“é—¨æœ‰è¿›è¡Œæ€»ç»“ï¼Œ<a href=\"https://github.com/vivipure/TIL/issues/8\">é“¾æ¥åœ¨è¿™</a></p>\n<h2 id=\"24-slot\">2.4 Slot</h2>\n<blockquote>\n<p>åŸºæœ¬çŸ¥è¯†ï¼Œä½ çŸ¥æˆ‘çŸ¥</p>\n</blockquote>\n<p>æ’æ§½å…¶å®ä¹Ÿä¸ç”¨å¤šä»‹ç»äº†ï¼Œæ›´å¤šçš„åœºæ™¯è¿˜æ˜¯å¸ƒå±€çš„å¤ç”¨ã€‚çŸ¥é“å…·åæ’æ§½ï¼Œé»˜è®¤æ’æ§½å’Œä½œç”¨åŸŸæ’æ§½å„ç§ä½¿ç”¨æ–¹æ³•å³å¯</p>\n<h2 id=\"25-v-model\">2.5 v-model</h2>\n<blockquote>\n<p>è¡¨å•å†å¤æ‚ï¼Œæœ‰å®ƒæˆ‘ä¸æ€•</p>\n</blockquote>\n<p>åœ¨Vueä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡v-modelæŒ‡ä»¤å®ç°åŒå‘ç»‘å®šã€‚å®ƒçš„åŸç†å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå…¶å®å°±æ˜¯ä½œä¸ºè¯­æ³•ç³–å°è£…äº†valueå’ŒupdateValueçš„é€»è¾‘ã€‚</p>\n<p>åœ¨Vueä¸­ä¹Ÿå…è®¸æˆ‘ä»¬è‡ªå®šä¹‰v-modelã€‚</p>\n<pre><code class=\"language-jsx\">props:[&#39;value&#39;],\nmodel: {\n    prop: &#39;value&#39;,\n    event: &#39;update:value&#39;\n},\nmethods: {\n    update(value) {\n        this.$emit(&#39;update:value&#39;, value)\n    }\n}\n</code></pre>\n<p>é€šè¿‡modelå£°æ˜ç»„ä»¶v-modelç»‘å®šçš„å€¼å’Œæ›´æ–°å€¼çš„äº‹ä»¶å³å¯ã€‚ å› æ­¤åœ¨åšä¸€äº›å¯Œæ–‡æœ¬è¾“å…¥æ¡†ï¼Œå›¾ç‰‡ä¸Šä¼ ç»„ä»¶ä¹‹ç±»è¾“å…¥çš„ç»„ä»¶æ—¶ï¼Œä½¿ç”¨v-modelä¼šæ¯”è¾ƒåˆé€‚ã€‚</p>\n<p>åœ¨æˆ‘å¹³æ—¶çš„å¼€å‘ä¸­ï¼Œæˆ‘ä¼šç”¨æ¥åšè¡¨å•çš„æŠ½ç¦»ã€‚ä¾‹å¦‚</p>\n<pre><code class=\"language-jsx\">&lt;AreaSelect v-model=&quot;config&quot; /&gt;\n&lt;TimeSelect v-model=&quot;config&quot; /&gt;\n</code></pre>\n<p>å½“æ–°å¢çš„ç»„ä»¶éœ€è¦æ”¹å¥½å‡ ä¸ªå€¼æ—¶ï¼Œä¹Ÿèƒ½é€šè¿‡è¿™ç§æ–¹å¼è¿›è¡Œå¼€å‘ï¼Œv-modelæ”¯æŒæ›´æ”¹å¯¹è±¡ã€‚ä¸è¿‡æˆ‘å¸¸å¸¸ä½¿ç”¨dataä¿å­˜å¯¹åº”çš„å¼•ç”¨å€¼ç›´æ¥è¿›è¡Œæ›´æ”¹ï¼Œä¸ä¼šè¿›è¡ŒæŠ¥é”™ï¼Œä¹Ÿæ¯”è¾ƒç®€å•ã€‚</p>\n<p>åŒæ—¶æ³¨æ„watchä¸‹propsä¼ å…¥çš„å€¼ï¼Œæ•°æ®æ›´æ”¹åè¦å³ä½¿æ›´æ”¹dataä¸­çš„å€¼ã€‚è¿˜æœ‰åˆ†å‘äº‹ä»¶æ—¶ï¼Œè¦å…ˆè§¦å‘modelçš„äº‹ä»¶ï¼Œåœ¨åˆ†å‘changeçš„äº‹ä»¶ï¼Œä¸ç„¶å¤–éƒ¨åœ¨ä½¿ç”¨changeæ—¶æ‹¿ä¸åˆ°æ­£ç¡®çš„å€¼ã€‚</p>\n<p>å¦‚æœä½ åƒæˆ‘ä¸€æ ·åœ¨è¡¨å•ä¸­ä½¿ç”¨çš„è¯ï¼Œè®°å¾—å†™éªŒè¯å’Œæ¸…é™¤éªŒè¯ç›¸å…³çš„æ–¹æ³•ä¾›çˆ¶ç»„ä»¶è¿›è¡Œä½¿ç”¨</p>\n<h2 id=\"26-directives\">2.6 directives</h2>\n<blockquote>\n<p>æŒ‡ä»¤ï¼šæ‰§è¡Œ</p>\n</blockquote>\n<p>è‡ªå®šä¹‰æŒ‡ä»¤çš„å…·ä½“å†™æ³•æˆ‘å°±ä¸å†™äº†ï¼Œä¹Ÿå¾ˆç®€å•ã€‚è¯´ä¸€ä¸‹å¸¸ç”¨çš„åœºæ™¯å§ï¼Œä¾‹å¦‚å¯¹domçš„ä¸€äº›æ“ä½œï¼Œè¾“å…¥å¤„ç†ï¼Œè¿˜æœ‰äº‹ä»¶ç»‘å®šéƒ½å¯ä»¥é€šè¿‡æŒ‡ä»¤çš„æ–¹å¼è¿›è¡Œå¤„ç†ã€‚</p>\n<p>æˆ‘çš„å¼€å‘ä¸­å°±ä½¿ç”¨è¿‡åŸ‹ç‚¹ï¼Œæ‹–æ‹½ï¼ŒèŠ‚æµç­‰æŒ‡ä»¤ã€‚</p>\n<p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªç‚¹ï¼Œå¦‚æœæŒ‡ä»¤éœ€è¦ç»´æŒä¸€äº›æ•°æ®çš„è¯ï¼Œå¯ä»¥ç»‘å®šåˆ°elä¸Šã€‚</p>\n<h2 id=\"27-providereject\">2.7 provide/reject</h2>\n<p>å¯ä»¥é€šè¿‡provideå’Œrejectè®©ç»„ä»¶è·¨çº§åˆ«å…±äº«çŠ¶æ€ï¼Œç±»ä¼¼React.context. </p>\n<p>å¦‚æœéœ€è¦å¾€è‡ªç»„ä»¶ä¼ é€’å¤ªå¤šçš„æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘ç”¨è¿™ç§æ–¹å¼ï¼Œè€Œä¸æ˜¯ç”¨<code>props</code></p>\n<ol>\n<li>éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœç»„ä»¶ä¹‹é—´å­˜åœ¨å…¶ä»–çš„provideå’Œrejectä¼šä½¿rejectå—åˆ°æœ€è¿‘çš„çš„provideæ•°æ®ã€‚</li>\n<li>å…±äº«çš„æ•°æ®ä¸æ˜¯å“åº”å¼çš„ï¼Œå¯ä»¥é€šè¿‡å‡½æ•°çš„æ–¹å¼è¿›è¡Œè·å–</li>\n</ol>\n<h1 id=\"3-è¿˜æœ‰ç‚¹ä¸œè¥¿\">3. è¿˜æœ‰ç‚¹ä¸œè¥¿</h1>\n<ol>\n<li>å¼¹çª—ç»„ä»¶æœ€å¥½æ”¾åœ¨bodyä¸‹ï¼Œæ¯•ç«Ÿfixedä¼šå—åˆ°cssæ ·å¼çš„å½±å“ï¼Œè¦ä¿è¯å¥½é®ç½©å±‚çš„å±‚çº§</li>\n<li>å¼¹çª—ç»„ä»¶å¦‚æœä¸æ˜¯å¿…è¦ï¼Œå°±å•ç‹¬æ”¾ä¸€ä¸ªæ–‡ä»¶å§</li>\n<li>åˆ«è®©ç»„ä»¶æ‹¥æœ‰å¤ªå¤šçŠ¶æ€ï¼Œè€Œæ˜¯ä¸åŒçŠ¶æ€å¯¹åº”ä¸åŒçš„ç»„ä»¶</li>\n<li>å¦‚æœä¸€ä¸ªå€¼ä¼ é€’çš„å±‚çº§å¤ªæ·±ï¼Œå°±æŠŠå®ƒæ”¾åˆ°å…¨å±€çŠ¶æ€å§</li>\n</ol>\n<h1 id=\"4-æœ€åå†è¯´è¯´\">4. æœ€åå†è¯´è¯´</h1>\n<p>Vue2ä½œä¸ºæ¸è¿›å¼æ¡†æ¶ï¼Œæ— è®ºæ˜¯å°åº”ç”¨è¿˜æ˜¯å¤§åº”ç”¨ï¼Œç»„ä»¶å¼€å‘æ˜¯å®Œå…¨èƒ½å¤Ÿcoverçš„ä½çš„ã€‚</p>\n<p>ä½†æ˜¯Vue Options Apiä¸­æ•°æ®å’Œæ–¹æ³•çš„éš”ç¦»ã€ç‰©ç†è¡Œæ•°çš„éš”ç¦»ã€‘å¯¼è‡´å¯è¯»æ€§è¾ƒå·®ã€‚</p>\n<p>ä¸æ­¤åŒæ—¶TSæ”¯æŒè¾ƒå¼±ï¼Œå¯¼è‡´å¼€å‘æ—¶ç»„ä»¶çš„ä¼ å€¼æ— æ³•æ™ºèƒ½æé†’ã€‚</p>\n<p>mixinä¸æ˜¯å¥½çš„å®ç°æ–¹å¼ï¼Œè§†å›¾å’Œæ•°æ®çš„åˆ†ç¦»å¯¼è‡´å¯è¯»æ€§å˜å·®ã€‚</p>\n<p>å¥½åœ¨Vue3æ¥äº†ï¼ŒTS + Composition Api è®©å¼€å‘ä½“éªŒå¤§å¤§æå‡ï¼Œåé¢å°†ä¼šæœ‰æ–‡ç« ä»‹ç»ä¸‹Vue3çš„ç›¸å…³ç‰¹æ€§ã€‚</p>\n",
        "title": "Vue2 ç»„ä»¶å¼€å‘",
        "created": "2022-06-05 15:32:49  ",
        "updated": "2022-06-09 16:04:58 ",
        "excerpt": "TL,DR Vue2 ä½œä¸ºå¹³æ—¶å¼€å‘ä¸­æœ€å¸¸ç”¨çš„æ¡†æ¶ï¼Œæˆ‘åœ¨è¿›è¡Œä¸šåŠ¡å¼€å‘æ—¶å¯¹äºç»„ä»¶æ‹†åˆ†å’Œè®¾è®¡è¿˜æ˜¯æ¯”è¾ƒæœ‰å¿ƒå¾—çš„ã€‚å¼€å‘ä½“éªŒä¹Ÿè¿˜ç®—å‹å¥½ï¼Œä½†æ˜¯è¿˜æ˜¯å­˜åœ¨å¾ˆå¤šé—®é¢˜ã€‚æœ¬æ–‡ä¼šä»‹ç»ä¸€äº›å¸¸ç”¨çš„æŠ€å·§å’Œæ¡†æ¶æœ¬èº«å­˜åœ¨çš„ä¸€äº›é—®é¢˜ã€‚ ä¸€. åŸºæœ¬çŸ¥è¯† 1.1 ç»„ä»¶ä½¿ç”¨ Vueä¸­...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "5"
    },
    "6": {
        "content": "<h1 id=\"1-æˆ‘çš„ç–‘é—®\">1. æˆ‘çš„ç–‘é—®</h1>\n<p> 1.1 $storeæ˜¯æ€ä¹ˆä¿è¯æ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥è¿›è¡Œè®¿é—®çš„\n 1.2. ä¸ºä»€ä¹ˆéœ€è¦Mutation,è€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨Action\n 1.3. mapStateç­‰æ–¹æ³•æ˜¯æ€ä¹ˆæ˜ å°„åˆ°ç»„ä»¶çš„\n 1.4. æ€ä¹ˆå’ŒVueçš„å“åº”å¼ç»“åˆèµ·æ¥çš„\n 1.5. æ’ä»¶çš„å®ç°ã€å…´è¶£ä¸å¤§ã€‘\n 1.6. æ¨¡å—çš„å®ç°ã€å…´è¶£ä¸å¤§ã€‘</p>\n<p>å¸¦ç€æˆ‘çš„ç–‘é—®ï¼Œç°åœ¨å°±å¼€æï¼</p>\n<h1 id=\"2--åŸºæœ¬ä»‹ç»\">2.  åŸºæœ¬ä»‹ç»</h1>\n<p><img src=\"https://vuex.vuejs.org/vuex.png\" alt=\"æµç¨‹å›¾\"></p>\n<p><code>Vuex</code> çš„æ ¸å¿ƒå°±æ˜¯ä¸€ä¸ª <code>Store</code>, ç®¡ç†ç€åº”ç”¨çš„å…¨å±€çŠ¶æ€ã€‚ç»„ä»¶ä» <code>store</code> ä¸­è¯»å–æ•°æ®ï¼Œå½“  <code>store</code> ä¸­æ•°æ®å˜åŒ–æ—¶ï¼Œç»„ä»¶ä¹Ÿä¼šä¸€èµ·æ›´æ–°ã€‚\n<code>Vuex</code> ä¸­çš„æ•°æ®éœ€è¦é€šè¿‡ <code>Mutation</code> è¿›è¡Œæ˜¾ç¤ºæ›´æ”¹ï¼Œå½“ç„¶æ ¹æ®å®é™…ä¸šåŠ¡ç›´æ¥æ›´æ”¹å¯¹è±¡ç±»å‹çš„ <code>state</code> å…¶å®ä¹Ÿå¯ä»¥ã€‚æ˜¾ç¤ºæ›´æ”¹æ›´æ–¹ä¾¿æˆ‘ä»¬å®šä½é—®é¢˜å’Œåœ¨ <code>devtools</code> ä¸­è¿›è¡Œå±•ç¤º</p>\n<p>é¡¹ç›®åœ°å€ï¼š<a href=\"https://github.com/vuejs/vuex\">https://github.com/vuejs/vuex</a>\næ„å»ºå·¥å…·ï¼š Rollup\nå…¥å£æ–‡ä»¶ï¼šsrc/index.js</p>\n<p>ç”±äºå¹³æ—¶ä½¿ç”¨çš„3.xç‰ˆæœ¬çš„ <code>Vuex</code> ,æ‰€ä»¥åˆ†æ”¯ä¸º <strong>v3.6.2</strong></p>\n<h1 id=\"3-åˆå§‹åŒ–\">3. åˆå§‹åŒ–</h1>\n<p>å›æƒ³ä¸‹å¹³æ—¶æˆ‘ä»¬æ˜¯æ€ä¹ˆä½¿ç”¨Vuex, æˆ‘ä»¬ä½¿ç”¨ <code>Vue.use</code> å®‰è£…äº† <code>Vuex</code> æ’ä»¶ï¼Œç„¶åé€šè¿‡\nç„¶åå†æ¥çœ‹ <code>Vuex</code> å¯¼å‡ºçš„ç›¸å…³åŒ…</p>\n<pre><code class=\"language-JS\">Vue.use(Vuex);\nconst store = new Vuex.Store({\n    state,\n    getters,\n    mutations,\n    actions,\n})\n\n  \nexport default store;\n</code></pre>\n<p>é¦–å…ˆæˆ‘ä»¬æŸ¥çœ‹å…¥å£æ–‡ä»¶æ–‡ä»¶</p>\n<pre><code class=\"language-JS\">export default {\n    Store, \n    install,\n    version: &#39;__VERSION__&#39;,\n    mapState,\n    mapMutations,\n    mapGetters,\n    mapActions,\n    createNamespacedHelpers,\n    createLogger\n}\n</code></pre>\n<p><code>Store</code> å°±æ˜¯æˆ‘ä»¬åˆå§‹åŒ–çš„ç±»ï¼Œ<code>install</code> å°±æ˜¯ <code>Vue.use</code> å®‰è£…çš„é€»è¾‘ï¼Œè¿˜æœ‰å¹³æ—¶ä½¿ç”¨åˆ°çš„ä¸€äº›è¾…åŠ©å‡½æ•°ã€‚</p>\n<h2 id=\"31-vuexåˆå§‹åŒ–\">3.1 Vuexåˆå§‹åŒ–</h2>\n<p>çœ‹ä¸‹ <code>install</code>çš„é€»è¾‘</p>\n<pre><code class=\"language-js\">export function install () {\n    if (Vue &amp;&amp; _Vue === Vue) {\n        if (__DEV__) {\n            console.error(&#39;[vuex] already installed. Vue.use(Vuex) should be called only once.&#39;)\n        }\n        return\n    }\n    Vue = _Vue\n    applyMixin(Vue)\n}Ã\n</code></pre>\n<p>åœ¨æ‰§è¡Œæ—¶ä¼šå¾€ <code>Vue</code> ä¸­æ··å…¥ä¸€äº›é€»è¾‘ï¼Œ2.0ä¸­æ··å…¥äº† <code>beforeCreate</code> å‡½æ•°çš„é€»è¾‘</p>\n<pre><code class=\"language-js\">Vue.mixin({ beforeCreate: vuexInit })\n</code></pre>\n<p>è€Œ <code>vuexInit</code> ä¸­çš„é€»è¾‘å°±æ˜¯æ··å…¥<code>$store</code>, ä¿è¯åº”ç”¨ä¸‹çš„ç»„ä»¶éƒ½å¯ä»¥è®¿é—®åˆ° <code>$store</code> ã€‚</p>\n<pre><code class=\"language-js\">function vuexInit () {\n    const options = this.$options\n    // store injection\n    if (options.store) {\n        this.$store = typeof options.store === &#39;function&#39;\n        ? options.store()\n        : options.store\n    } else if (options.parent &amp;&amp; options.parent.$store) {\n        this.$store = options.parent.$store\n    }\n}\n</code></pre>\n<p>é€šè¿‡è¿™é‡Œçš„é€»è¾‘å°±èƒ½è§£ç­”æˆ‘çš„[ç¬¬ä¸€ä¸ªç–‘é—®]äº†</p>\n<h2 id=\"32-storeåˆå§‹åŒ–\">3.2 Storeåˆå§‹åŒ–</h2>\n<p>Storeåˆå§‹åŒ–ä¸»è¦åˆ†ä¸ºï¼š</p>\n<ol>\n<li>Moduleæ³¨å†Œï¼Œå¤„ç†åµŒå¥—é€»è¾‘ï¼Œå½¢æˆtree</li>\n<li>Moduleå®‰è£…ï¼Œåˆå§‹åŒ– state,gettersç­‰</li>\n<li>åˆå§‹åŒ–Store.vm</li>\n</ol>\n<h3 id=\"32-1-moduleæ³¨å†Œ\">3.2. 1 Moduleæ³¨å†Œ</h3>\n<p>åˆå§‹åŒ–<code>Store</code>æ—¶æˆ‘ä»¬ä¼šä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢åŒ…å« <code>state</code>,<code>mutations</code>,<code>getters</code> ç­‰å±æ€§ã€‚ç°åœ¨æˆ‘ä»¬å°±æ¥çœ‹çœ‹ <code>Store</code> è¿™ä¸ªç±».</p>\n<pre><code class=\"language-js\">this._modules = new ModuleCollection(options)\n</code></pre>\n<p>æ•´ä¸ª <code>options</code> å¯ä»¥è§†ä¸º Storeçš„ root module, åœ¨ModuleCollectionä¸­è¿›è¡Œè§£æï¼Œå¦‚æœæœ‰åµŒå¥—çš„ module ,è¯¥æ–¹æ³•ä¹Ÿä¼šè¿›è¡Œå¤„ç†\nçœ‹ä¸€ä¸‹æ¨¡å—æ³¨å†Œçš„é€»è¾‘</p>\n<pre><code class=\"language-js\">register (path, rawModule, runtime = true) {\n    \n    const newModule = new Module(rawModule, runtime)\n\n    // æ„å»ºtree\n    if (path.length === 0) {\n        this.root = newModule\n    } else {\n        // slice(0, -1) ä¸åŒ…æ‹¬æœ€åä¸€é¡¹\n        const parent = this.get(path.slice(0, -1))\n        parent.addChild(path[path.length - 1], newModule)\n    }\n\n    // å¤„ç†åµŒå¥—çš„æ¨¡å—\n    if (rawModule.modules) {\n        forEachValue(rawModule.modules, (rawChildModule, key) =&gt; {\n            this.register(path.concat(key), rawChildModule, runtime)\n        })\n    }\n}\n</code></pre>\n<p>å…¶ä¸­ <code>path</code> ä¸º <code>store tree</code> çš„è·¯å¾„ï¼Œ<code>rawModule</code> ä¸ºé…ç½®é¡¹ï¼Œ <code>runtime</code> ä¸ºæ˜¯å¦è¿è¡Œæ—¶åˆ›å»ºçš„æ¨¡å—ã€‚</p>\n<p>é€šè¿‡ Module ç±»ä¸­å¯¹æ¨¡å—è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ¤æ–­å½“å‰ <code>path</code> çš„é•¿åº¦ï¼Œè‹¥ä¸º0åˆ™ç§°ä¸º <code>root module</code>, å¦åˆ™å°±æ‰¾åˆ° çˆ¶æ¨¡å—è°ƒç”¨ <code>addChild</code> æ–¹æ³•å½¢æˆçˆ¶å­é€»è¾‘ã€‚</p>\n<p>è¿™æ ·å­æ¨¡å—å¯ä»¥é€šè¿‡è·¯å¾„æ‰¾åˆ°çˆ¶æ¨¡å—ï¼Œçˆ¶æ¨¡å—å¯ä»¥é€šè¿‡ <code>_children</code> <code>key</code> æ‰¾åˆ°å­æ¨¡å—</p>\n<h3 id=\"322-moduleå®‰è£…\">3.2.2 Moduleå®‰è£…</h3>\n<pre><code class=\"language-js\">installModule(this, state, [], this._modules.root)\n</code></pre>\n<p>è¿™ä¸ªæ–¹æ³•çš„æ ¸å¿ƒé€»è¾‘ä¸º</p>\n<pre><code class=\"language-js\">// è·å–å‘½åç©ºé—´ï¼Œæ¨¡å—æ ‡è¯†namespace ä¸ºtrueï¼Œ å¯ä»¥åµŒå¥—\nconst namespace = store._modules.getNamespace(path)\n\n\nif (!isRoot &amp;&amp; !hot) {\n    const parentState = getNestedState(rootState, path.slice(0, -1))\n    const moduleName = path[path.length - 1]\n    store._withCommit(() =&gt; {\n        Vue.set(parentState, moduleName, module.state)\n    })\n}\n// æŒ‚è½½state\nconst local = module.context = makeLocalContext(store, namespace, path)\n\n  \n// å¤„ç†mutations,action,getter\nmodule.forEachMutation((mutation, key) =&gt; {\n    const namespacedType = namespace + key\n    registerMutation(store, namespacedType, mutation, local)\n})\nmodule.forEachAction((action, key) =&gt; {\n    const type = action.root ? key : namespace + key\n    const handler = action.handler || action\n    registerAction(store, type, handler, local)\n})\nmodule.forEachGetter((getter, key) =&gt; {\n    const namespacedType = namespace + key\n    registerGetter(store, namespacedType, getter, local)\n})\n// åµŒå¥—å®‰è£…\nmodule.forEachChild((child, key) =&gt; {\n    installModule(store, rootState, path.concat(key), child, hot)\n})\n</code></pre>\n<p>åœ¨ <code>makeLocalContext</code> æ–¹æ³•ä¸­å®ç°ä¸Šä¸‹æ–‡çš„æ³¨å†Œï¼Œä¸Šä¸‹æ–‡åŒ…æ‹¬äº† <code>state</code>, <code>getters</code> , <code>dispatch</code>, <code>commit</code> ç­‰ã€‚è¿™å‡ ä¸ªå±æ€§é™¤äº† <code>state</code> éƒ½å¤„ç†äº† <code>namespace</code> çš„æƒ…å†µã€‚è¿™é‡Œè®²ä¸€ä¸‹ <code>state</code> çš„è·å–é€»è¾‘å°±å¥½äº†</p>\n<pre><code class=\"language-js\">Object.defineProperties(local, {\n    getters: {\n        get: noNamespace\n        ? () =&gt; store.getters\n        : () =&gt; makeLocalGetters(store, namespace)\n    },\n    state: {\n        get: () =&gt; getNestedState(store.state, path)\n    }\n\n})\n\nfunction getNestedState (state, path) {\n    return path.reduce((state, key) =&gt; state[key], state)\n}\n</code></pre>\n<p>Â ä»<code>state</code>Â å¼€å§‹ï¼Œå±‚å±‚æŸ¥æ‰¾å­æ¨¡å—Â <code>state</code>ï¼Œæœ€ç»ˆæ‰¾åˆ°ç›®æ ‡æ¨¡å—çš„Â <code>state</code>.</p>\n<p> <code>registerMutation</code>, <code>registerAction</code> ç­‰æ–¹æ³•å®Œæˆå¯¹ <code>mutation</code>, <code>action</code> çš„æ³¨å†Œ</p>\n<h3 id=\"323-åˆå§‹åŒ–storevm\">3.2.3 åˆå§‹åŒ–Store.vm</h3>\n<pre><code class=\"language-js\">resetStoreVM(this, state)\n</code></pre>\n<p>resetStoreVMçš„å…·ä½“é€»è¾‘æ˜¯è¿™æ ·çš„</p>\n<pre><code class=\"language-js\">  \n\nfunction resetStoreVM (store, state, hot) {\n\n   const oldVm = store._vm\n   // bind store public getters\n   store.getters = {}\n\n   // reset local getters cache\n\n   store._makeLocalGettersCache = Object.create(null)\n\n   const wrappedGetters = store._wrappedGetters\n\n   const computed = {}\n\n   forEachValue(wrappedGetters, (fn, key) =&gt; {\n       computed[key] = partial(fn, store)\n       Object.defineProperty(store.getters, key, {\n           get: () =&gt; store._vm[key],\n           enumerable: true // for local getters\n       })\n   })\n\n   const silent = Vue.config.silent\n   Vue.config.silent = true\n   store._vm = new Vue({\n       data: {\n           $$state: state\n       },\n       computed\n   })\n   Vue.config.silent = silent\n\n\n   if (oldVm) {\n       if (hot) {\n           store._withCommit(() =&gt; {\n\n               oldVm._data.$$state = null\n\n           })\n   \n       }\n       Vue.nextTick(() =&gt; oldVm.$destroy())\n   }\n}\n</code></pre>\n<p>è¿™é‡Œçš„æµç¨‹å°±æ˜¯ä» <code>_wrappedGetters</code> ä¸­å–å‡ºå¯¹åº” <code>gettter</code> å‡½æ•°ï¼ŒæŒ‚åœ¨åˆ° <code>store._vm </code>ä¸­ï¼ŒåŒæ—¶å­˜å…¥ <code>computed</code> ä¸­ï¼Œé€šè¿‡ <code>Vue</code> çš„ <code>compute</code> ,å’Œ <code>state</code> äº§ç”Ÿä¾èµ–å…³ç³»</p>\n<pre><code>store._vm = new Vue({\n       data: {\n           $$state: state\n       },\n       computed\n})\n</code></pre>\n<p> ç„¶å <code>store</code> çš„ <code>state</code> çš„ <code>getter</code> æ˜¯è¿™ä¹ˆè®¾ç½®çš„</p>\n<pre><code class=\"language-js\">get state () {\n return this._vm._data.$$state\n}\n</code></pre>\n<p>å› æ­¤è·å– <code>state</code> æ—¶ï¼Œå®é™…ä¸Šè®¿é—®çš„æ˜¯vmçš„<code>$$state</code></p>\n<p>æ€»ä½“çš„é€»è¾‘æ¥è¯´å°±æ˜¯è¿™æ ·çš„</p>\n<pre><code>æ ¹æ®Â `key`Â è®¿é—®Â `store.getters`Â çš„æŸä¸€ä¸ªÂ `getter`Â çš„æ—¶å€™ï¼Œå®é™…ä¸Šå°±æ˜¯è®¿é—®äº†Â `store._vm[key]`ï¼Œä¹Ÿå°±æ˜¯Â `computed[key]`ï¼Œåœ¨æ‰§è¡ŒÂ `computed[key]`Â å¯¹åº”çš„å‡½æ•°çš„æ—¶å€™ï¼Œä¼šæ‰§è¡ŒÂ `rawGetter(local.state,...)`Â æ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¼šè®¿é—®åˆ°Â `store.state`ï¼Œè¿›è€Œè®¿é—®åˆ°Â `store._vm._data.$$state`ï¼Œè¿™æ ·å°±å»ºç«‹äº†ä¸€ä¸ªä¾èµ–å…³ç³»ã€‚å½“Â `store.state`Â å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œä¸‹ä¸€æ¬¡å†è®¿é—®Â `store.getters`Â çš„æ—¶å€™ä¼šé‡æ–°è®¡ç®—\n</code></pre>\n<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­è¿˜æœ‰ ä¸¥æ ¼æ¨¡å¼çš„æ ¡éªŒ</p>\n<pre><code class=\"language-js\">function enableStrictMode (store) {\n\n    store._vm.$watch(function () { return this._data.$$state }, () =&gt; {\n\n    if (__DEV__) {\n\n    assert(store._committing, `do not mutate vuex store state outside mutation handlers.`)\n\n    }\n\n    }, { deep: true, sync: true })\n}\n</code></pre>\n<p>å¦‚æœå¤„äºä¸¥æ ¼æ¨¡å¼,å°±ä¼šæ‰‹åŠ¨æ·»åŠ ä¸€ä¸ª åŒæ­¥çš„<code>watch</code>, ç›‘å¬<code>$$state</code>çš„å˜åŒ–æ˜¯å¦æ˜¯ <code>mutation</code> æ”¹å˜çš„ï¼Œ</p>\n<pre><code class=\"language-js\">_withCommit (fn) {\n  const committing = this._committing\n  this._committing = true\n  fn()\n  this._committing = committing\n}\n</code></pre>\n<p>_withCommitæ–¹æ³•ä¿è¯äº†é€šè¿‡Vuexè‡ªèº«æä¾›çš„æ–¹æ³•æ”¹å˜æ•°æ®æ‰èƒ½ä½¿ <code>_committing</code> ä¸º <code>true</code></p>\n<p>è¯»åˆ°è¿™é‡Œï¼Œå…³äº [1.4]å’Œ[1.6]çš„é—®é¢˜ï¼Œå·²ç»æœ‰äº†ç­”æ¡ˆï¼Œå“åº”å¼æ˜¯é€šè¿‡ <code>Vue</code> å®ç°çš„ï¼Œæ¨¡å—æ˜¯ <code>Store</code> çš„åŸºæœ¬å•ä½ï¼Œå…¼å®¹å±‚çº§çš„åµŒå¥—å’Œå‘½åç©ºé—´ã€‚</p>\n<h1 id=\"4-api\">4. API</h1>\n<p>åœ¨ store çš„åˆå§‹åŒ–è¿‡ç¨‹ä¸­å®Œæˆäº†æ•°æ®çš„å­˜å‚¨ï¼Œæ¥ä¸‹æ¥å°±æ˜¯é€šè¿‡ APIæ¥è¿›è¡Œä½¿ç”¨äº†ã€‚</p>\n<h2 id=\"41-mutation--commit\">4.1 Mutation &amp; commit</h2>\n<p>åœ¨åˆå§‹åŒ–æ—¶ï¼Œæˆ‘ä»¬è¿›è¡Œäº† mutation æ–¹æ³•çš„åˆå§‹åŒ–ï¼Œå¯ä»¥é€šè¿‡ mutation è¿›è¡Œ state çš„æ›´æ”¹ã€‚</p>\n<pre><code class=\"language-js\">function registerMutation (store, type, handler, local) {\n  const entry = store._mutations[type] || (store._mutations[type] = [])\n  entry.push(function wrappedMutationHandler (payload) {\n    handler.call(store, local.state, payload)\n  })\n}\n</code></pre>\n<p>è¿™é‡Œæˆ‘ä»¬ä¹Ÿèƒ½æ˜ç™½åœ¨ <code>mutation</code> ä¸­æ”¹å˜çš„æ•°æ®æ˜¯å½“å‰æ¨¡å—çš„æ•°æ®ï¼Œè®¿é—®çš„ <code>this</code> æ˜¯ <code>store</code> . ç„¶åå°†æ¯ä¸ª <code>mutation</code> å­˜å…¥åˆ°<code> store._mutations[type]</code> ä¸­</p>\n<p>ç„¶åæˆ‘ä»¬å†çœ‹çœ‹ commit, store æä¾› commit æ¥æäº¤ commit</p>\n<pre><code class=\"language-js\">commit (_type, _payload, _options) {\n\n    // è§„èŒƒä¼ å…¥çš„å‚æ•°\n    const {\n        type,\n        payload,\n        options\n    } = unifyObjectStyle(_type, _payload, _options)\n\n  \n\n    const mutation = { type, payload }\n    // è·å–å­˜æ”¾çš„æ–¹æ³•\n    const entry = this._mutations[type]\n    // æ‰§è¡Œmutationæ”¹å˜state\n    this._withCommit(() =&gt; {\n        entry.forEach(function commitIterator (handler) {\n            handler(payload)\n        })\n    })\n    // æä¾›ç»™è®¢é˜…è€…ä½¿ç”¨ï¼Œä¸€èˆ¬æ˜¯æ’ä»¶\n    this._subscribers\n    .slice() \n    .forEach(sub =&gt; sub(mutation, this.state))\n}\n</code></pre>\n<p>ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œmutationå¿…é¡»æ˜¯åŒæ­¥çš„ï¼Œä¸ç„¶ä¸‹é¢é€šçŸ¥ è®¢é˜…è€… çš„é€»è¾‘ä¼šå‡ºé”™</p>\n<h2 id=\"42-action--dispatch\">4.2 Action &amp; dispatch</h2>\n<p>Action å’Œ Mutationçš„åŒºåˆ«å°±æ˜¯ Actionæ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥å®ƒä»¬å¤§éƒ¨åˆ†é€»è¾‘è¿˜æ˜¯å·®ä¸å¤šçš„ï¼Œåªæ˜¯åœ¨å¼‚æ­¥å¤„ç†å’Œé€šçŸ¥ä¸Šæœ‰åŒºåˆ«</p>\n<pre><code class=\"language-js\">...\n// æ‰§è¡Œå‰hook\ntry {\n    this._actionSubscribers\n    .slice()\n    .filter(sub =&gt; sub.before)\n    .forEach(sub =&gt; sub.before(action, this.state))\n} catch (e) {\n}\n\n  \nconst result = entry.length &gt; 1\n? Promise.all(entry.map(handler =&gt; handler(payload)))\n: entry[0](payload)\n\n\nreturn new Promise((resolve, reject) =&gt; {\n    // å®Œæˆhook å’Œ error hook\n    result.then(res =&gt; {\n        this._actionSubscribers\n        .filter(sub =&gt; sub.after)\n        .forEach(sub =&gt; sub.after(action, this.state))\n        \n        resolve(res)\n    }, error =&gt; {\n        this._actionSubscribers\n        .filter(sub =&gt; sub.error)\n        .forEach(sub =&gt; sub.error(action, this.state, error))\n        \n        reject(error)\n    })\n})\n</code></pre>\n<h2 id=\"42-mapstate\">4.2 mapState</h2>\n<p>åœ¨ <code>src/helper.js</code>ä¸­</p>\n<pre><code class=\"language-js\">export const mapState = normalizeNamespace((namespace, states) =&gt; {\n\n    const res = {}\n\n    normalizeMap(states).forEach(({ key, val }) =&gt; {\n        // ç»„æˆgetterå‡½æ•°\n        res[key] = function mappedState () {\n            let state = this.$store.state\n            let getters = this.$store.getters\n            // æœ‰å‘½åç©ºé—´å°±ä½¿ç”¨æ¨¡å—çš„æ•°æ®ï¼Œä¸ç„¶å°±ä½¿ç”¨æ ¹çš„\n            // è¿™é‡Œçš„this æ˜¯æŒ‡å‘ç»„ä»¶çš„\n            if (namespace) {\n                const module = getModuleByNamespace(this.$store, \t\t&#39;mapState&#39;,namespace)\n                if (!module) {\n                    return\n                }\n                state = module.context.state\n                getters = module.context.getters\n            }\n\n        return typeof val === &#39;function&#39; ? val.call(this, state, getters): state[val]\n    }\n\n    // mark vuex getter for devtools\n        res[key].vuex = true\n\n    })\n    return res\n})\n</code></pre>\n<p>è¿™é‡Œçš„ä¸»è¦é€»è¾‘æ˜¯ å¾—åˆ°ä¸€äº›getterå‡½æ•°ï¼Œå…¶ä¸­ä¹ŸåŒ…æ‹¬å¯¹ä¸€äº›å‘½åç©ºé—´çš„å¤„ç†ã€‚è¿™é‡Œå…¼å®¹äº†valæ˜¯å‡½æ•°è¿˜æ˜¯å­—ç¬¦ä¸²çš„æƒ…å†µã€‚</p>\n<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ <code>normalizeNamesapce</code> å‡½æ•°å¹²äº†å•¥ï¼Œ</p>\n<pre><code class=\"language-js\">function normalizeNamespace (fn) {\n    return (namespace, map) =&gt; {\n        if (typeof namespace !== &#39;string&#39;) {\n            map = namespace\n            namespace = &#39;&#39;\n        } else if (namespace.charAt(namespace.length - 1) !== &#39;/&#39;) {\n            namespace += &#39;/&#39;\n        }\n        return fn(namespace, map)\n    }\n}\n</code></pre>\n<p>å…¶å®å¯¹äº <code>namespace/state</code>åšå¤„ç†ï¼Œæ‹¿åˆ°æ–œæ å‰çš„å‘½åç©ºé—´ ç„¶åå¯¹å‡½æ•°è¿›è¡ŒåŒ…è£¹ï¼Œå…¼å®¹ä¼ å‘½åç©ºé—´å’Œä¸ç©¿å‘½åç©ºé—´çš„ä¸¤ç§æƒ…å†µã€‚</p>\n<h2 id=\"43-mapmutations\">4.3 mapMutations</h2>\n<p>å…¶å® <code>mapMutations</code> çš„é€»è¾‘å’Œ <code>mapState</code> å·®ä¸å¤šï¼Œè¿™é‡Œè®²ä¸€ä¸‹æ ¸å¿ƒçš„é€»è¾‘å°±å¥½äº†</p>\n<pre><code class=\"language-js\">\nres[key] = function mappedMutation (...args) {\n    let commit = this.$store.commit\n    // æ²¡namespaceå°±ç”¨storeçš„é¡¶çº§commit,ä¸ç„¶å°±ä½¿ç”¨æ¨¡å—ä¸Šä¸‹æ–‡è‡ªå·±çš„commit\n    if (namespace) {\n        const module = getModuleByNamespace(this.$store, &#39;mapMutations&#39;, namespace)\n        if (!module) return\n        commit = module.context.commit\n    }\n    // ç„¶åæ‰§è¡Œcommitå‡½æ•°ï¼Œä¹Ÿæ”¯æŒvalæ˜¯å‡½æ•°çš„æƒ…å†µï¼Œå°†commitè¿›è¡Œä¼ å…¥\n    return typeof val === &#39;function&#39;\n    ? val.apply(this, [commit].concat(args))\n\n    : commit.apply(this.$store, [val].concat(args))\n\n}\n</code></pre>\n<p>å…¶ä»–çš„ <code>mapGetters</code>, <code>mapActions</code> çš„é€»è¾‘éƒ½ä¸å…¶ç±»ä¼¼ã€‚ </p>\n<h1 id=\"5-æ’ä»¶\">5. æ’ä»¶</h1>\n<p>æ’ä»¶å¹³æ—¶ç”¨çš„è¿˜æ˜¯å¾ˆå°‘çš„ï¼Œä¹Ÿå°±å­¦ä¹ æ•™ç¨‹æ—¶çŸ¥é“ä¸€ä¸ª <code>logger</code> æ’ä»¶ï¼Œè¿˜æœ‰ <code>Vuex æŒä¹…åŒ–</code>çš„æ’ä»¶ã€‚\nç°åœ¨å°±é¡ºä¾¿ç ”ç©¶ä¸‹æ’ä»¶æœºåˆ¶, æ˜¾ç¤ºæ’ä»¶æ¿€æ´»</p>\n<pre><code class=\"language-js\">plugins.forEach(plugin =&gt; plugin(this))\n</code></pre>\n<p>ä»£ç å…¶å®å°±æ˜¯å°† <code>store</code> ä¼ é€’ç»™æ’ä»¶ï¼Œç„¶åæ’ä»¶è°ƒç”¨ <code>store.subscribe</code> è®¢é˜… <code>mutation</code> äº‹ä»¶ï¼Œæˆ–è€…è®¢é˜… <code>action</code> äº‹ä»¶ã€‚</p>\n<p>çœ‹äº†è¿™ä¹ˆå¤šæºç ï¼Œæƒ³ä¸€ä¸‹ æŒä¹…åŒ–æ’ä»¶ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿ </p>\n<p>æˆ‘è§‰å¾—å¯ä»¥åœ¨æ¯æ¬¡æ•°æ®æ”¹å˜å å°†å½“å‰ <code>state</code> å­˜åˆ° <code>localStorage</code> ä¸­ï¼Œå½“ <code>store</code> åœ¨æ¿€æ´»æ’ä»¶æ—¶ï¼Œä» <code>localStorage</code> ä¸­æ‹¿åˆ°æ—§çš„æ•°æ®ï¼Œç„¶åæ”¹å˜ <code>$$state</code></p>\n<p>çœ‹äº†ä¸‹æºç æœç„¶é€»è¾‘å·®ä¸å¤š <a href=\"https://github.com/robinvdvleuten/vuex-persistedstate/blob/master/src/index.ts\">Vuex-persistedstate</a></p>\n<h1 id=\"6-æ€»ç»“\">6. æ€»ç»“</h1>\n<p>çœ‹å®Œæºç åæˆ‘çš„6ä¸ªç–‘é—®è§£å†³äº†5ä¸ªï¼Œæ”¶è·è¿˜æ˜¯å¾ˆå¤§çš„ã€‚å¯¹äºè‡ªå·±å¹³æ—¶çš„å¼€å‘ï¼Œå¦‚æœçŠ¶æ€æ¯”è¾ƒå¤šçš„è¯ï¼Œå­æ¨¡å—å’Œå‘½åç©ºé—´çš„ç¡®å¾ˆå¥½ç”¨ã€‚æ¯•ç«Ÿ Vuex èŠ±äº†å¾ˆå¤§ç²¾åŠ›å»å¤„ç†è¿™å—é€»è¾‘ã€‚</p>\n<p>è¿˜æœ‰æ’ä»¶çš„è®¾è®¡ï¼Œä¹Ÿè®©æˆ‘å­¦ä¼šäº†å¦‚ä½•å»åˆ¶ä½œ Vuex æ’ä»¶å’Œ è®¾è®¡æ’ä»¶ç³»ç»Ÿ</p>\n<p>å½“ç„¶è¿˜æœ‰æœ€åçš„ç–‘é—®ï¼Œä¸ºå•¥éœ€è¦Mutationï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨Actionå‘¢ï¼Ÿåƒ <a href=\"https://pinia.vuejs.org/\">pinia</a> ä¸­å°±æ”¾å¼ƒäº†Mutation.</p>\n<p>æˆ‘å…¶å®ä¹Ÿæœ‰äº†ç­”æ¡ˆï¼Œæ­£å¦‚ä½œè€…è¯´çš„ï¼ŒMutationå…¶å®æ˜¯ä¸ºäº†æ›´å¥½çš„è¿½è¸ªçŠ¶æ€çš„æ”¹å˜ï¼Œæ–¹ä¾¿devtoolså»æ•æ‰ï¼ŒåŒæ—¶æ•°æ®æ›´æ”¹åèƒ½å¤ŸåŠæ—¶åŒæ­¥æ’ä»¶ï¼Œä¿è¯æ’ä»¶è·å–çš„æ•°æ®æ˜¯æ­£ç¡®çš„ã€‚</p>\n<p>å½“ç„¶ç›´æ¥ä½¿ç”¨Actionä¹Ÿæ˜¯å¯ä»¥ï¼Œå› ä¸ºActionä¹Ÿèƒ½å¤Ÿé€šçŸ¥è®¢é˜…è€…ã€‚ä¸”ç”¨æˆ·ç›´æ¥æ›´æ”¹æ•°æ®ä¹Ÿä¸ä¼šå½±å“å“åº”å¼çš„åŠŸèƒ½ã€‚æ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ Mutation è¢«æ”¾å¼ƒçš„åŸå› ã€‚</p>\n",
        "title": "Vuex æºç å­¦ä¹ ",
        "created": "2022-06-11 10:08:27  ",
        "updated": "2022-06-11 12:38:18 ",
        "excerpt": "1. æˆ‘çš„ç–‘é—® 1.1 $storeæ˜¯æ€ä¹ˆä¿è¯æ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥è¿›è¡Œè®¿é—®çš„ 1.2. ä¸ºä»€ä¹ˆéœ€è¦Mutation,è€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨Action 1.3. mapStateç­‰æ–¹æ³•æ˜¯æ€ä¹ˆæ˜ å°„åˆ°ç»„ä»¶çš„ 1.4. æ€ä¹ˆå’ŒVueçš„å“åº”å¼ç»“åˆèµ·æ¥çš„ 1.5....",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "6"
    },
    "7": {
        "content": "<h2 id=\"1-ä¸ºä»€ä¹ˆè¦å­¦ä¹ æºç \">1. ä¸ºä»€ä¹ˆè¦å­¦ä¹ æºç </h2>\n<p>å°±ç°æœ‰çš„å‰ç«¯æ¡†æ¶æ¥è¯´ï¼Œé˜…è¯»æºç å…¶å®æ˜¯å›°éš¾çš„ã€‚ä¾‹å¦‚Vue,React, è¿™äº›å·¥ä¸šæ¡†æ¶ä¸ºäº†å¤„ç†å„ç§è¾¹ç•Œæƒ…å†µï¼Œä¼šè®©ä»£ç å˜å¾—ä¸é‚£ä¹ˆæ¸…æ™°ã€‚è€Œæˆ‘ä»¬åœ¨è¿›è¡Œå­¦ä¹ æ—¶å°±éœ€è¦ä»ç¹åˆ°ç®€ï¼Œç†æ¸…æ ¸å¿ƒé€»è¾‘ï¼Œå­¦ä¹ æ ¸å¿ƒåŸç†ã€‚</p>\n<p>è‡³äºå­¦ä¹ æ¡†æ¶çš„åŸå› ï¼Œä¹Ÿå¾ˆç®€å•ã€‚æˆ‘è‡ªå·±æœ‰ä¸‰å¤§ç†ç”±</p>\n<ol>\n<li>é¢è¯•ï¼Œå¼€å·å°±æ˜¯äº†</li>\n<li>å­¦ä¹ ä¼˜ç§€çš„ä»£ç ç»“æ„å’Œé€»è¾‘</li>\n<li>å¢åŠ å¼€å‘èƒ½åŠ›ï¼Œäº†è§£åŸç†åèƒ½å¤Ÿæ›´å¥½çš„è¿›è¡Œå¼€å‘å’Œä¼˜åŒ–</li>\n</ol>\n<h2 id=\"2--å¦‚ä½•å»å­¦ä¹ æºç \">2.  å¦‚ä½•å»å­¦ä¹ æºç </h2>\n<p>å¦‚ä½•å»å­¦ä¹ æºç é€”å¾„æœ‰å¾ˆå¤šï¼Œå›¾çœäº‹å’Œå›«å›µåæ£å°±å¯ä»¥ç›´æ¥çœ‹å…¶ä»–äººçš„æ–‡ç« æˆ–è€…è§†é¢‘ã€‚è¿™ç§æ•ˆç‡æœ€é«˜ï¼Œä»¥é¢è¯•ä½œä¸ºéœ€æ±‚çš„å®Œå…¨å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼è¿›è¡Œå­¦ä¹ ã€‚</p>\n<p>æˆ‘ä¸ªäººæ¯”è¾ƒä¹ æƒ¯å¸¦ç€é—®é¢˜å»çœ‹æºç ï¼Œä»¥<strong>ä»€ä¹ˆæ˜¯æ€ä¹ˆå®ç°çš„</strong>çš„ç–‘é—®å»é˜…è¯»æºç å…¶å®æ•ˆç‡è¿˜æ˜¯å¾ˆé«˜çš„ã€‚æ— è®ºæ˜¯é˜…è¯»èŒƒå›´è¿˜æ˜¯é˜…è¯»æ”¶è·éƒ½æœ‰ä¸€ä¸ªå¯ä»¥é‡åŒ–çš„åŒºé—´ï¼Œä¸ä¼šé™·å…¥åˆ°æ— å¤„ä¸‹æ‰‹çš„åœ°æ­¥ã€‚</p>\n<p>æˆ‘åé¢çš„ç›¸å…³æ–‡ç« ä¹Ÿä¼šå¸¦ç€ç–‘é—®å»è¿›è¡Œå­¦ä¹ ã€‚ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä¹Ÿä¼šå¯¹æºç ä¸­å¼•ç”¨çš„ä¸€äº›ç¬¬ä¸‰æ–¹åº“å’Œæ’ä»¶è¿›è¡Œæ€»ç»“ï¼Œæ–¹ä¾¿åç»­è‡ªå·±ä½¿ç”¨</p>\n<h2 id=\"3-ç³»åˆ—\">3. ç³»åˆ—</h2>\n<ol>\n<li><a href=\"https://github.com/vivipure/blog/issues/6\">Vuexæºç å­¦ä¹ </a></li>\n</ol>\n",
        "title": "æºç å­¦ä¹ ç³»åˆ—",
        "created": "2022-06-11 10:10:08  ",
        "updated": "2022-06-11 10:10:08 ",
        "excerpt": "1. ä¸ºä»€ä¹ˆè¦å­¦ä¹ æºç  å°±ç°æœ‰çš„å‰ç«¯æ¡†æ¶æ¥è¯´ï¼Œé˜…è¯»æºç å…¶å®æ˜¯å›°éš¾çš„ã€‚ä¾‹å¦‚Vue,React, è¿™äº›å·¥ä¸šæ¡†æ¶ä¸ºäº†å¤„ç†å„ç§è¾¹ç•Œæƒ…å†µï¼Œä¼šè®©ä»£ç å˜å¾—ä¸é‚£ä¹ˆæ¸…æ™°ã€‚è€Œæˆ‘ä»¬åœ¨è¿›è¡Œå­¦ä¹ æ—¶å°±éœ€è¦ä»ç¹åˆ°ç®€ï¼Œç†æ¸…æ ¸å¿ƒé€»è¾‘ï¼Œå­¦ä¹ æ ¸å¿ƒåŸç†ã€‚ è‡³äºå­¦ä¹ æ¡†æ¶çš„åŸå› ï¼Œä¹Ÿå¾ˆ...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "7"
    },
    "8": {
        "content": "<h1 id=\"1-æˆ‘çš„ç–‘é—®\">1. æˆ‘çš„ç–‘é—®</h1>\n<p>Vue Router çš„ä½¿ç”¨é¢‘ç‡è¿˜æ˜¯å¾ˆé«˜çš„ï¼Œä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬å¯èƒ½çŸ¥é“ hashè·¯ç”±å’Œ historyè·¯ç”± çš„åŒºåˆ«å’Œå®ç°åŸç†ã€‚ä½†æ˜¯ä¸€äº›è¿˜æ˜¯ä¸œè¥¿æ˜¯å€¼å¾—ç†è§£çš„ã€‚</p>\n<ol>\n<li>å†…ç½®ç»„ä»¶ router-view æ˜¯æ€ä¹ˆå®ç°çš„</li>\n<li>è·¯ç”±å®ˆå«æ˜¯æ€ä¹ˆå®ç°çš„</li>\n<li>å’ŒTransitionæ˜¯æ€ä¹ˆæ­é…åˆä½œçš„</li>\n<li>routes æ•°æ®æ˜¯æ€ä¹ˆè§£æçš„</li>\n<li>å’Œkeep-alive æ˜¯æ€ä¹ˆé…åˆ</li>\n</ol>\n<h1 id=\"2-åŸºæœ¬ä»‹ç»\">2. åŸºæœ¬ä»‹ç»</h1>\n<p>è¿™é‡Œå°±ä¸ä»‹ç»åŸºæœ¬çš„ä½¿ç”¨</p>\n<p>é¡¹ç›®åœ°å€ï¼š<a href=\"https://github.com/vuejs/vue-router\">https://github.com/vuejs/vue-router</a>\næ„å»ºå·¥å…·ï¼š Rollup\nå…¥å£æ–‡ä»¶ï¼šsrc/index.js</p>\n<h1 id=\"3--å…¥å£æ–‡ä»¶åˆ†æ\">3.  å…¥å£æ–‡ä»¶åˆ†æ</h1>\n<h2 id=\"31-install\">3.1 install</h2>\n<p>çœ‹ä¸‹ install å‡½æ•°æ‰§è¡Œçš„é€»è¾‘</p>\n<pre><code class=\"language-js\">export function install (Vue) {\n    // é¿å…é‡å¤æ³¨å†Œ\n    if (install.installed &amp;&amp; _Vue === Vue) return\n    install.installed = true\n    _Vue = Vue\n    const isDef = v =&gt; v !== undefined\n    // æš‚æ—¶ä¸çŸ¥é“å°‘ç”¨\n    const registerInstance = (vm, callVal) =&gt; {\n        let i = vm.$options._parentVnode\n        if (\n            isDef(i) &amp;&amp; isDef(i = i.data) &amp;&amp; isDef(i = i.registerRouteInstance)\n        ){\n            i(vm, callVal)\n        }\n    }\n    // æ··å…¥é€»è¾‘ï¼Œ\n    Vue.mixin({\n        beforeCreate () {\n            if (isDef(this.$options.router)) {\n                // è‡ªèº«\n                this._routerRoot = this\n                // è·¯ç”±å®ä¾‹\n                this._router = this.$options.router\n                this._router.init(this)\n                // å®šä¹‰route,æŒ‡å‘å½“å‰æ¿€æ´»è·¯ç”±\n                Vue.util.defineReactive(\n                    this, &#39;_route&#39;,\n                    this._router.history.current)\n            } else {\n                // ç”±äºæ˜¯æ ‘å½¢ç»“æ„ï¼Œå› æ­¤å­ç»„ä»¶ä¼šæ‰¾åˆ°ç¦»è‡ªå·±æœ€è¿‘çš„ å¸¦æœ‰routerçš„ç»„ä»¶\n                this._routerRoot = \n                    (this.$parent &amp;&amp; this.$parent._routerRoot) || this\n            }\n            registerInstance(this, this)\n        },\n        destroyed () {\n            registerInstance(this)\n        }\n    })\n\n \n    // å®šä¹‰å…¨å±€å±æ€§\n    Object.defineProperty(Vue.prototype, &#39;$router&#39;, {\n        get () { return this._routerRoot._router }\n    })\n    Object.defineProperty(Vue.prototype, &#39;$route&#39;, {\n        get () { return this._routerRoot._route }\n    })\n    // ç»„ä»¶æ³¨å†Œ\n    Vue.component(&#39;RouterView&#39;, View)\n    Vue.component(&#39;RouterLink&#39;, Link)\n}\n</code></pre>\n<p>ç›¸å…³æ³¨é‡Šæˆ‘éƒ½å†™åœ¨ä»£ç ä¸­äº†ï¼Œä¸»è¦é€»è¾‘å°±æ˜¯åœ¨ç»„ä»¶ä¸­æ··å…¥äº†è·¯ç”±çš„å±æ€§ï¼Œå®šä¹‰å…¨å±€çš„å±æ€§ï¼Œæ³¨å†Œäº†ä¸¤ä¸ªå†…ç½®ç»„ä»¶ã€‚</p>\n<p>è¿™é‡Œæ¯”è¾ƒå·§å¦™çš„æ˜¯é€šè¿‡æ ‘å½¢ç»“æ„çš„ç‰¹æ€§ï¼Œä¿è¯äº†æ‹¥æœ‰ <code>options.router</code> çš„ç»„ä»¶è¿›è¡Œäº†è·¯ç”±åˆå§‹åŒ–ï¼Œå­ç»„ä»¶æ ¹æ®çˆ¶ç»„ä»¶å±‚å±‚æŸ¥æ‰¾ï¼Œæ‰¾åˆ°ç¦»è‡ªå·±æœ€è¿‘çš„å¸¦æœ‰ <code>router</code> çš„ç»„ä»¶ã€‚</p>\n<p>ç„¶å <code>registerInstance</code> æ–¹æ³•æš‚æ—¶ä¸çŸ¥é“ç”¨æ³•ï¼Œ</p>\n<h2 id=\"32-vuerouter\">3.2 VueRouter</h2>\n<p><code>VueRouter</code> ç±»åœ¨ <code>src/index.js</code> ä¸­ï¼Œé»˜è®¤å¯¼å‡ºçš„å°±æ˜¯ <code>VueRouter</code>, æˆ‘ä»¬åœ¨ä¸šåŠ¡å¼€å‘æ—¶ä¹Ÿé€šè¿‡å®ä¾‹åŒ– <code>VueRouter</code> æ¥ç”Ÿæˆ <code>router</code> ç»™åº”ç”¨ä½¿ç”¨ã€‚</p>\n<h3 id=\"321-æ„é€ å‡½æ•°\">3.2.1 æ„é€ å‡½æ•°</h3>\n<pre><code class=\"language-js\">constructor (options: RouterOptions = {}) {\n  this.app = null\n  this.apps = []\n  this.options = options\n  this.beforeHooks = []\n  this.resolveHooks = []\n  this.afterHooks = []\n    \n  this.matcher = createMatcher(options.routes || [], this)\n    \n  // æ ¹æ®optionsç»“åˆå®é™…æµè§ˆå™¨ç¡®å®š è·¯ç”±æ¨¡å¼\n  let mode = options.mode || &#39;hash&#39;\n  this.fallback = mode === &#39;history&#39; &amp;&amp; !supportsPushState &amp;&amp; options.fallback !== false\n  if (this.fallback) {\n    mode = &#39;hash&#39;\n  }\n    // å¦‚æœä¸åœ¨æµè§ˆå™¨åˆ™ä¸º abstractæ¨¡å¼\n  if (!inBrowser) {\n    mode = &#39;abstract&#39;\n  }\n  this.mode = mode\n  // æ ¹æ®è·¯ç”±æ¨¡å¼ç”Ÿæˆ history å¯¹è±¡\n  switch (mode) {\n    case &#39;history&#39;:\n      this.history = new HTML5History(this, options.base)\n      break\n    case &#39;hash&#39;:\n      this.history = new HashHistory(this, options.base, this.fallback)\n      break\n    case &#39;abstract&#39;:\n      this.history = new AbstractHistory(this, options.base)\n      break\n    default:\n      if (process.env.NODE_ENV !== &#39;production&#39;) {\n        assert(false, `invalid mode: ${mode}`)\n      }\n  }\n}\n</code></pre>\n<p>è¿™é‡Œä¸»è¦çš„é€»è¾‘å°±æ˜¯é€šè¿‡<code> options.router</code> ç”Ÿæˆ <code>matcher</code>, å’Œé€šè¿‡è·¯ç”±æ¨¡å¼ç”Ÿæˆå¯¹åº”çš„ <code>history</code>å¯¹è±¡. \né€šè¿‡è¿™é‡Œæˆ‘æ‰çŸ¥é“åŸæ¥ è·¯ç”±è¿˜æœ‰ <code>abstract</code> æ¨¡å¼, æä¾›ç»™æœåŠ¡ç«¯æˆ–è€…ssræ¨¡å¼ä½¿ç”¨ï¼Œåº”è¯¥å’ŒV4ç‰ˆæœ¬çš„ <code>Memory mode</code>æ˜¯ä¸€æ ·çš„ã€‚</p>\n<h3 id=\"322-init\">3.2.2 init</h3>\n<p>åœ¨ <code>install</code>çš„è¿‡ç¨‹ä¸­ï¼Œ<code>VueRouter</code> å¾€ <code>Vue</code> ä¸­ <code>beforeCreated</code> é€»è¾‘, å¯¹æœ‰ <code>router</code> çš„ <code>options</code> è¿›è¡Œäº†è·¯ç”±åˆå§‹åŒ–</p>\n<pre><code>this._router.init(this)\n</code></pre>\n<p>å› æ­¤æˆ‘ä»¬å†çœ‹çœ‹ <code>router</code> çš„ <code>init</code> æ–¹æ³•</p>\n<pre><code class=\"language-js\">init (app: any) {\n  // å°†å½“å‰ç»„ä»¶æ¨å…¥ app ä¸­\n  this.apps.push(app)\n  if (this.app) {\n    return\n  }\n  this.app = app\n        \n\n  const history = this.history\n  // å±äºhash å’Œ history æ¨¡å¼\n  if (history instanceof HTML5History || history instanceof HashHistory) {\n     // scrollBehavioræ”¯æŒ\n       const handleInitialScroll = routeOrError =&gt; {\n        const from = history.current\n        const expectScroll = this.options.scrollBehavior\n        const supportsScroll = supportsPushState &amp;&amp; expectScroll\n        if (supportsScroll &amp;&amp; &#39;fullPath&#39; in routeOrError) {\n            handleScroll(this, routeOrError, from, false)\n        }\n    }\n    const setupListeners = routeOrError =&gt; {\n        history.setupListeners()\n        handleInitialScroll(routeOrError)\n    }\n    // åˆ‡æ¢åˆ°å½“å‰é“¾æ¥å¯¹åº”çš„è·¯ç”±\n    history.transitionTo(\n        history.getCurrentLocation(),\n        setupListeners,\n        setupListeners\n    )\n  }\n  // è·¯ç”±æ›´æ–°åï¼Œæ›´æ–°ç»„ä»¶çš„_route\n  history.listen(route =&gt; {\n    this.apps.forEach((app) =&gt; {\n      app._route = route\n    })\n  })\n}\n</code></pre>\n<p>åˆå§‹åŒ–æ—¶å°†å½“å‰ç»„ä»¶è¿›è¡Œä¿å­˜ï¼Œå°†<strong>å½“å‰è·¯ç”±</strong>åˆ‡æ¢åˆ°<strong>å½“å‰é“¾æ¥</strong>å¯¹åº”è·¯ç”±ï¼Œä¹Ÿè®¾ç½®äº†è®¢é˜…ï¼Œå½“ <code>history</code> æ”¹å˜æ—¶ï¼Œä¼šæ›´æ–°ç»„ä»¶çš„ <code>route</code>ã€‚</p>\n<h3 id=\"323-transitionto\">3.2.3 transitionTo</h3>\n<p>çœ‹ä¸‹ <code>tansitionTo</code> çš„å®é™…é€»è¾‘</p>\n<pre><code class=\"language-js\">// åŒ¹é…åˆ°è·¯ç”±\nroute = this.router.match(location, this.current)\nconst prev = this.current\n\n// è¿›è¡Œåˆ‡æ¢åŠ¨ç”»\nthis.confirmTransition(\n    route,\n    () =&gt; {\n        // æ›´æ–°å½“å‰è·¯ç”±\n        this.updateRoute(route)\n        onComplete &amp;&amp; onComplete(route)\n        // æ›´æ”¹url\n        this.ensureURL()\n        // hook\n        this.router.afterHooks.forEach(hook =&gt; {\n            hook &amp;&amp; hook(route, prev)\n        })\n        // åˆå§‹åŒ–å›è°ƒ\n        if (!this.ready) {\n            ...\n        }\n    },\n    err =&gt; {\n    // é”™è¯¯å¤„ç†\n})\n\n\nconfirmTransition (route: Route, onComplete: Function, onAbort?: Function) {\n    const current = this.current\n    this.pending = route\n    // é”™è¯¯å¤„ç†\n    const abort = err =&gt; {}\n    // å½“å‰è·¯ç”±é‡å¤å¯¼èˆªå¤„ç†\n    if (isDuplicatedRoute) {\n        this.ensureURL()\n        if (route.hash) {\n            handleScroll(this.router, current, route, false)\n        }\n        return abort(createNavigationDuplicatedError(current, route))\n    }\n    \n    const { updated, deactivated, activated } = resolveQueue(\n        this.current.matched,\n        route.matched\n    )\n    const queue: Array&lt;?NavigationGuard&gt; = [].concat(\n        // in-component leave guards\n        extractLeaveGuards(deactivated),\n        // global before hooks\n        this.router.beforeHooks,\n        // in-component update hooks\n        extractUpdateHooks(updated),\n        // in-config enter guards\n        activated.map(m =&gt; m.beforeEnter),\n        // async components\n        resolveAsyncComponents(activated)\n    )\n    const iterator = (hook: NavigationGuard, next) =&gt; {\n        if (this.pending !== route) {\n            return abort(createNavigationCancelledError(current, route))\n        }\n        try {\n            hook(route, current, (to: any) =&gt; {\n                if (to === false) {\n                    // next(false) -&gt; abort navigation, ensure current URL\n                    this.ensureURL(true)\n                    abort(createNavigationAbortedError(current, route))\n                } else if (isError(to)) {\n                    this.ensureURL(true)\n                    abort(to)\n                } else if (\n                    typeof to === &#39;string&#39; ||\n                    (typeof to === &#39;object&#39; &amp;&amp;\n                    (typeof to.path === &#39;string&#39; || typeof to.name === &#39;string&#39;))\n                ) {\n                    // next(&#39;/&#39;) or next({ path: &#39;/&#39; }) -&gt; redirect\n                    abort(createNavigationRedirectedError(current, route))\n                    if (typeof to === &#39;object&#39; &amp;&amp; to.replace) {\n                        this.replace(to)\n                    } else {\n                        this.push(to)\n                    }\n                } else {\n                    // confirm transition and pass on the value\n                    next(to)\n                }\n            })\n        } catch (e) {\n            abort(e)\n        }\n    }\n\n    runQueue(queue, iterator, () =&gt; {\n        // wait until async components are resolved before\n        // extracting in-component enter guards\n        const enterGuards = extractEnterGuards(activated)\n        const queue = enterGuards.concat(this.router.resolveHooks)\n        runQueue(queue, iterator, () =&gt; {\n            if (this.pending !== route) {\n                return abort(createNavigationCancelledError(current, route))\n            }\n            this.pending = null\n            onComplete(route)\n            if (this.router.app) {\n                this.router.app.$nextTick(() =&gt; {\n                    handleRouteEntered(route)\n                })\n            }\n        })\n    })\n}\n</code></pre>\n<p>è¿™é‡Œä¸»è¦æ‰§è¡Œ <code>confirmTransition</code> æ–¹æ³•ï¼Œä¸»è¦é€»è¾‘åˆ†ä¸ºå‡ æ­¥ï¼š</p>\n<ol>\n<li>æ£€æŸ¥æ˜¯å¦é‡å¤è·¯ç”±ï¼Œè¿›è¡Œå¤„ç†</li>\n<li>ç”¨ <code>reolveQuene</code> ç­›é€‰å‡ºå½“å‰è·¯ç”±å’Œè·³è½¬è·¯ç”±çš„å·®å¼‚</li>\n<li>ç„¶åå¯¹è¿­ä»£ä¸€ä¸ªé˜Ÿåˆ—ï¼Œé˜Ÿåˆ—åŒ…å«<ol>\n<li>æ¿€æ´»å¤±æ•ˆç»„ä»¶ <code>beforeLeave</code> è·¯ç”±å®ˆå«</li>\n<li>å…¨å±€è·¯ç”± <code>beforHooks</code></li>\n<li>é‡ç”¨ç»„ä»¶ <code>update</code> è·¯ç”±å®ˆå«</li>\n<li>æ¿€æ´»è·¯ç”± é…ç½®çš„<code>beforeEnter hook</code></li>\n<li>å¤„ç†å¼‚æ­¥ç»„ä»¶åŠ è½½é€»è¾‘\nå¦‚æœé¡ºåºæ‰§è¡Œä¸­æœ‰ä¸€ä¸ªä»»åŠ¡å¤±è´¥ï¼Œåˆ™ä¸ä¼šç»§ç»­ä¸‹é¢çš„ä»»åŠ¡</li>\n</ol>\n</li>\n<li>é˜Ÿåˆ—è·‘å®Œä¹‹åï¼Œæ‰§è¡Œæ–°çš„é˜Ÿåˆ—ä»»åŠ¡ã€‚é˜Ÿåˆ—åŒ…æ‹¬<ol>\n<li>æ¿€æ´»ç»„ä»¶çš„  <code>beforeEnter hook</code></li>\n<li>å…¨å±€è·¯ç”±çš„  <code>resolveHooks</code>\n æ‰§è¡Œå®Œæˆåï¼Œåœ¨ <code>nextTick</code> åæ‰§è¡Œè·¯ç”±å®Œæˆåçš„å›è°ƒæ“ä½œï¼Œè°ƒç”¨å…¨å±€çš„Â <code>afterEach</code>Â é’©å­ã€‚</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"324-matcher\">3.2.4 matcher</h3>\n<p>ä¸Šé¢çš„è·¯ç”±åˆ‡æ¢æ–¹æ³•ä¸­ï¼Œè¿›åœºä¼šæ¯”è¾ƒ <code>route</code> çš„ <code>matched</code> å±æ€§ï¼Œè€Œåœ¨æ„é€ å‡½æ•°ä¸­ä¹Ÿæœ‰</p>\n<pre><code class=\"language-js\">this.matcher = createMatcher(options.routes || [], this)\n</code></pre>\n<p>å› æ­¤æˆ‘ä»¬æ¥ç ”ç©¶ä¸‹ <code>matcher</code></p>\n<pre><code class=\"language-js\">function createMatcher (\nroutes: Array&lt;RouteConfig&gt;,\nrouter: VueRouter\n): Matcher {\n\nconst { pathList, pathMap, nameMap } = createRouteMap(routes)\n...\nreturn {\n    match,\n    addRoute,\n    getRoutes,\n    addRoutes\n}\n</code></pre>\n<p>é¦–å…ˆæ˜¯æ ¹æ®ä¼ å…¥çš„ <code>routes</code> é€šè¿‡ <code>createRouteMap</code> è§£æä¸º <code>list</code> å’Œ <code>map</code> .</p>\n<ul>\n<li>å°†ç”¨æˆ·ä¼ å…¥çš„é…ç½®è¿›è¡Œéå†ï¼Œå¯¹æ¯ä¸ªè·¯ç”±ç”Ÿæˆ RouteRecord å­˜æ”¾åˆ° pathList</li>\n<li>pathMap, nameMap æ˜¯å­˜æ”¾äº† path å’Œ name å¯¹ RouteRecord çš„æ˜ å°„</li>\n</ul>\n<pre><code class=\"language-js\">const record: RouteRecord = {\n   path: normalizedPath, // è§„èŒƒåçš„è·¯å¾„\n   regex: compileRouteRegex(normalizedPath, pathToRegexpOptions), // è·¯å¾„å¯¹åº”æ­£åˆ™\n   components: route.components || { default: route.component }, // ç»„ä»¶\n   instances: {},\n   name,\n   parent,\n   matchAs,\n   redirect: route.redirect,\n   beforeEnter: route.beforeEnter,\n   meta: route.meta || {},\n   props: route.props == null\n     ? {}\n     : route.components\n       ? route.props\n       : { default: route.props }\n }\n</code></pre>\n<p>åœ¨å¹³æ—¶çš„ä¸šåŠ¡å¼€å‘ä¸­ï¼Œè·¯ç”±çš„é…ç½®ä¸æ˜¯å›ºå®šçš„ï¼Œæ ¹æ®ç”¨æˆ·çš„æƒé™ç”Ÿäº§å¯¹åº”çš„è·¯ç”±æ‰æ˜¯åˆç†çš„ã€‚å› æ­¤ä¼šä½¿ç”¨ä¸¤ä¸ªæ–¹æ³•ï¼š</p>\n<ol>\n<li><p>addRoutes</p>\n<pre><code>function addRoutes (routes) {\n  createRouteMap(routes, pathList, pathMap, nameMap)\n}\n</code></pre>\n</li>\n<li><p>addRoute\n```js\nfunction addRoute (parentOrRoute, route) {\n const parent = (typeof parentOrRoute !== &#39;object&#39;) ? nameMap[parentOrRoute] : undefined</p>\n<p> createRouteMap([route || parentOrRoute], pathList, pathMap, nameMap, parent)\n if (parent &amp;&amp; parent.alias.length) {\n createRouteMap(\n     parent.alias.map(alias =&gt; ({ path: alias, children: [route] })),\n     pathList,\n     pathMap,\n     nameMap,\n     parent\n )\n }</p>\n</li>\n</ol>\n<p>}</p>\n<pre><code>é€»è¾‘éƒ½å¾ˆç®€å•ï¼Œç›´æ¥è°ƒç”¨ `createRouteMap` çš„æ–¹æ³•å³å¯ã€‚åœ¨æ·»åŠ å•ä¸ª `route` æ—¶åˆ™ä¼šå¤„ç†çˆ¶çº§è·¯ç”±å’Œåˆ«åçš„ç›¸å…³é€»è¾‘ã€‚\n\n`createMatcher` çš„è¿”å›å€¼ä¸­è¿˜åŒ…æ‹¬ `match` æ–¹æ³•, é€šè¿‡è¿™ä¸ªæ–¹æ³•å°† `Location` è½¬åŒ–ä¸º `Route`. è¿™é‡Œçš„ `Location` å°±æ˜¯æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨ push ç­‰æ–¹æ³•ä¼ å…¥çš„å‚æ•°ã€‚\n```ts\n type Location = {\n    _normalized?: boolean;\n    name?: string;\n    path?: string;\n    hash?: string;\n    query?: Dictionary&lt;string&gt;;\n    params?: Dictionary&lt;string&gt;;\n    append?: boolean;\n    replace?: boolean;\n}\n\n type RawLocation = string | Location\n</code></pre>\n<p>ç°åœ¨çœ‹çœ‹ match æ–¹æ³•çš„æ‰§è¡Œé€»è¾‘</p>\n<pre><code class=\"language-js\">function match (\n    raw: RawLocation,\n    currentRoute?: Route,\n    redirectedFrom?: Location\n): Route {\n    const location = normalizeLocation(raw, currentRoute, false, router)\n    const { name } = location\n    if (name) {\n        const record = nameMap[name]\n\n        if (process.env.NODE_ENV !== &#39;production&#39;) {\n            warn(record, `Route with name &#39;${name}&#39; does not exist`)\n        }\n\n        if (!record) return _createRoute(null, location)\n\n        const paramNames = record.regex.keys\n        .filter(key =&gt; !key.optional)\n        .map(key =&gt; key.name)\n\n        if (typeof location.params !== &#39;object&#39;) {\n        location.params = {}\n        }\n\n        if (currentRoute &amp;&amp; typeof currentRoute.params === &#39;object&#39;) {\n            for (const key in currentRoute.params) {\n                if (!(key in location.params) &amp;&amp; paramNames.indexOf(key) &gt; -1) {\n                    location.params[key] = currentRoute.params[key]\n                }\n            }\n        }\n\n        location.path = fillParams(record.path, location.params, `named route &quot;${name}&quot;`)\n\n        return _createRoute(record, location, redirectedFrom)\n\n    } else if (location.path) {\n        location.params = {}\n        for (let i = 0; i &lt; pathList.length; i++) {\n            const path = pathList[i]\n            const record = pathMap[path]\n            if (matchRoute(record.regex, location.path, location.params)) {\n                return _createRoute(record, location, redirectedFrom)\n            }\n        }\n    }\n    // no match\n    return _createRoute(null, location)\n}\n</code></pre>\n<ul>\n<li>å¦‚æœ <code>location</code> åŒ…å« <code>name</code> é‚£ä¹ˆåœ¨ <code>nameMap</code> ä¸­é€šè¿‡ <code>name</code> å–åˆ°è·¯ç”±</li>\n<li>å¦‚æœåŒ…å« <code>path</code> åˆ™é€šè¿‡éå† <code>pathList</code> ï¼Œ æ­£åˆ™åŒ¹é…åˆ°å¯¹åº”çš„è·¯ç”±\nä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¦‚æœä¼ é€’ <code>name</code> æ¥è·å–è·¯ç”±æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ï¼Œ<code>path</code> çš„è¯ä¼šè¿›è¡Œæ¯”è¾ƒåŒ¹é…ï¼Œå†™åœ¨å‰é¢ä¼šè¢«ä¼˜å…ˆåŒ¹é…åˆ°çš„</li>\n</ul>\n<p>æœ€ç»ˆçš„åˆ°çš„ä¸œè¥¿å°±æ˜¯ä¸€ä¸ª Routeå¯¹è±¡</p>\n<pre><code class=\"language-js\">const route: Route = {\n    name: location.name || (record &amp;&amp; record.name),\n    meta: (record &amp;&amp; record.meta) || {},\n    path: location.path || &#39;/&#39;,\n    hash: location.hash || &#39;&#39;,\n    query,\n    params: location.params || {},\n    fullPath: getFullPath(location, stringifyQuery),\n    matched: record ? formatMatch(record) : [] // è¿™é‡Œé€šè¿‡éå†çˆ¶çº§ï¼Œå¾—åˆ°å®Œæ•´çš„è·¯å¾„æ•°ç»„\n  }\n</code></pre>\n<p>ç”±äº è¿™ä¸ªå¯¹è±¡æœ€ç»ˆè¢« Object.freeze() ,å› æ­¤å®é™…ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬æ— æ³•æ›´æ”¹ä¸Šé¢çš„å±æ€§</p>\n<h1 id=\"4-å†…ç½®ç»„ä»¶\">4 å†…ç½®ç»„ä»¶</h1>\n<h2 id=\"4-1-router-link\">4. 1 router-link</h2>\n<p>router-link è‡ªåŠ¨å¤„ç†äº† a æ ‡ç­¾ ç‚¹å‡»è·³è½¬çš„æƒ…å†µï¼Œåœ¨ç‚¹å‡»æ—¶ä¼šè§¦å‘è·¯ç”±è·³è½¬çš„äº‹ä»¶</p>\n<pre><code class=\"language-js\">const handler = e =&gt; {\n    // é»˜è®¤äº‹ä»¶\n    if (guardEvent(e)) {\n        if (this.replace) {\n        router.replace(location, noop)\n\n        } else {\n\n        router.push(location, noop)\n\n        }\n    }\n}\n</code></pre>\n<h2 id=\"42-router-view\">4.2 router-view</h2>\n<pre><code class=\"language-js\">render (_, { props, children, parent, data }) {\n    // routerViewæ ‡è¯†\n    data.routerView = true\n    const h = parent.$createElement\n    const name = props.name\n    const route = parent.$route\n\n\n  \n    let depth = 0\n    let inactive = false\n    while (parent &amp;&amp; parent._routerRoot !== parent) {\n        const vnodeData = parent.$vnode ? parent.$vnode.data : {}\n        if (vnodeData.routerView) {\n            depth++\n        }\n        // keep-alive é€»è¾‘\n        if (vnodeData.keepAlive &amp;&amp; parent._directInactive &amp;&amp; parent._inactive) {\n            inactive = true\n        }\n        parent = parent.$parent\n\n    }\n    // å¾—åˆ°routerviewçš„æ·±åº¦ï¼Œç¡®å®šå½“å‰çš„è·¯ç”±\n    data.routerViewDepth = depth\n\n    // render previous view if the tree is inactive and kept-alive\n    if (inactive) {\n        const cachedData = cache[name]\n        const cachedComponent = cachedData &amp;&amp; cachedData.component\n\n        if (cachedComponent) {\n            if (cachedData.configProps) {\n                fillPropsinData(cachedComponent, data, cachedData.route, cachedData.configProps)\n            }\n            return h(cachedComponent, data, children)\n        } else {\n            return h()\n        }\n    }\n\n    const matched = route.matched[depth]\n    const component = matched &amp;&amp; matched.components[name]\n    // cache component\n    cache[name] = { component }\n\n  \n    // è¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯åœ¨åˆå§‹åŒ–çš„æ—¶å€™è¿›è¡Œçš„è°ƒç”¨\n    // ç”¨æ¥è®¾ç½®å½“å‰è·¯ç”±åŒ¹é…çš„ç»„ä»¶å®ä¾‹\n    data.registerRouteInstance = (vm, val) =&gt; {\n        const current = matched.instances[name]\n        if (\n        (val &amp;&amp; current !== vm) ||\n        (!val &amp;&amp; current === vm)\n        ) {\n            matched.instances[name] = val\n        }\n    }\n    // hookæ³¨å…¥\n    data.hook.prepatch = (_, vnode) =&gt; {\n        matched.instances[name] = vnode.componentInstance\n    }\n    data.hook.init = (vnode) =&gt; {\n        if (vnode.data.keepAlive &amp;&amp;\n        vnode.componentInstance &amp;&amp;\n        vnode.componentInstance !== matched.instances[name]\n        ) {\n        matched.instances[name] = vnode.componentInstance\n        }\n        handleRouteEntered(route)\n    }\n\n    const configProps = matched.props &amp;&amp; matched.props[name]\n    return h(component, data, children)\n\n}\n</code></pre>\n<p>ä¸»è¦é€»è¾‘å°±æ˜¯ï¼š</p>\n<ol>\n<li>æ ‡è¯†å½“å‰è·¯ç”±ä¸º routerview</li>\n<li>å¾€çˆ¶çº§éå†ï¼Œå¾—åˆ°å½“å‰çš„ routerview æ·±åº¦ï¼Œç¡®å®š route</li>\n<li>å…¼å®¹ keep-alive çš„é€»è¾‘ï¼Œå¤„ç†ç¼“å­˜é€»è¾‘</li>\n<li>æ¸²æŸ“ç»„ä»¶</li>\n</ol>\n<h1 id=\"5-æœ€åæ€»ç»“\">5. æœ€åæ€»ç»“</h1>\n<p>çœ‹å®Œæ ¸å¿ƒé€»è¾‘åï¼Œæˆ‘æœ€åˆçš„ç–‘é—®åŸºæœ¬å¾—åˆ°äº†è§£ç­”ã€‚æ„Ÿè§‰è¿˜æ˜¯æŒºæœ‰æ”¶è·çš„ã€‚çŸ¥é“äº†è·¯ç”±çš„ç¬¬ä¸‰ç§æ¨¡å¼ï¼Œè·¯ç”±åˆ‡æ¢çš„æ•´ä½“è¿‡ç¨‹ï¼Œè·¯ç”±çš„åŒ¹é…é€»è¾‘ã€‚ä¹Ÿäº†è§£äº† router-view è¿™ç§å‡½æ•°å¼ç»„ä»¶çš„å®ç°ã€‚\næˆ‘è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æœªå¾—åˆ°ç­”æ¡ˆ</p>\n<pre><code>3. å’ŒTransitionæ˜¯æ€ä¹ˆæ­é…åˆä½œçš„\n</code></pre>\n<p>çœ‹æ¥åªæœ‰åˆ°æ—¶å€™çœ‹ Vue æºç æ—¶æ‰èƒ½æœ‰æ”¶è·äº†.</p>\n",
        "title": "Vue Router æºç å­¦ä¹ ",
        "created": "2022-06-13 16:35:26  ",
        "updated": "2022-06-13 16:35:26 ",
        "excerpt": "1. æˆ‘çš„ç–‘é—® Vue Router çš„ä½¿ç”¨é¢‘ç‡è¿˜æ˜¯å¾ˆé«˜çš„ï¼Œä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬å¯èƒ½çŸ¥é“ hashè·¯ç”±å’Œ historyè·¯ç”± çš„åŒºåˆ«å’Œå®ç°åŸç†ã€‚ä½†æ˜¯ä¸€äº›è¿˜æ˜¯ä¸œè¥¿æ˜¯å€¼å¾—ç†è§£çš„ã€‚ å†…ç½®ç»„ä»¶ router-view æ˜¯æ€ä¹ˆå®ç°çš„ è·¯ç”±å®ˆå«æ˜¯æ€ä¹ˆå®ç°çš„...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "8"
    },
    "9": {
        "content": "<h1 id=\"tldr\">TL,DR</h1>\n<p>æœ€è¿‘åŠå¹´å¯¹ä¸¤ä¸ªä¸šåŠ¡ç³»ç»Ÿè¿›è¡Œäº†é‡æ„å‡çº§ï¼Œé‡æ„å‰çš„ä»£ç éƒ½æ˜¯å‡ åƒè¡Œçš„ä¸šåŠ¡é€»è¾‘ã€‚åœ¨åšä¸šåŠ¡è¿­ä»£çš„è¿‡ç¨‹ä¸­è€ƒè™‘åˆ°å¼€å‘çš„éš¾åº¦å’Œåç»­çš„ç»´æŠ¤ï¼Œäºæ˜¯å¯¹å°±æœ‰ç»„ä»¶è¿›è¡Œäº†é‡æ„ã€‚ç»è¿‡é‡æ„å°†å¤§æ–‡ä»¶ç»„ä»¶è¿›è¡Œæ‹†åˆ†ï¼Œæ–¹ä¾¿äº†åç»­çš„æ‰©å±•å’Œç»´æŠ¤ã€‚</p>\n<h1 id=\"ä¸šåŠ¡èƒŒæ™¯\">ä¸šåŠ¡èƒŒæ™¯</h1>\n<p>éƒ¨é—¨è´Ÿè´£çš„ä¸šåŠ¡ä¸­åŒ…å«ä¸€ä¸ªè®¢å•ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå†…éƒ¨åŒ…å«å¤šç§è§’è‰²ï¼Œ10 ä½™ç§è®¢å•çŠ¶æ€ï¼Œçº¦30ç§è®¢å•æ“ä½œã€‚ä¸šåŠ¡çš„å‰ç«¯é¡µé¢ç”±è®¢å•åˆ—è¡¨å’Œè®¢å•è¯¦æƒ…ä¸¤ä¸ªä¸»è¦ç»„ä»¶æ„æˆï¼Œä¸”è®¢å•è¯¦æƒ…é¡µé¢å±•ç¤ºæ—¶è¦†ç›–åœ¨è®¢å•åˆ—è¡¨ä¸Šï¼Œå¹¶æœªä½¿ç”¨ç‹¬ç«‹é¡µé¢ã€‚</p>\n<p>ç”±äºå†å²åŸå› å’Œä¸æ–­çš„è¿­ä»£ï¼Œé€ æˆé¡µé¢ç»„ä»¶çš„ä»£ç è¡Œæ•°å‡ åƒè¡Œï¼Œä¸”è®¢å•è¯¦æƒ…ç»„ä»¶æ‹¥æœ‰å¤šç§è‡ªå®šä¹‰çŠ¶æ€ã€‚</p>\n<p>ç”±äºç‰ˆæœ¬è¿­ä»£ï¼Œé¡µé¢UIéœ€è¦è¿›è¡Œè°ƒæ•´ï¼Œè®¢å•æµç¨‹éœ€è¦ç²¾ç®€ã€‚ç»“åˆå½“å‰çš„ä»£ç çŠ¶å†µï¼Œäºæ˜¯å†³å®šè¿›è¡Œé‡æ„ã€‚</p>\n<h1 id=\"é‡æ„è¿‡ç¨‹\">é‡æ„è¿‡ç¨‹</h1>\n<h2 id=\"1-é’ˆå¯¹è®¢å•æ“ä½œè¿›è¡Œæ‹†åˆ†\">1. é’ˆå¯¹è®¢å•æ“ä½œè¿›è¡Œæ‹†åˆ†</h2>\n<p>å°†æ¯ä¸ªæ“ä½œæŠ½ç¦»æˆå•ç‹¬çš„å°±æ˜¯</p>\n<pre><code class=\"language-js\">function checkValid(){}\nfunction actionHandle(){}\n\nexport default {\n    label: &#39;è®¢å•æ“ä½œ&#39;ï¼Œ \n    style: &#39;&#39;ï¼Œ\n    valid: checkValid,\n    handle: actionHandle,\n}\n</code></pre>\n<p>å°†æ¯ä¸ªæ“ä½œå®šä¹‰æˆå¦‚ä¸Šæ•°æ®ç»“æ„ï¼Œå­˜å…¥æ“ä½œçš„æ•°ç»„ä¸­ã€‚ç„¶ååœ¨åˆ—è¡¨ä¸­ç›´æ¥ä¼ å…¥ å½“å‰è¡Œçš„æ•°æ®ï¼Œæ‰§è¡Œæ¯ä¸ªæ“ä½œçš„validçš„æ–¹æ³•ï¼Œè¿‡æ»¤å‡ºé€‚åˆå½“å‰è¡Œæ•°æ®çš„æ“ä½œã€‚\nå®šä¹‰å¥½ç›¸å…³çš„è®¢å•æ“ä½œåï¼Œåœ¨åˆ—è¡¨ç»„ä»¶ä¸­ ,</p>\n<pre><code class=\"language-js\">\nconst actionList = [...]\n\nexport default {\n    created() {\n        actionList.map(action =&gt; {\n            action.valid = action.valid.bind(this)\n            action.handle = action.handle.bind(this)\n        })\n        this.actionList \n    },\n    methods: {\n        getValidActionList(order) {\n            return this.actionList.filter(action =&gt; action.valid(order))\n        }\n    }\n    \n}\n</code></pre>\n<p>è¿™ä¸€å—çš„é€»è¾‘ä¹Ÿå¯ä»¥å•ç‹¬æ”¾åœ¨ <code>mixin</code> é‡Œé¢ï¼Œä¹‹å‰æœ‰ä¸€ä¸ªä¸šåŠ¡ åˆ—è¡¨æœ‰ä¸¤ç§å±•ç¤ºæ–¹å¼ï¼Œå¡ç‰‡å’Œæ™®é€šåˆ—è¡¨ã€‚åƒè¿™ç§æƒ…å†µæˆ‘ä»¬æŠŠæ“ä½œæŠ½ç¦»å‡ºæ¥ï¼Œæœ€åæ··å…¥åˆ°å¯¹åº”çš„åˆ—è¡¨å’Œå¡ç‰‡ç»„ä»¶ä¸­å³å¯ã€‚</p>\n<p>ä¸Šè¿°çš„æ“ä½œè¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ“ä½œçš„å®é™…ç‚¹å‡»äº‹ä»¶ï¼Œå¾ˆå¤šéƒ½ä¼šåŒ…å«è§†å›¾çš„å˜åŒ–ï¼Œå¼¹ä¸€äº›å¼¹çª—ä¹‹ç±»çš„ã€‚ </p>\n<p>å¦‚æœæŒ‰ç…§æ™®é€šçš„é€»è¾‘ï¼Œå°†å¼¹çª—å®šä¹‰åœ¨ åˆ—è¡¨ç»„ä»¶ä¸­ï¼Œç„¶åå†ç»´æŠ¤å¼¹çª—æ˜¾ç¤ºçš„çŠ¶æ€ï¼Œæ•´ä¸ªåˆ—è¡¨ç»„ä»¶è¿˜æ˜¯è‡ƒè‚¿ï¼Œè€Œä¸”è§†å›¾å’Œé€»è¾‘åˆ†ç¦»ï¼Œä¸åˆ©äºä»£ç çš„é˜…è¯»ã€‚</p>\n<p>è¿™é‡Œæˆ‘ä½¿ç”¨äº† <code>Vue.extend</code>, å°†æ‰€æœ‰çš„å¼¹çª—ç»„ä»¶éƒ½å°è£…æˆå‡½æ•°ï¼Œå°†propsæ—¶é€šè¿‡å‡½æ•°å‚æ•°è¿›è¡Œä¼ å…¥ï¼Œå°†å¼¹çª—å®Œæˆçš„æ“ä½œé€šè¿‡propså®šä¹‰çš„å›è°ƒå‡½æ•°è¿›è¡Œä¼ å‡ºã€‚</p>\n<p>é€šè¿‡è¿™ç§ä»£ç ç»“æ„ï¼Œæˆ‘ä»¬æŠŠæ“ä½œå®Œå…¨æŠ½ç¦»ï¼Œå®ç°äº†ååˆ†åˆç†çš„è§£è€¦</p>\n<h1 id=\"è®¢å•è¯¦æƒ…æ”¹é€ \">è®¢å•è¯¦æƒ…æ”¹é€ </h1>\n<p>ä¹‹å‰ç‰ˆæœ¬çš„è®¢å•è¯¦æƒ…å±•ç¤ºæ—¶æ˜¯è¦†ç›–åœ¨è®¢å•åˆ—è¡¨ä¸Šé¢çš„ï¼Œè¿™å¯¼è‡´åœ¨è¯¦æƒ…æ—¶åˆ·æ–°é¡µé¢æ—¶ä¼šå±•ç¤ºä¸ºè®¢å•åˆ—è¡¨é¡µé¢ï¼Œè¿™ç§å®ç°å’Œä¸šåŠ¡äº¤äº’æ˜¯ä¸å¤ªåˆé€‚çš„ã€‚</p>\n<p>è®¢å•è¯¦æƒ…é¡µé¢ä¹‹å‰åŒ…å« è®¢å•å‘å•ï¼Œ è®¢å•å®¡æ ¸ï¼Œè®¢å•è¯¦æƒ… é€»è¾‘ã€‚ç»„ä»¶çš„è‡ªå®šä¹‰çŠ¶æ€è¿‡å¤šï¼Œè§†å›¾å±•ç¤ºåœ¨ä¸åŒçŠ¶æ€çš„ä¹Ÿæœ‰å·®å¼‚ã€‚å› æ­¤æ•´ä½“è¯¦æƒ…çš„é€»è¾‘è¿˜æ˜¯æ¯”è¾ƒæ··ä¹±çš„ã€‚</p>\n<p>å› æ­¤åœ¨é‡æ„æ—¶ï¼Œæˆ‘å°†å‘å•ï¼Œè¯¦æƒ…ï¼Œå®¡æ ¸çš„é€»è¾‘æŠ½ç¦»ä¸ºå•ç‹¬çš„ç»„ä»¶ï¼Œé€šè¿‡ä¸åŒçš„è·¯ç”±è¿›è¡Œåˆ†å‘ã€‚å¯¹äºè¯•å›¾ç›¸åŒçš„éƒ¨åˆ†æŠ½ç¦»ä¸ºç»„ä»¶ã€‚</p>\n<p>å°†è¿™ä¸ªå¤§ç»„ä»¶æ‹†åˆ†æˆå„ç§é€»è¾‘çš„ç‹¬ç«‹ç»„ä»¶åï¼Œä»£ç å¯è¯»æ€§é«˜äº†å¾ˆå¤šã€‚åœ¨å¹³æ—¶çš„ä¸šåŠ¡å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥æ³¨æ„ä¸šåŠ¡ç»„ä»¶å…¬ç”¨ã€‚åœ¨è§†å›¾çš„é‡åˆæ¯”ä¾‹è¾ƒé«˜ä¸”ä¸šåŠ¡é€»è¾‘è¾ƒä¸ºç®€å•æ—¶ï¼Œå°†ç»„ä»¶è¿›è¡Œå…¬ç”¨æ˜¯OKçš„ï¼Œæ›´å¤šçš„æ—¶å€™æ‹†åˆ†ä¸ºç‹¬ç«‹ç»„ä»¶å¯¹äºåç»­çš„ç»´æŠ¤å’Œè¿­ä»£å¥½å¤„æ›´å¤§</p>\n<h1 id=\"å†™åœ¨æœ€å\">å†™åœ¨æœ€å</h1>\n<p>æœ€åç»ˆç»“ä¸‹å¤§ç»„ä»¶çš„æ‹†åˆ†å§ã€‚</p>\n<ol>\n<li>å¯ä»¥é€šè¿‡ mixin å’Œ Vue.extend å¯¹ä¸šåŠ¡é€»è¾‘è¿›è¡ŒæŠ½ç¦»</li>\n<li>å°†å¤šçŠ¶æ€ç»„ä»¶æŠ½ç¦»ä¸ºå¤šä¸ªå•çŠ¶æ€ç»„ä»¶</li>\n</ol>\n<p>é‡æ„çš„è¿˜æ˜¯æœ‰ä¸€å®šé£é™©çš„ï¼Œé‡æ„è¿‡ç¨‹ä¸­ä¸èƒ½ä¸€è¹´è€Œå°±ã€‚ä¸€éƒ¨åˆ†ä¸€éƒ¨åˆ†çš„è¿›è¡Œé‡æ„ï¼Œå†™å®Œä¹‹ååŠæ—¶æµ‹è¯•ï¼Œä¿è¯ä¸šåŠ¡é€»è¾‘çš„æ­£ç¡®ã€‚å…¨éƒ¨å¼€å‘å®Œæˆåä¹Ÿéœ€è¦è¿›è¡Œå›å½’æµ‹è¯•ã€‚</p>\n<p>ä¸šåŠ¡å¼€å‘æ—¶ï¼Œ<code>å±å±±ä¸Šæ‹‰å±</code> æ˜¯ä¸€ç§å¦¥åã€‚å¦‚æœæ—¶é—´å…è®¸ä¸”å¯¹äºä¸šåŠ¡å’Œè‡ªå·±æœ‰ç›Šå¤„çš„è¯ï¼Œè¿˜æ˜¯æ¨èé‡æ„çš„ã€‚</p>\n",
        "title": "è®¢å•ä¸šåŠ¡é‡æ„ï¼Œè°ˆè°ˆå¤§ç»„ä»¶çš„æ‹†åˆ†",
        "created": "2022-06-14 12:46:40  ",
        "updated": "2022-06-14 12:46:40 ",
        "excerpt": "TL,DR æœ€è¿‘åŠå¹´å¯¹ä¸¤ä¸ªä¸šåŠ¡ç³»ç»Ÿè¿›è¡Œäº†é‡æ„å‡çº§ï¼Œé‡æ„å‰çš„ä»£ç éƒ½æ˜¯å‡ åƒè¡Œçš„ä¸šåŠ¡é€»è¾‘ã€‚åœ¨åšä¸šåŠ¡è¿­ä»£çš„è¿‡ç¨‹ä¸­è€ƒè™‘åˆ°å¼€å‘çš„éš¾åº¦å’Œåç»­çš„ç»´æŠ¤ï¼Œäºæ˜¯å¯¹å°±æœ‰ç»„ä»¶è¿›è¡Œäº†é‡æ„ã€‚ç»è¿‡é‡æ„å°†å¤§æ–‡ä»¶ç»„ä»¶è¿›è¡Œæ‹†åˆ†ï¼Œæ–¹ä¾¿äº†åç»­çš„æ‰©å±•å’Œç»´æŠ¤ã€‚ ä¸šåŠ¡èƒŒæ™¯ éƒ¨é—¨è´Ÿè´£çš„ä¸šåŠ¡...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "9"
    },
    "10": {
        "content": "<h1 id=\"ä¸€ä¸šåŠ¡èƒŒæ™¯\">ä¸€.ä¸šåŠ¡èƒŒæ™¯</h1>\n<p>éƒ¨é—¨è´Ÿè´£çš„ä¸šåŠ¡ä¸»è¦æ˜¯ H5 è¥é”€ç‰©æ–™çš„åˆ¶ä½œï¼Œä¼šæœ‰ç¬¬ä¸‰æ–¹ä½¿ç”¨æˆ‘ä»¬çš„æœåŠ¡åˆ¶ä½œè¥é”€ç‰©æ–™ã€‚ä½œä¸ºè¥é”€äº§å“ï¼Œç¬¬ä¸‰æ–¹å¾€å¾€éœ€è¦ç§æœ‰åŒ–éƒ¨ç½²ï¼Œè‡ªå·±ä¿å­˜ç›¸å…³çš„æ•°æ®ã€‚å½“ç¬¬ä¸‰æ–¹éœ€è¦è¿›è¡Œæ•°æ®é‡‡é›†æˆ–è€…åœ¨æˆ‘ä»¬ç°æœ‰çš„æ¡†æ¶ä¸Šè¿›è¡Œç¬¬äºŒæ¬¡å¼€å‘æ—¶ï¼Œå°±éœ€è¦æˆ‘ä»¬æä¾›ç›¸åº”çš„SDKèƒ½åŠ›ç»™å¯¹æ–¹ã€‚</p>\n<p>æ—§ä»£ç ä¸­æš´éœ²çš„æ–¹å¼æ˜¯é€šè¿‡å…¨å±€çš„å›è°ƒå‡½æ•°ï¼Œä½†æ˜¯éšç€ä¸šåŠ¡çš„å¤æ‚åº¦æå‡ï¼Œæ‰€éœ€è¦çš„å›è°ƒå‡½æ•°ä¹Ÿä¼šè¶Šæ¥è¶Šå¤šã€‚è€Œä¸”å®¢æˆ·æœ‰è¿›è¡ŒäºŒæ¬¡å¼€å‘çš„éœ€æ±‚ï¼Œç®€å•çš„å›è°ƒå‡½æ•°ä¸èƒ½æ»¡è¶³è¯¥éœ€æ±‚ã€‚</p>\n<p>å› æ­¤å†³å®šæ ¹æ®åœ¨ç°æœ‰çš„æ¡†æ¶çš„åŸºç¡€ä¸Šå¼€å‘ä¸€å¥—SDKï¼Œæš´éœ²è‡ªèº«çš„ä¸šåŠ¡èƒ½åŠ›å’Œæ•°æ®ç»™ç¬¬ä¸‰æ–¹ã€‚</p>\n<h1 id=\"äºŒ-è®¾è®¡åŸåˆ™\">äºŒ. è®¾è®¡åŸåˆ™</h1>\n<p>åœ¨è¿›è¡ŒSDKè®¾è®¡æ—¶ï¼Œæˆ‘çš„è®¾è®¡åŸåˆ™æ˜¯ï¼š</p>\n<ol>\n<li>å¯¹ç°æœ‰ä¸šåŠ¡ä»£ç ä¾µèš€å°ï¼Œä¸æ±¡æŸ“ä¸šåŠ¡é€»è¾‘</li>\n<li>æ¥å£æ˜“æ‡‚ï¼Œæ–¹ä¾¿è°ƒç”¨</li>\n<li>ä¸å½±å“å½“å‰ä¸šåŠ¡</li>\n<li>æ‰©å±•æ€§å¼º</li>\n</ol>\n<h1 id=\"ä¸‰å®æ“è¿‡ç¨‹\">ä¸‰.å®æ“è¿‡ç¨‹</h1>\n<h2 id=\"31-å‘å¸ƒè®¢é˜…\">3.1 å‘å¸ƒè®¢é˜…</h2>\n<p>é¦–å…ˆæ˜¯äº‹ä»¶åˆ†å‘ï¼Œè¿™é‡Œæˆ‘é‡‡ç”¨äº† <code>å‘å¸ƒè®¢é˜…</code> çš„è®¾è®¡æ¨¡å¼ã€‚å½“ä¸šåŠ¡é€»è¾‘æ‰§è¡Œæ—¶ï¼Œä¸»åŠ¨åˆ†å‘ç›¸å…³äº‹ä»¶ï¼Œæä¾›ç»™è®¢é˜…è€…ä½¿ç”¨ã€‚</p>\n<pre><code class=\"language-js\">class EventEmitter {\n    listener= {}\n    $on(eventName, handler) {\n        !this.listener[eventName] &amp;&amp; (this.listener[eventName] = [])\n        this.listener[eventName].push(handler)\n    }\n    $emit(eventName, data) {\n        if (listener[eventName]) {\n            this.listener[eventName].forEach(handler =&gt; {\n                handler(data)\n            })\n        }\n    }\n}\n</code></pre>\n<p>ä¸Šé¢å°±æ˜¯ä¸€ä¸ªç®€å•çš„ å‘å¸ƒè®¢é˜… è®¾è®¡æ¨¡å¼ï¼Œåœ¨æ­¤åŸºç¡€å¯ä»¥è¿›è¡ŒåŠŸèƒ½çš„ä¸°å¯Œã€‚ä¾‹å¦‚ç›´æ¥è¿›è¡Œå…¨éƒ¨äº‹ä»¶çš„çš„è®¢é˜…ï¼Œå–æ¶ˆè®¢é˜…ç­‰é€»è¾‘ã€‚</p>\n<h2 id=\"32-é˜»æ­¢é»˜è®¤äº‹ä»¶\">3.2 é˜»æ­¢é»˜è®¤äº‹ä»¶</h2>\n<p>å¯¹äºä¸šåŠ¡ç³»ç»Ÿçš„äº‹ä»¶ï¼Œåœ¨äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå¯ä»¥æä¾›ç»™ç”¨æˆ·é˜»æ­¢é»˜è®¤äº‹ä»¶å‘ç”Ÿçš„èƒ½åŠ›ï¼Œæ–¹ä¾¿ç”¨æˆ·è¿›è¡Œè‡ªå®šä¹‰æ“ä½œã€‚äºæ˜¯æˆ‘æ¨¡ä»¿äº† <code>DOM</code> çš„ <code>EventListener</code> çš„æ¨¡å¼ï¼Œåœ¨æ‰§è¡Œä¸€äº›äº‹ä»¶å‰æä¾›é˜»æ­¢äº‹ä»¶çš„èƒ½åŠ›ã€‚</p>\n<p>ç”¨æˆ·åœ¨ä½¿ç”¨æ—¶ï¼Œå¯ä»¥è¿™ä¹ˆè¿›è¡Œè°ƒç”¨</p>\n<pre><code class=\"language-js\">sdk.$on(&#39;before:&lt;EventName&gt;&#39;, (e) =&gt; {\n    e.preventDefault()\n})\n</code></pre>\n<p>åœ¨è¿›è¡Œäº‹ä»¶è®¾è®¡æ—¶ï¼Œä¸€èˆ¬çš„ä¸šåŠ¡éƒ½ä¼šåˆ†å‘ä¸¤ä¸ªäº‹ä»¶ <code>before:&lt;EventName&gt;</code> å’Œ <code>after:&lt;EventName&gt;</code>.</p>\n<p>é‚£åœ¨å…·ä½“ä»£ç ä¸­æ˜¯æ€ä¹ˆå®ç°è¿™ä¸ªé€»è¾‘çš„å‘¢ï¼Ÿ</p>\n<p>æˆ‘æ˜¯è¿™ä¹ˆå®ç°çš„, å…ˆå®šä¹‰äº‹ä»¶å“åº”ç»“æœçš„ç±»</p>\n<pre><code class=\"language-js\">\nclass EventResponse {\n    data = {}\n    constructor(data, eventName, eventHandler) {\n        this.data = data\n        this.type = eventName\n        this.preventDefault = () =&gt; eventHandler.isPrevent = true\n    }\n}\n</code></pre>\n<p>ç„¶ååœ¨ <code>EventEmitter</code> ä¸­ï¼Œå°† å“åº”çš„å®ä¾‹ä¼ é€’ç»™æ¯ä¸ªè®¢é˜…è€…</p>\n<pre><code class=\"language-js\">...\n$emit(eventName, data) {\n    let eventHandler = {\n        isPrevent: false,\n    }\n    const eventResponse = new EventResponse(data, eventName, eventHandler)\n    \n    if (listener[eventName]) {\n            this.listener[eventName].forEach(handler =&gt; {\n                handler(eventResponse)\n            })\n    }\n    return eventHandler.isPrevent\n}\n...\n</code></pre>\n<p>å¦‚æœæœ‰è®¢é˜…è€…è°ƒç”¨ <code>preventDefault</code> æ–¹æ³•ï¼Œåˆ™ä¼šè®© <code>isPevent</code> ä¸º <code>false</code>ã€‚ç„¶åä¸šåŠ¡ä»£ç æ ¹æ®è¿”å›çš„å€¼å†³å®šæ˜¯å¦ç»§ç»­ä¸šåŠ¡é€»è¾‘ï¼Œå½“ç„¶æ­¤å¤„åªæ”¯æŒåŒæ­¥çš„é˜»æ­¢ï¼Œå¼‚æ­¥é˜»æ­¢å¹¶æ— å®é™…çš„ä¸šåŠ¡æ„ä¹‰ã€‚</p>\n<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹ä¸šåŠ¡ä»£ç å¦‚ä½•è¿›è¡Œäº‹ä»¶åˆ†å‘</p>\n<h2 id=\"33-äº‹ä»¶ä»£ç†\">3.3 äº‹ä»¶ä»£ç†</h2>\n<p>æŸ¥çœ‹äº†æ—§çš„ä¸šåŠ¡ä»£ç ï¼Œä¸šåŠ¡ç›¸å…³çš„åŠŸèƒ½å‡½æ•°ä¸­å……æ–¥ç€å„ç§å›è°ƒï¼ŒåŸ‹ç‚¹çš„é€»è¾‘ï¼Œå®é™…çš„åŠŸèƒ½é€»è¾‘è¢«å¤§å¹…åº¦æ±¡æŸ“ã€‚</p>\n<p>å› æ­¤æˆ‘å†³å®šä¸åœ¨ç°æœ‰å‡½æ•°ä¸­è¿›è¡Œäº‹ä»¶çš„åˆ†å‘ï¼Œè€Œæ˜¯åˆ©ç”¨ å‡½æ•°ä»£ç†ï¼Œå®ç°äº‹ä»¶çš„åˆ†å‘ã€‚</p>\n<p>å‡½æ•°ä»£ç†å¾ˆç®€å•ï¼Œå°±æ˜¯å°†åŸå‡½æ•°è¿›è¡ŒåŒ…è£¹ï¼Œæ··å…¥ä¸€äº›å…¶ä»–é€»è¾‘ã€‚</p>\n<pre><code class=\"language-js\">function registProxy(orgin, methodName) {\n    const originMethod = origin[methodName]\n    origin[methodName] = function () {\n        // å…¶ä»–æ··å…¥é€»è¾‘\n        originMethod.apply(this, arguments)\n    }\n}\n</code></pre>\n<p>è¿™é‡Œæˆ‘ä¸»è¦æ˜¯æ··å…¥ä¸€äº› hook, ç„¶åå’Œä¹‹å‰çš„äº‹ä»¶åˆ†å‘ç»“åˆèµ·æ¥ ,äºæ˜¯æˆ‘çš„ä»£ç æ˜¯è¿™æ ·çš„</p>\n<pre><code class=\"language-js\">function registProxy({\n    origin,\n    methodName,\n    beforeHook,\n    afterHook,\n\n}) {\n    const originMethod = origin[methodName]\n    orgin[methodName] = function (...args) {\n        const isPrevent = beforeHook(...args)\n        if (isPrevent) return\n        originMethod(...args)\n        afterHook &amp;&amp; afterHook(...args)\n    }\n}\n\nfunction registSyncHook(origin, methodName, eventCode) {\n    registProxy({\n        origin,\n        methodName,\n        beforeHook(...args) {\n            return sdk.$emit(&#39;before:&#39; + eventCode, args)\n        },\n        afterHook: (...args) =&gt; {\n        return iw_emitter.$emit(&#39;after:&#39; + eventCode, args)\n\n        },\n    })\n}\n</code></pre>\n<p>è¿™é‡Œé€šè¿‡æ³¨å…¥å‰å <code>hook</code> å®ç°äº†åŸæœ‰å‡½æ•°çš„ä»£ç†, ä½¿ç”¨ <code>eventCode</code> å’Œ è¢«ä»£ç†çš„å‡½æ•°ï¼Œ å®ç°äº† äº‹ä»¶çš„åˆ†å‘å’Œé»˜è®¤äº‹ä»¶çš„é˜»æ­¢ã€‚</p>\n<p>åˆ°äº†ç›®å‰è¿™ä¸€æ­¥ï¼Œå…¶å®å·²ç»èƒ½å¤Ÿæ»¡è¶³åŸºæœ¬çš„éœ€æ±‚äº†ï¼Œä½†æ˜¯å®é™…ä¸šåŠ¡ä¸­åŒ…å«å¾ˆå¤šå¼‚æ­¥çš„é€»è¾‘ï¼Œé€šè¿‡å›è°ƒå‡½æ•°å®ç°å‡½æ•°çš„ç»“æŸï¼Œè¿™ç§æƒ…å†µ <code>afterHook</code> å°±æ— æ³•æ­£å¸¸èµ·ä½œç”¨äº†ã€‚</p>\n<p>å…¶å®å¯¹å¼‚æ­¥çš„å¤„ç†ä¹Ÿå¾ˆç®€å•ï¼Œå¯¹äºæ‹¥æœ‰å›è°ƒå‡½æ•°çš„çš„å‡½æ•°æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆè¿›è¡Œå¤„ç†</p>\n<pre><code class=\"language-diff\"> function registProxy({\n     orgin,\n    methodName,\n    beforeHook,\n    afterHook,\n+      isAsync\n }) {\n     ...\n    // åœ¨beforeHookæ”¹å˜å‚æ•°ä¸­çš„å›è°ƒå‡½æ•°ï¼Œ\n+\tlet curArgs = args\n+\tconst emitResponse = beforeHook(...args)\n+\tif (emitResponse.isPrevent) return\n-      const isPrevent = beforeHook(...args)\n-      if (isPrevent) return \n+\tif (emitResponse.args) {\n+\t\tcurArgs = emitResponse.args\n+\t}\n+\torginMethod(...curArgs)\n+   if (isAsync) return\n    ...\n}\n\nfunction registAsyncHook(origin, method, eventCode, injectArgsFunc) {\n    registProxy({\n        ...\n        beforeHook: (...args) =&gt; {\n            // injectArgsFunc å‡½æ•°æ›´æ”¹è¢«ä»£ç†å‡½æ•°çš„ å›è°ƒå‡½æ•°\n            // åœ¨å›è°ƒå‡½æ•°ä¸­æ”¾å…¥ afterhook çš„é€»è¾‘\n            const newArgs = injectArgsFunc(args)\n            const isPrevent = iw_emitter.$emit(&#39;before:&#39; + eventCode, args)\n            // è¿”å›æ–°çš„å‚æ•°å’Œæ˜¯å¦é˜»æ­¢çš„å­—æ®µ\n            return {\n                isPrevent,\n                args: newArgs,\n            }\n        },\n        isAsync: true\n    })\n\n}\n</code></pre>\n<p>é€šè¿‡å¯¹è¢«ä»£ç†å‡½æ•° å›è°ƒå‡½æ•°å‚æ•°çš„å¤„ç†ï¼Œæˆ‘ä»¬å®ç°äº† <code>afterHook</code> å¯¹å¼‚æ­¥å‡½æ•°çš„å…¼å®¹ã€‚</p>\n<p>è¿™æ˜¯å®é™…ä½¿ç”¨çš„ä¾‹å­</p>\n<pre><code class=\"language-js\">const injectTestArgsFunc = eventCode =&gt; (args) =&gt; {\n    const {\n        2: callback\n        } = args\n    const newCallback = () =&gt; {\n        sdk.$emit(`after:${eventCode}`, args)\n        callback &amp;&amp; callback()\n    }\n    const newArgs = [...args]\n    newArgs.splice(2, 1, newCallback)\n    return newArgs\n}\n\n\nregistAsyncHook(window, &#39;test&#39;, &#39;test:new&#39;, injectTestArgsFunc(&#39;test:new&#39;))\n</code></pre>\n<p>å¯¹äºæ”¯æŒ <code>promise</code> çš„å¤„ç†å°±ç›¸å¯¹ç®€å•äº†ï¼Œè¿™é‡Œå°±ä¸è¿›è¡Œè®¨è®ºäº†ã€‚</p>\n<h2 id=\"34-æ€»ä½“å¤„ç†\">3.4 æ€»ä½“å¤„ç†</h2>\n<p>å½“æˆ‘ä»¬å°†ä¸Šé¢çš„å·¥å…·å‡½æ•°å†™å¥½ä¹‹åï¼Œå°±å¯ä»¥å¯¹æ¡†æ¶ä¸­éœ€è¦è¿›è¡Œæš´éœ²çš„ä¸šåŠ¡å‡½æ•°è¿›è¡Œä»£ç†ï¼Œæ³¨å…¥ç›¸å…³ <code>hook</code>,\nå¹¶å°†ç›¸å…³çš„ <code>eventCode</code> æ•´ç†æˆæ–‡æ¡£ï¼Œæä¾›ç»™ç¬¬ä¸‰æ–¹è¿›è¡Œä½¿ç”¨ã€‚å¯¹äºå‡½æ•°çš„ä»£ç†ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªå‡½æ•°è¿›è¡Œå¤„ç†ï¼Œåœ¨ <code>SDK</code> åˆå§‹åŒ–æ—¶æ‰è¿›è¡Œä»£ç†ã€‚è¿™æ ·å¤„ç†çš„å¥½å¤„åœ¨äºå¦‚æœä¸ä½¿ç”¨ <code>SDK</code>ï¼Œå¯¹ç°æœ‰çš„ä¸šåŠ¡é€»è¾‘æ²¡æœ‰ä¸€ç‚¹å½±å“ï¼Œè€Œä¸”ä¹Ÿä¸å½±å“åœ¨çº¿çš„ <code>debug</code>ã€‚</p>\n<pre><code class=\"language-js\">function initRegistProxy() {\n    registAsyncHook(...)\n    registSyncHook(...)\n    ...\n}\n    \nclass EventEmitter {\n    ...\n    \n    init() {\n        initRegistProxy()\n    }\n    ...\n}\n    \nconst sdk = new EventEmitter()\n\n// ç”¨æˆ·ä½¿ç”¨æ—¶\nsdk.init()\nsdk.$on(&#39;before:&lt;EventCode&gt;&#39;,()=&gt;{})\n</code></pre>\n<h2 id=\"35-ç”¨æˆ·ä¸»åŠ¨è§¦å‘äº‹ä»¶\">3.5 ç”¨æˆ·ä¸»åŠ¨è§¦å‘äº‹ä»¶</h2>\n<p>è¿™ä¸ªé€»è¾‘ä¹Ÿå¥½å¤„ç†ï¼Œå°±æ˜¯ å‘å¸ƒè€… å’Œ è®¢é˜…è€… çš„èº«ä»½å¯¹æ¢å³å¯ã€‚ ä¸šåŠ¡äº‹ä»¶å‡½æ•°è®¢é˜…ç›¸å…³çš„ <code>event</code>, ç”¨æˆ·å¯ä»¥ä½¿ç”¨ <code>SDK</code> è¿›è¡Œ<code>sdk.$emit(&#39;&lt;eventCode&gt;&#39;)</code>å‘å¸ƒäº‹ä»¶å³å¯ã€‚</p>\n<h1 id=\"å››-å†™åœ¨æœ€å\">å››. å†™åœ¨æœ€å</h1>\n<p>ç»è¿‡è¿™æ¬¡ <code>SDK</code> å¼€å‘ï¼ŒåŠ æ·±äº†æˆ‘å¯¹è®¾è®¡æ¨¡å¼çš„ç†è§£ï¼Œå¥½çš„è®¾è®¡æ¨¡å¼å¯¹äºä»£ç çš„è§£è€¦éå¸¸æœ‰å¸®åŠ©ã€‚</p>\n<p>åŒæ—¶æˆ‘ä¹Ÿå­¦ä¼šäº†é€šè¿‡ å‡½æ•°ä»£ç† æ¥å¯¹å‡½æ•°è¿›è¡Œæ‰©å±•ï¼Œé¿å…å¯¹å‡½æ•°å†…éƒ¨çš„ä¸šåŠ¡é€»è¾‘äº§ç”Ÿå½±å“ã€‚</p>\n<p>å½“ç„¶ <code>SDK</code> çš„å¼€å‘æœ€é‡è¦çš„è¿˜æ˜¯æ–‡æ¡£ï¼Œå¥½çš„æ–‡æ¡£æè¿°å¯ä»¥è®©å¼€å‘è€…å¿«é€Ÿæ¥å…¥ <code>SDK</code>. å¯¹äºåŒæ–¹çš„å¯¹æ¥æ•ˆç‡æœ‰å¾ˆå¤§çš„æå‡ã€‚</p>\n",
        "title": "æä¾›ä¸šåŠ¡èƒ½åŠ›ï¼ŒSDKçš„å¼€å‘",
        "created": "2022-06-15 16:08:51  ",
        "updated": "2022-06-15 16:08:51 ",
        "excerpt": "ä¸€.ä¸šåŠ¡èƒŒæ™¯ éƒ¨é—¨è´Ÿè´£çš„ä¸šåŠ¡ä¸»è¦æ˜¯ H5 è¥é”€ç‰©æ–™çš„åˆ¶ä½œï¼Œä¼šæœ‰ç¬¬ä¸‰æ–¹ä½¿ç”¨æˆ‘ä»¬çš„æœåŠ¡åˆ¶ä½œè¥é”€ç‰©æ–™ã€‚ä½œä¸ºè¥é”€äº§å“ï¼Œç¬¬ä¸‰æ–¹å¾€å¾€éœ€è¦ç§æœ‰åŒ–éƒ¨ç½²ï¼Œè‡ªå·±ä¿å­˜ç›¸å…³çš„æ•°æ®ã€‚å½“ç¬¬ä¸‰æ–¹éœ€è¦è¿›è¡Œæ•°æ®é‡‡é›†æˆ–è€…åœ¨æˆ‘ä»¬ç°æœ‰çš„æ¡†æ¶ä¸Šè¿›è¡Œç¬¬äºŒæ¬¡å¼€å‘æ—¶ï¼Œå°±éœ€è¦æˆ‘ä»¬æä¾›ç›¸åº”çš„...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "10"
    },
    "11": {
        "content": "<h1 id=\"ä¸€-ä¸šåŠ¡èƒŒæ™¯\">ä¸€. ä¸šåŠ¡èƒŒæ™¯</h1>\n<p>æ—¥å¸¸çš„å·¥ä½œæœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†éƒ½æ˜¯ç¼–è¾‘å™¨çš„å¼€å‘ã€‚ç”±äºä¸šåŠ¡éœ€æ±‚ï¼Œä»Šå¹´æ¨åŠ¨äº†å…¨æ™¯ç¼–è¾‘å™¨2.0çš„é‡æ„ã€‚æœ¬æ–‡ä¼šä¸»è¦è®²è¿°æ­¤æ¬¡é‡æ„çš„å…¨éƒ¨ç»†èŠ‚ã€‚</p>\n<p>ä½œä¸ºä¸€æ¬¾ç¼–è¾‘å™¨ï¼Œè€ç‰ˆå…¨æ™¯ç¼–è¾‘å™¨çš„åŠŸèƒ½å­˜åœ¨å¾ˆå¤šé—®é¢˜ã€‚</p>\n<ol>\n<li>æ•°æ®å®æ—¶å˜åŒ–ï¼Œç”¨æˆ·æ“ä½œåç«‹å³ä¿å­˜ã€‚ä¸èƒ½è¿›è¡Œæ’¤é”€ï¼Œä¹Ÿæ— å†å²è®°å½•åŠŸèƒ½</li>\n<li>å‰åç«¯è€¦åˆä¸¥é‡ï¼Œæ–°åŠŸèƒ½å¼€å‘éœ€è¦ä¾èµ–å‰åç«¯å…±åŒåä½œ</li>\n<li>ç”¨æˆ·ä½¿ç”¨ä½“éªŒä¸å¥½ï¼Œæ“ä½œåæ•°æ®æµè½¬å’Œæ¥å£è¯·æ±‚é€»è¾‘æ··ä¹±ï¼Œæœ‰æ˜æ˜¾çš„å¡é¡¿</li>\n<li>ä¸šåŠ¡æ‰“åŒ…å†å²åŒ…è¢±é‡ï¼Œå„ç§å¤§ç»„ä»¶å’Œäº‹ä»¶ä¼ é€’ï¼Œç»´æŠ¤æˆæœ¬é«˜</li>\n</ol>\n<p>å½“å‰çš„ä¸šåŠ¡æ¶æ„ä¸åœ¨æ»¡è¶³åç»­ä¸šåŠ¡çš„å¼€å‘ï¼Œäºæ˜¯æˆ‘å†³å®šé‡æ„ã€‚</p>\n<h1 id=\"äºŒ-é‡æ„ç›®æ ‡\">äºŒ. é‡æ„ç›®æ ‡</h1>\n<p>ä½œä¸ºç¼–è¾‘å™¨çš„ä¸»ç¨‹ï¼Œäº§å“åœ¨è§„åˆ’2.0ç‰ˆçš„æ–°åŠŸèƒ½æ—¶ï¼Œæˆ‘åŸºäºå½“å‰ä¸šåŠ¡ç°çŠ¶å’Œä¸»ç®¡æå‡ºäº†é‡æ„çš„æƒ³æ³•ã€‚é€šè¿‡é‡æ„åï¼Œä¸»è¦èƒ½å¤Ÿå®ç°çš„ç›®æ ‡æœ‰ï¼š</p>\n<ol>\n<li>æ»¡è¶³2.0çš„äº§å“éœ€æ±‚ï¼Œä¸è¿›è¡Œå®æ—¶ä¿å­˜ï¼Œåœ¨å‰ç«¯å­˜å‚¨æ•°æ®ï¼Œç”±ç”¨æˆ·å†³å®šæ•°æ®çš„ä¿å­˜</li>\n<li>å‡å°‘å‰åç«¯è€¦åˆï¼Œå‡å°‘æ¥å£è¯·æ±‚ã€‚åç»­æ–°åŠŸèƒ½å¯ä»¥å®Œå…¨æœ‰å‰ç«¯è¿›è¡Œå¼€å‘ã€‚</li>\n<li>æ€§èƒ½ä¼˜åŒ–ï¼Œæé«˜ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒ</li>\n<li>å…¨æ™¯é€»è¾‘å’ŒUIæ¡†æ¶é€»è¾‘æŠ½ç¦»ï¼Œè®©å…¨æ™¯ç¼–è¾‘çš„é€»è¾‘å®Œå…¨ç‹¬ç«‹ï¼Œå³æ—¶ä½¿ç”¨å…¶ä»–UIæ¡†æ¶ä¹Ÿèƒ½å¿«é€Ÿå®ç°ç¼–è¾‘å™¨</li>\n</ol>\n<h1 id=\"ä¸‰-å…·ä½“å®æ“\">ä¸‰. å…·ä½“å®æ“</h1>\n<h2 id=\"31-æ•°æ®å»ºæ¨¡\">3.1 æ•°æ®å»ºæ¨¡</h2>\n<p>é¦–å…ˆæ˜¯æ•°æ®ï¼Œå’ŒH5ç¼–è¾‘å™¨ä¸åŒï¼Œè€ç‰ˆæœ¬çš„å…¨æ™¯ç¼–è¾‘å™¨åœ¨å‰ç«¯å­˜å‚¨çš„æ•°æ®æ˜¯å¾ˆé›¶æ•£çš„ã€‚å®Œå…¨é€šè¿‡ <code>krapno</code> è¯»å–å…¨æ™¯çš„æ•°æ®ã€‚åœ¨æ•°æ®æ›´æ”¹æ—¶ç›´æ¥æäº¤åç«¯ï¼Œæ›´æ”¹é…ç½® <code>XML</code> æ–‡ä»¶ï¼Œå‰åç«¯è€¦åˆéå¸¸ä¸¥é‡ã€‚</p>\n<p>å› æ­¤æ•°æ®æ–¹é¢æˆ‘å®Œå…¨æ”¾å¼ƒä» <code>krpano</code> å®ä¾‹ä¸­è¯»å–æ•°æ®ï¼Œè€Œæ˜¯åœ¨è¿›å…¥ç¼–è¾‘å™¨æ—¶è·å–è¯¥ç‰©æ–™çš„ XMLé…ç½®æ–‡ä»¶ï¼Œç„¶åå°† <code>XML</code> è½¬åŒ–ä¸º <code>DOM</code>ï¼Œä» <code>DOM</code> ä¸­è·å–æ•°æ®æ„å»ºæ•´ä¸ªå…¨æ™¯çš„ <code>JSON</code> æ ‘ï¼Œåç»­çš„ç¼–è¾‘å™¨æ“ä½œéƒ½åŸºäº <code>JSON</code> æ“ä½œã€‚</p>\n<p>ä» <code>XML</code> åˆ° <code>JSON</code> çš„è½¬åŒ–è¿‡ç¨‹ä¸­ï¼Œæˆ‘å¯¹å…¨æ™¯ä¸­æ‰€æœ‰çš„ç»„ä»¶éƒ½è¿›è¡Œæ•°æ®å»ºæ¨¡ã€‚åŒ…æ‹¬ çƒ­ç‚¹ï¼Œå›¾å±‚ï¼Œæ ‡å°ºç­‰ï¼Œå£°æ˜çš„ç±»å¤§çº¦ 20ä½™ç§ã€‚æ¯ä¸ªç±»éƒ½æä¾›è§£æ <code>XML</code> è·å– <code>JSON</code> çš„æ–¹æ³•ï¼Œæœ€ç»ˆå¯¹æ•´ä¸ª <code>XML</code> è¿›è¡Œæ“ä½œï¼Œå°±è·å–åˆ°æ‰€æœ‰çš„ç»„ä»¶æ•°æ®äº†ã€‚</p>\n<pre><code class=\"language-js\">class Hotspot {\n    static parseDOM(DOM) {\n        ...\n        return {...}\n    }\n}\n</code></pre>\n<p>å¯¹æ•°æ®å»ºæ¨¡çš„å¥½å¤„,  ä¸æ­¢åœ¨äºè§£ææ•°æ®ã€‚ä¸Šé¢æˆ‘ä¹Ÿæåˆ°ï¼Œæˆ‘å¸Œæœ›å°†å…¨æ™¯ç¼–è¾‘çš„é€»è¾‘å’ŒUIé€»è¾‘æŠ½ç¦»ï¼Œè€Œé€šè¿‡ç±»æ¥å¯¹ç›¸å…³çš„ç»„ä»¶è¿›è¡Œæ•°æ®å’Œé€»è¾‘çš„å°è£…å°±éå¸¸å¥½ç”¨ã€‚æˆ‘å°† <code>krpano</code> ç›¸å…³çš„æ“ä½œå…¨éƒ¨å°è£…åˆ°å¯¹åº”çš„ç±»ä¸­ï¼Œæ“ä½œæ•°æ®æ—¶ï¼Œç›´æ¥è°ƒç”¨ç›¸å…³çš„ç±»å’Œå®ä¾‹çš„æ–¹æ³•å³å¯</p>\n<pre><code class=\"language-js\">class Hotspot {\n    add() {}\n    remvoe() {}\n    update(...) {}\n}\n</code></pre>\n<p>è¿™æ ·å°±ä¸ç”¨åœ¨ <code>Vue</code> ä»£ç ä¸­å†™ <code>krpano</code> çš„ç›¸å…³é€»è¾‘äº†ï¼Œç•Œé¢è¡¨å•åœ¨æ›´æ–° <code>JSON</code> æ•°æ®æ—¶ï¼Œä½¿ç”¨å°è£…å¥½çš„ç±»åŒæ­¥é¢„è§ˆçš„è§†å›¾å³å¯ã€‚</p>\n<h2 id=\"32-ç»„ä»¶æ‹†åˆ†\">3.2 ç»„ä»¶æ‹†åˆ†</h2>\n<p>æ—§ä»£ç ä¸­åŒ…å«å¾ˆå¤šçš„å¤§ç»„ä»¶ï¼Œä¾‹å¦‚çƒ­ç‚¹ç»„ä»¶ï¼Œçƒ­ç‚¹çš„ç±»å‹æœ‰7ç§ï¼Œæ¯ç§çƒ­ç‚¹çš„å±æ€§å„æœ‰å¼‚åŒã€‚è€ç»„ä»¶ä¸­ç›´æ¥åŒ…å«æ‰€æœ‰çƒ­ç‚¹çš„é…ç½®ï¼Œå„ç§çŠ¶æ€åˆ¤æ–­ï¼Œååˆ†æ··ä¹±ã€‚</p>\n<p>è¿™é‡Œçš„é‡æ„é€»è¾‘å¾ˆç®€å•ï¼Œæ‹†åˆ†ç»„ä»¶ï¼Œæ¯ç§ç±»å‹çƒ­ç‚¹å¯¹åº”ç›¸å…³çš„å±æ€§ç»„ä»¶ï¼Œç¼–è¾‘æ—¶é€šè¿‡æ•°æ®ç±»å‹æ ‡è¯†è¯†åˆ«å¯¹åº”ç»„ä»¶ç„¶åç”¨åŠ¨æ€ç»„ä»¶è¿›è¡Œå±•ç¤ºã€‚</p>\n<p>å¯¹äºå…¶ä»–çš„å¤§ç»„ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿé‡‡ç”¨ä¸€æ ·çš„æ–¹æ³•è¿›è¡ŒæŠ½ç¦»ï¼Œä¿è¯ç»„ä»¶çš„é¢—ç²’åº¦ï¼Œä¿è¯ç»„ä»¶çš„ä¸šåŠ¡å¤æ‚åº¦ä¸èƒ½è¿‡é«˜ã€‚</p>\n<h2 id=\"33-åˆ‡å›¾å¤„ç†\">3.3 åˆ‡å›¾å¤„ç†</h2>\n<p>ç”¨æˆ·ä¸Šä¼ çš„å…¨æ™¯å›¾æ˜¯ä¸€å¼ 2ï¼š1çš„å›¾ç‰‡ï¼Œæ— æ³•ç›´æ¥è¢«å…¨æ™¯ä½¿ç”¨ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>krpano</code> å®˜æ–¹æä¾›çš„åˆ‡å›¾å·¥å…·åœ¨æœåŠ¡å™¨è¿›è¡Œåˆ‡å›¾ï¼Œç„¶åæ”¾åˆ°å¯¹åº”çš„ç‰©æ–™æ–‡ä»¶å¤¹ä¸­ã€‚</p>\n<p>é‡æ„æ—¶æœ‰è€ƒè™‘å‰ç«¯åˆ‡å›¾ï¼Œæ™®é€šåˆ‡å›¾å°†å…¨æ™¯å›¾åˆ†å‰²ä¸º6å¼ å›¾ç‰‡æ˜¯å¯ä»¥å®ç°çš„ï¼Œä½†æ˜¯ä¸šåŠ¡åœºæ™¯æ›´å¤šçš„éœ€è¦çš„æ˜¯é«˜æ¸…åˆ‡å›¾ï¼Œç”±äºç®—æ³•é—®é¢˜ï¼Œæœ€ç»ˆè¿˜æ˜¯æ”¾å¼ƒäº†è¿™ä¸ªå°ä¼˜åŒ–ã€‚</p>\n<p>è€ç‰ˆæœ¬åˆ‡å›¾å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ç”¨æˆ·åœ¨è¿›è¡Œåˆ‡å›¾æ—¶ï¼Œå¯¹æœåŠ¡å™¨çš„å‹åŠ›ç‰¹åˆ«å¤§ï¼Œåç«¯åœ¨é˜Ÿåˆ—ç®¡ç†ä¸Šä¹Ÿå¤„ç†çš„ä¸å¥½ï¼Œæ²¡æœ‰è¿›è¡Œå¼‚æ­¥å¤„ç†ã€‚è¿™å°±å¯¼è‡´å¤šç”¨æˆ·å¤šå›¾ä¸Šä¼ æ—¶ï¼Œç­‰å¾…çš„æ—¶é—´å¯èƒ½ä¼šç‰¹åˆ«ä¹…ï¼Œå¦‚æœæ¥å£è¶…æ—¶å¤±è´¥ï¼Œå‰ç«¯ä¹Ÿæœªè¿›è¡Œç›¸å…³å¤„ç†ã€‚10å¼ åˆ‡å›¾ï¼Œæœ‰ä¸€å¼ å¤±è´¥äº†éƒ½ä¼šé€ æˆæ•´ä½“æ“ä½œå¤±è´¥ï¼Œç”¨æˆ·ä½“éªŒååˆ†ç³Ÿç³•ã€‚</p>\n<p>æˆ‘è¿™è¾¹çš„å¤„ç†ä¹Ÿå¾ˆç®€å•ï¼Œåˆ‡å›¾æ—¶ä¸ä½¿ç”¨é®ç½©é˜»æ­¢ç”¨æˆ·æ“ä½œã€‚å°†æ¯ä¸ªåˆ‡å›¾éƒ½å˜æˆä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡æœ‰å„è‡ªçš„è¿›åº¦æ¡ï¼Œä»»åŠ¡ä¹‹é—´äº’ä¸å½±å“ã€‚è¿™æ ·ç”¨æˆ·åœ¨ç¼–è¾‘ç‰©æ–™æ—¶ä¹Ÿèƒ½è¿›è¡Œä¸Šä¼ çš„æ“ä½œï¼Œç”¨æˆ·ä½¿ç”¨ä½“éªŒå¤§å¹…æé«˜ã€‚</p>\n<p>åŒæ—¶ä¸ºäº†ç¼“è§£æœåŠ¡å™¨å‹åŠ›ï¼Œå‰ç«¯å°è£…äº†ä¸€ä¸ª ä»»åŠ¡è°ƒåº¦å™¨ <code>scheduler</code>, ç”¨æˆ·ä»»åŠ¡æœ€å¤šå¹¶è¡Œä¸¤ä¸ªã€‚ å½“ç„¶è¿™ä¸ªå¤„ç†çš„æ”¶ç›Šè¿˜æ˜¯æ¯”è¾ƒå°çš„ï¼Œä¹Ÿä¸èƒ½çœŸæ­£è§£å†³é—®é¢˜ï¼Œè¿˜æ˜¯éœ€è¦åç«¯è¿›è¡Œä¼˜åŒ–ã€‚</p>\n<h2 id=\"34-æœ€ç»ˆä¿å­˜\">3.4 æœ€ç»ˆä¿å­˜</h2>\n<p>é‡æ„ä¸€å¼€å§‹çš„ç›®çš„å°±æ˜¯ä¸ºäº†æœ€ç»ˆä¿å­˜ï¼Œç”¨æˆ·æ‹¥æœ‰æ•°æ®ä¿å­˜çš„å†³å®šæƒã€‚åœ¨ç¼–è¾‘å™¨å¯¹ <code>JSON</code>è¿›è¡Œç¼–è¾‘åï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œè½¬æ¢ã€‚å°† <code>JSON</code> é‡æ–°è½¬åŒ–ä¸º <code>XML</code>ï¼Œè¿™é‡ŒåŒæ ·ä½¿ç”¨ç±»çš„åºåˆ—åŒ–æ–¹æ³•</p>\n<pre><code class=\"language-js\">class Hotspot {\n    serialize(data) {\n        ...\n        return `&lt;hotspot ... /&gt;`\n    }\n}\n</code></pre>\n<p>è¿™é‡Œåœ¨è¿›è¡Œå¼€å‘æ—¶è¿˜æ˜¯é‡åˆ°äº†å‘ï¼Œ ä¸€å¼€å§‹æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å¯¹å±æ€§è¿›è¡Œéå†ï¼Œç„¶åé€šè¿‡å­—ç¬¦ä¸²ç»„è£…æˆ <code>XML</code>ï¼Œç”±äºä¸šåŠ¡åœºæ™¯ä¸éœ€è¦å…³å¿ƒ <code>XSS</code> çš„é—®é¢˜ã€‚ä½†æ˜¯åœ¨ä»£ç ææµ‹ä¹‹åï¼Œé—®é¢˜æ¥è¸µè€Œæ¥ã€‚å½“è¾“å…¥ç‰¹æ®Šå­—ç¬¦æˆ–è€…å¼•å·ä¹‹ç±»çš„ç‰¹æ®Šç¬¦å·æ—¶ï¼Œç”±äº <code>XML</code> çš„æ ¼å¼è¦æ±‚ï¼Œ<code>XML</code> å°±å˜æˆäº†éæ³•çš„ <code>XML</code> æ–‡æ¡£äº†ï¼Œè¿™ä¹Ÿé€ æˆäº†å…¨æ™¯ä¿å­˜å¤±è´¥ã€‚</p>\n<p>å› æ­¤æˆ‘ä»¬é€‰æ‹©é€šè¿‡å°† <code>JSON</code> è½¬åŒ–æˆé€šè¿‡ <code>DOM</code> æä¾›çš„èƒ½åŠ›æ¥è¿›è¡Œåºåˆ—åŒ–</p>\n<pre><code class=\"language-js\">const hotspot = document.createElement(&#39;hotspot&#39;) \n...\n    hotspot.setAttribute(key, value)\n...\nreturn hotspot.outerHTML\n</code></pre>\n<p>è¿™ç§æ–¹æ³•è§£å†³äº†å¤§éƒ¨åˆ†çš„é—®é¢˜ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šæœ‰ä¸å°‘çš„å‘ï¼Œä¾‹å¦‚ <code>word</code> ä¸­çš„ç‰¹æ®Šç©ºæ ¼ï¼Œå°±æ˜¯æ— æ³•è¿›è¡Œä¿å­˜ã€‚å®šä½åˆ°é—®é¢˜åï¼Œåªèƒ½æ ¹æ® <code>unicode</code> è¿›è¡ŒåŒ¹é…æ›¿æ¢ã€‚</p>\n<p>è¿˜æœ‰å¯Œæ–‡æœ¬çš„æƒ…å†µï¼Œå¯Œæ–‡æœ¬é€šè¿‡å±æ€§è¿›è¡Œä¿å­˜æ—¶ä¹Ÿä¼šå­˜åœ¨é—®é¢˜ï¼Œè¦ä¹ˆæ˜¯é¢„è§ˆå¼‚å¸¸ï¼Œè¦ä¹ˆæ˜¯å›æ˜¾åˆ°å¯Œæ–‡æœ¬ç¼–è¾‘å™¨å¼‚å¸¸ã€‚æœ€ç»ˆè¿˜æ˜¯å†³å®šé’ˆå¯¹å¯Œæ–‡æœ¬è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œç„¶åå°†<code>&amp;</code>,<code>&lt;</code>,<code>&gt;</code>,<code>&quot;</code>ç¬¦å·è¿›è¡Œå®ä½“åŒ–å¤„ç†ï¼Œä¸Šçº¿ååˆ°ç›®å‰ä¸ºæ­¢æš‚æ—¶æ— ä»»ä½•å¼‚å¸¸ã€‚</p>\n<h1 id=\"å››æœ€åç»“æœ\">å››.æœ€åç»“æœ</h1>\n<p>ç»è¿‡2.0 çš„é‡æ„ï¼Œåœ¨ä¸šåŠ¡æ¶æ„ä¸Šå‡å°‘äº†åç«¯çš„ä¾èµ–ï¼Œå¤§å¹…æé«˜äº†ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒã€‚ è®©ç”¨æˆ·å¯ä»¥é€šè¿‡å…¨æ™¯ç¼–è¾‘å™¨å¿«é€Ÿåˆ¶ä½œå‡ºå…¨æ™¯æ¼«æ¸¸ç‰©æ–™ï¼Œæ·»åŠ ä¸°å¯Œçš„äº¤äº’æ•ˆæœã€‚</p>\n<p>åœ¨å‰ç«¯ä»£ç è®¾è®¡ä¸Šï¼Œè®©å…¨æ™¯ç¼–è¾‘çš„é€»è¾‘å®Œå…¨ç‹¬ç«‹ï¼Œé’ˆå¯¹å…¨æ™¯æ¨¡å—è¿›è¡Œæ•°æ®å»ºæ¨¡ï¼Œå¯¹åç»­ç»´æŠ¤å’Œæ–°å¢åŠŸèƒ½ååˆ†çš„å‹å¥½ã€‚</p>\n<p>å½“ç„¶é€šè¿‡è¿™æ¬¡å¤§çš„é‡æ„ï¼Œæ— è®ºæ˜¯ä¸šåŠ¡æ¶æ„è®¾è®¡è¿˜æ˜¯ç»„ä»¶æ‹†åˆ†ï¼Œæˆ‘éƒ½æœ‰äº†å·¨å¤§çš„æ”¶è·ã€‚</p>\n<p>å½“ç„¶é‡æ„åˆ°ç›®å‰ä¸ºæ­¢ï¼Œç¼–è¾‘å™¨å·²ç»é‡æ„çš„ååˆ†å¼ºå¤§äº†ã€‚ä½†æ˜¯è¿˜æ˜¯ç¼ºå°‘ä¸€ä¸ªæœ€é‡è¦çš„åŠŸèƒ½ï¼š å†å²è®°å½•ã€‚åé¢æˆ‘ä¼šæœ‰ä¸“æ–‡ä»‹ç»å†å²è®°å½•åŠŸèƒ½çš„å®ç°ï¼Œå’Œå…·ä½“ä¸šåŠ¡éš¾ç‚¹ã€‚</p>\n",
        "title": "ç¼–è¾‘å™¨é‡æ„ï¼Œæ•°æ®å»ºæ¨¡å®è·µ",
        "created": "2022-06-16 14:33:48  ",
        "updated": "2022-06-16 14:33:48 ",
        "excerpt": "ä¸€. ä¸šåŠ¡èƒŒæ™¯ æ—¥å¸¸çš„å·¥ä½œæœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†éƒ½æ˜¯ç¼–è¾‘å™¨çš„å¼€å‘ã€‚ç”±äºä¸šåŠ¡éœ€æ±‚ï¼Œä»Šå¹´æ¨åŠ¨äº†å…¨æ™¯ç¼–è¾‘å™¨2.0çš„é‡æ„ã€‚æœ¬æ–‡ä¼šä¸»è¦è®²è¿°æ­¤æ¬¡é‡æ„çš„å…¨éƒ¨ç»†èŠ‚ã€‚ ä½œä¸ºä¸€æ¬¾ç¼–è¾‘å™¨ï¼Œè€ç‰ˆå…¨æ™¯ç¼–è¾‘å™¨çš„åŠŸèƒ½å­˜åœ¨å¾ˆå¤šé—®é¢˜ã€‚ æ•°æ®å®æ—¶å˜åŒ–ï¼Œç”¨æˆ·æ“ä½œåç«‹å³ä¿å­˜ã€‚ä¸èƒ½è¿›è¡Œæ’¤é”€ï¼Œ...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "11"
    },
    "12": {
        "content": "<h1 id=\"ä¸€-ä¸šåŠ¡èƒŒæ™¯\">ä¸€. ä¸šåŠ¡èƒŒæ™¯</h1>\n<p><a href=\"https://github.com/vivipure/blog/issues/11\">ä¸Šæ–‡</a>æˆ‘è®²äº†ç¼–è¾‘å™¨çš„æ•´ä½“é‡æ„ï¼Œä¹Ÿç•™ä¸‹äº†ä¸€ä¸ªå…³äº <strong>å†å²è®°å½•</strong> çš„å‘ã€‚åœ¨æˆ‘ä»¬çš„ä¸šåŠ¡ä¸­ï¼Œæ— è®ºè€ç‰ˆæœ¬è¿˜æ˜¯æ–°ç‰ˆï¼Œéƒ½ç¼ºå°‘å†å²è®°å½•çš„åŠŸèƒ½ã€‚ </p>\n<p>ä½œä¸ºä¸€æ¬¾ç¼–è¾‘å™¨ï¼Œä¸èƒ½è¿›è¡Œå†å²è®°å½•çš„å±•ç¤ºï¼Œä¸èƒ½è¿›è¡Œæ“ä½œçš„å›é€€å’Œé‡åšæ˜¯ä¸å®Œæ•´çš„ã€‚å› æ­¤å¼€å‘å†å²è®°å½•åŠŸèƒ½åˆ»ä¸å®¹ç¼“ã€‚</p>\n<h1 id=\"äºŒ-æ–¹æ¡ˆé€‰å‹\">äºŒ. æ–¹æ¡ˆé€‰å‹</h1>\n<p>å’ŒH5ç¼–è¾‘å™¨ä¸ä¸€æ ·ï¼Œåœ¨H5ç¼–è¾‘å™¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡JSONç›´æ¥æ§åˆ¶ç›¸å…³å…ƒç´ çš„å±•ç¤ºã€‚å†å²è®°å½•åŠŸèƒ½å¯ä»¥å°†JSONåœ¨æ“ä½œåè¿›è¡Œå¤‡ä»½ï¼Œå›æ’¤æ—¶ç›´æ¥ä½¿ç”¨å¤‡ä»½çš„JSONå³å¯ã€‚</p>\n<p>è¿™ä¹Ÿæ˜¯é€šè¿‡ <code>å¿«ç…§æ–¹å¼</code> å®ç°å†å²è®°å½•åŠŸèƒ½çš„åŸºæœ¬é€»è¾‘ï¼Œä½†æ˜¯å…¨æ™¯ç¼–è¾‘å™¨å´æ— æ³•ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œå…¨æ™¯ç¼–è¾‘å™¨çš„é¢„è§ˆå¹¶ä¸æ˜¯ç”±JSONç›´æ¥æ§åˆ¶ï¼Œæ¯æ¬¡JSONæ›´æ–°éƒ½éœ€è¦æ‰‹åŠ¨æ›´æ–°é¢„è§ˆã€‚å¦‚æœé€šè¿‡ <code>å¿«ç…§æ–¹å¼</code>å®ç°è¯¥éœ€æ±‚ï¼Œé‚£ä¹ˆåœ¨è¿›è¡Œå›æ’¤æ—¶ï¼Œå…¨æ™¯é¢„è§ˆå°±ä¼šé‡è½½ï¼Œç”¨æˆ·ä½¿ç”¨ä½“éªŒååˆ†ä¸å¥½ã€‚æˆ‘ä»¬æ›´éœ€è¦çš„æ˜¯ååˆ†ç²¾ç»†çš„æ›´æ–°ã€‚</p>\n<p>äºæ˜¯æˆ‘é€‰æ‹©äº† <code>å‘½ä»¤æ¨¡å¼</code> ï¼Œæˆ‘åœ¨å…¨å±€å»ºç«‹ä¸€ä¸ªå†å²è®°å½•çš„ä¸€ä¸ªç®¡ç†ç±»ï¼Œç”¨æˆ·çš„æ¯ä¸€æ¬¡æ“ä½œéƒ½ä¼šè§¦å‘ä¸€ä¸ªå‘½ä»¤ï¼Œç„¶å <code>push</code> åˆ°å†å²è®°å½•ä¸­ã€‚åœ¨å†å²è®°å½•ä¸­å¯ä»¥çœ‹åˆ°æ¯ä¸ªå‘½ä»¤çš„ç»†èŠ‚ï¼Œç‚¹å‡»å¯¹åº”å‘½ä»¤æ—¶ï¼Œæ ¹æ®çŠ¶æ€æ‰§è¡Œå½“å‰å‘½ä»¤å’Œç‚¹å‡»å‘½ä»¤ä¹‹é—´çš„æ‰€æœ‰å‘½ä»¤çš„åŠ¨ä½œï¼Œæ‰§è¡Œå°±æ˜¯é‡åšï¼Œæ’¤é”€å°±æ˜¯å›æ’¤ã€‚è¿™æ ·å°±å®ç°äº†å†å²è®°å½•åŠŸèƒ½å’Œé‡åšæ’¤é”€ã€‚</p>\n<h1 id=\"ä¸‰-å®æ“\">ä¸‰. å®æ“</h1>\n<h2 id=\"31-å®šä¹‰å‘½ä»¤ç±»å’Œæ§åˆ¶ç±»\">3.1 å®šä¹‰å‘½ä»¤ç±»å’Œæ§åˆ¶ç±»</h2>\n<p>é¦–å…ˆæ˜¯å®šä¹‰å‘½ä»¤åŸºç±»</p>\n<pre><code class=\"language-js\">class Command {\n    name\n    excute() {}\n    undo() {}\n}\n</code></pre>\n<p>æ¯ä¸ªå‘½ä»¤åŒ…å« name å’Œ æ‰§è¡Œé‡åšä¸¤ä¸ªæ–¹æ³•ã€‚æ¥ä¸‹æ¥å°±æ˜¯ç®¡ç†å™¨</p>\n<pre><code class=\"language-js\">class Controller {\n    commandStack = []\n    curIdx = 0\n    maxLength = 30\n    \n    execute(command){}\n    undo(idx){...}\n    redo(idx){...}\n    \n    deal(command) {\n        const idx = this.commandStack.findIndex(c =&gt; c=== command)\n        if(idx &lt; this.curIdx) {\n            this.undo(idx)\n        } else {\n            this.redo(idx)\n        }\n    }\n\n}\n</code></pre>\n<p>ç®¡ç†å™¨ä¸­ç»´æŠ¤äº†ä¸€ä¸ªå‘½ä»¤çš„æ•°ç»„å’Œå½“å‰çš„ç´¢å¼•ï¼Œè¿™ç§å®ç°æ¯”ä½¿ç”¨ é‡åšå’Œæ’¤é”€ä¸¤ä¸ªæ•°ç»„ è¦ç®€å•å’Œæ¸…æ™°ã€‚åŒæ—¶ä¹Ÿå®šä¹‰äº†å†å²è®°å½•çš„æœ€å¤§æ•°ã€‚ æ¯ä¸ªå‘½ä»¤éƒ½éœ€è¦ç®¡ç†å™¨è¿›è¡Œæ‰§è¡Œï¼Œ ç„¶åç®¡ç†å™¨ä¹Ÿæä¾›é‡åšå’Œæ’¤é”€åŠŸèƒ½.</p>\n<p>å…·ä½“çš„é‡åšå’Œæ’¤é”€ä»£ç æˆ‘è¿™é‡Œå°±å±•å¼€äº†ï¼Œå®é™…é€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯ä»æ•°ç»„ä¸­å–å‡ºå¯¹åº”çš„å‘½ä»¤æ‰§è¡Œç›¸å…³çš„æ“ä½œï¼Œç„¶åæ›´æ–°ç´¢å¼•å³å¯ã€‚</p>\n<h2 id=\"32-å’Œæ¡†æ¶ç»“åˆ\">3.2 å’Œæ¡†æ¶ç»“åˆ</h2>\n<p>æˆ‘å¼•å…¥å‘½ä»¤æ¨¡å¼ï¼Œå…¶å®æ˜¯å¸Œæœ›é€šè¿‡å‘½ä»¤æ¥è¿›è¡Œæ•°æ®çš„æ›´æ–°å’Œè§†å›¾çš„æ›´æ–°ï¼Œä½†æ˜¯ <code>Vue</code> ä½œä¸ºæ•°æ®ç»‘å®šçš„æ¡†æ¶ï¼Œå½“è§†å›¾æ”¹å˜åï¼Œæ•°æ®è‡ªåŠ¨æ›´æ–°äº†ï¼Œå¹¶æ²¡æœ‰åœ¨å‘½ä»¤ç±»ä¸­è¿›è¡Œæ“ä½œã€‚è¿™å…¶å®ä¸ç¬¦åˆæˆ‘çš„é¢„æœŸã€‚è¿™æ ·å¯¹åé¢çš„é‡åšå’Œæ’¤é”€æ“ä½œä¹Ÿä¼šæœ‰å½±å“ï¼Œä¼šé€ æˆæ— æ³•å¯¹æ¯”æ›´æ”¹çš„é—®é¢˜ã€‚</p>\n<p>æˆ‘çš„è§£å†³æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯å½“ç¼–è¾‘å™¨é€‰ä¸­ç¼–è¾‘æ•°æ®æ—¶ï¼Œç‰¹å®šçš„æ•°æ®ï¼Œä½¿ç”¨ç‰¹å®šçš„æ›´æ–°å‘½ä»¤ç±»è®°å½•å½“å‰çš„æ•°æ®ã€‚</p>\n<pre><code class=\"language-js\">watch: {\n    editData  {\n        handler(cur, last) {\n            // ä¸åŒæ•°æ®ï¼Œè®¾ç½®å¤‡ä»½\n            if(cur !== last) {\n                if(this.editType === editTypeConst.hotspot) {\n                    UpdateHotspotCommand.setTarget(cur)\n                }\n            }else {\n                // ç›¸åŒæ•°æ®ï¼Œæ„å‘³ç€æ•°æ®å˜åŠ¨\n                const command = new UpdateHotspotCommand(cur)\n                // ç®¡ç†å™¨å®è§¦å‘ç½šå‘½ä»¤\n                controller.execute(command)\n            }\n        },\n        deep: true\n    }\n}\n\nclass UpdateHotspotCommand extends Command {\n    static target = null\n    \n    static setTarget(data) {\n        this.target = JSON.parse(JSON.stringify(data))\n    }\n    execute() {}\n    undo() {}\n    // æ•°æ®å˜åŒ–åï¼Œæ¯”è¾ƒæ•°æ®ä¹‹é—´ä¸åŒçš„å­—æ®µ\n    getDiffKeys() {}\n\n}\n</code></pre>\n<p>æ¯æ¬¡é€‰ä¸­æ•°æ®æ—¶ï¼Œå°±å°†å½“å‰æ•°æ®å¤‡ä»½ï¼Œå½“æ•°æ®æ›´æ”¹åå°±è§¦å‘å¯¹åº”å‘½ä»¤ã€‚åœ¨å‘½ä»¤ç±»ä¸­è¿›è¡Œæ•°æ®æ¯”è¾ƒï¼Œç„¶ååœ¨ \n<code>execute</code>, <code>undo</code> æ›´æ”¹æ•°æ®å’Œå¼•ç”¨å¯¹åº”çš„ç±»æ›´æ–°è§†å›¾ã€‚ ä¹‹å‰é‡æ„æ—¶è¿˜æ˜¯çš„å¿…é¡»å°†ç±»åœ¨Vueæ–‡ä»¶ä¸­ä½¿ç”¨ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œå®Œå…¨è¿›è¡Œäº†éš”ç¦»ï¼Œæ¯ä¸ªç»„ä»¶åªå…³å¿ƒ <code>JSON</code> æ•°æ®çš„æ”¹å˜ï¼Œè§†å›¾çš„æ›´æ–°é€šè¿‡ <code>watch</code> ,ç”Ÿæˆå‘½ä»¤è¿›è¡Œæ§åˆ¶ã€‚</p>\n<p>ä¸Šé¢ä¸»è¦è®²çš„æ˜¯æ›´æ–°å‘½ä»¤å’Œ <code>Vue</code> æ¡†æ¶çš„å…¼å®¹ï¼Œå…¶ä»–çš„åˆ é™¤ï¼Œæ·»åŠ å‘½ä»¤å°±è¦ç®€å•çš„å¤šäº†ã€‚</p>\n<h2 id=\"32-å‘½ä»¤åˆå¹¶çš„å®ç°\">3.2 å‘½ä»¤åˆå¹¶çš„å®ç°</h2>\n<p>åœ¨è¿›è¡Œå¼€å‘æ—¶ï¼Œæœ‰å‚è€ƒ <code>photoshop</code> å†å²è®°å½•çš„å®ç°ï¼Œå¯¹äºåŒä¸€ä¸ªå¯¹è±¡åŒä¸€ç§æ“ä½œï¼Œå†å²è®°å½•ä¼šè¿›è¡Œåˆå¹¶ï¼Œåªä¼šå‡ºç°ä¸€æ¡è®°å½•ã€‚åœ¨å…¨æ™¯ç¼–è¾‘å™¨ä¸­ä¹Ÿä¼šå‡ºç°çƒ­ç‚¹ç§»åŠ¨ç­‰å¤šæ¬¡è§¦å‘çš„æ“ä½œï¼Œå› æ­¤ä¹Ÿéœ€è¦å®ç°å‘½ä»¤åˆå¹¶çš„åŠŸèƒ½ï¼Œä¼˜åŒ–å†å²è®°å½•çš„å±•ç¤ºã€‚</p>\n<p>å…·ä½“çš„å®ç°ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨ <code>controller</code> æ‰§è¡Œå‘½ä»¤æ—¶ï¼Œåˆ¤æ–­å½“å‰å‘½ä»¤æ˜¯å¦æœ‰å®ç°åˆå¹¶çš„æ–¹æ³•ï¼Œå¦‚æœæœ‰ä¸”ä¸Šä¸€æ¡å‘½ä»¤å’Œå½“å‰å‘½ä»¤æ˜¯åŒä¸€å‘½ä»¤çš„å®ä¾‹ï¼Œå°±è¿›è¡Œæ¯”è¾ƒã€‚</p>\n<p>ä¸»è¦æ¯”è¾ƒæ•°æ®æ”¹å˜çš„å­—æ®µæ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœå­—æ®µä¸€è‡´ï¼Œé‚£ä¹ˆå°±å°†å½“å‰å‘½ä»¤æ›´æ–°çš„éƒ¨åˆ†åˆå¹¶åˆ°ä¸Šä¸€æ¡å‘½ä»¤ä¸­å³å¯ï¼Œè¿™æ ·å°±å®ç°äº†å‘½ä»¤çš„åˆå¹¶åŠŸèƒ½ã€‚</p>\n<h1 id=\"å››-å‘½ä»¤æ¨¡å¼å­˜åœ¨çš„é—®é¢˜\">å››. å‘½ä»¤æ¨¡å¼å­˜åœ¨çš„é—®é¢˜</h1>\n<p><code>å‘½ä»¤æ¨¡å¼</code> å¯¹æˆ‘ä»¬ç®¡ç†åº”ç”¨çš„æ•°æ®æ“ä½œæœ‰ç€å¾ˆå¤§çš„å¥½å¤„ï¼Œä½†æ˜¯å®ƒä¹Ÿå­˜åœ¨ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„é—®é¢˜ã€‚å°±æ˜¯éšç€æ“ä½œçš„å˜å¤šï¼Œç›¸å…³çš„å‘½ä»¤æ–‡ä»¶ä¹Ÿä¼šéšä¹‹è†¨èƒ€ï¼Œç¼–è¾‘å™¨å‡ åä¸Šç™¾ç§æ“ä½œéƒ½éœ€è¦è¿›è¡Œå®šä¹‰ç›¸å…³å‘½ä»¤ç±»ï¼Œå·¥ä½œé‡å’Œä»£ç ä½“ç§¯è†¨èƒ€éƒ½æ˜¯é—®é¢˜ã€‚</p>\n<p>ä½†æ˜¯ <code>å‘½ä»¤æ¨¡å¼</code> å¯¹äºå…¨æ™¯ç¼–è¾‘å™¨çš„ä¸šåŠ¡åœºæ™¯ååˆ†é€‚åˆï¼Œç”¨æˆ·ä½“éªŒä¹Ÿååˆ†å‹å¥½ï¼Œæ¯•ç«Ÿä¹Ÿä¸æƒ³ç”¨æˆ·æ¯æ¬¡å›æ’¤éƒ½é»‘å±ä¸€ä¸‹ã€‚å› æ­¤åŸºäºä¸šåŠ¡åœºæ™¯ï¼Œæœ€ç»ˆè¿˜æ˜¯ä½¿ç”¨äº†è¿™å¥—æ–¹æ¡ˆ</p>\n<h1 id=\"äº”-æœ€åæ€»ç»“\">äº”. æœ€åæ€»ç»“</h1>\n<p>é€šè¿‡å¯¹ç¼–è¾‘å™¨çš„å†å²è®°å½•åŠŸèƒ½å¼€å‘ï¼Œæˆ‘å­¦ä¼šäº† <code>å‘½ä»¤æ¨¡å¼</code> å’Œ <code>å¿«ç…§æ–¹å¼</code> ä¸¤ç§æ–¹æ¡ˆã€‚æˆ‘ä»¬åœ¨å®é™…ä¸šåŠ¡å¼€å‘ä¸­å¯ä»¥æ ¹æ®ä¸šåŠ¡åœºæ™¯è¿›è¡ŒæŠ€æœ¯é€‰å‹ã€‚ å¦‚æœæ˜¯ç®€å•çš„H5ç¼–è¾‘å™¨ï¼Œé‚£ä¹ˆ <code>å¿«ç…§æ–¹å¼</code> å°±è¶³å¤Ÿäº†ã€‚ä½†å¦‚æœä½ çš„ä¸šåŠ¡åœºæ™¯ä¹Ÿå’Œæˆ‘ä»¬çš„åœºæ™¯ç±»ä¼¼ï¼Œæ•°æ®å’Œé¢„è§ˆè§†å›¾æ˜¯å®Œå…¨ç‹¬ç«‹çš„åœºæ™¯ï¼Œé‚£ä¹ˆ <code>å‘½ä»¤æ¨¡å¼</code> æ˜¯æ¯”è¾ƒåˆé€‚çš„ã€‚</p>\n<p>æ²¡æœ‰å®Œç¾çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œ æˆ‘ä»¬åªèƒ½é€‰æ‹©åšç›¸å¯¹æ­£ç¡®çš„äº‹è€Œä¸æ˜¯åšç®€å•çš„äº‹ï¼</p>\n",
        "title": "ç¼–è¾‘å™¨å†å²è®°å½•åŠŸèƒ½ï¼Œå‘½ä»¤æ¨¡å¼å®æ“",
        "created": "2022-06-16 15:18:46  ",
        "updated": "2022-06-18 10:04:15 ",
        "excerpt": "ä¸€. ä¸šåŠ¡èƒŒæ™¯ ä¸Šæ–‡æˆ‘è®²äº†ç¼–è¾‘å™¨çš„æ•´ä½“é‡æ„ï¼Œä¹Ÿç•™ä¸‹äº†ä¸€ä¸ªå…³äº å†å²è®°å½• çš„å‘ã€‚åœ¨æˆ‘ä»¬çš„ä¸šåŠ¡ä¸­ï¼Œæ— è®ºè€ç‰ˆæœ¬è¿˜æ˜¯æ–°ç‰ˆï¼Œéƒ½ç¼ºå°‘å†å²è®°å½•çš„åŠŸèƒ½ã€‚ ä½œä¸ºä¸€æ¬¾ç¼–è¾‘å™¨ï¼Œä¸èƒ½è¿›è¡Œå†å²è®°å½•çš„å±•ç¤ºï¼Œä¸èƒ½è¿›è¡Œæ“ä½œçš„å›é€€å’Œé‡åšæ˜¯ä¸å®Œæ•´çš„ã€‚å› æ­¤å¼€å‘å†å²è®°å½•åŠŸèƒ½åˆ»ä¸å®¹...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "12"
    },
    "13": {
        "content": "<h1 id=\"ä¸€-ä¸šåŠ¡èƒŒæ™¯\">ä¸€. ä¸šåŠ¡èƒŒæ™¯</h1>\n<p>éƒ¨é—¨çš„ä¸šåŠ¡ä¸»è¦æ˜¯è¥é”€ç‰©æ–™çš„ç”Ÿäº§ï¼Œå¯ä»¥åˆ†å‘åˆ°ä¸åŒç»ˆç«¯ã€‚æ‰‹æœºå¯ä»¥åœ¨H5ï¼Œå°ç¨‹åºå±•ç¤ºï¼ŒPCå¯ä»¥æ‰“åŒ…æˆ electronåº”ç”¨ï¼Œä½†æ˜¯ç›®å‰åœ¨å®‰å“åº”ç”¨ä¸Šæ˜¯ç©ºç¼ºçš„ã€‚å› æ­¤éœ€è¦æä¾›ç”¨æˆ·å¯ä»¥å°†åˆ¶ä½œçš„ç‰©æ–™ç›´æ¥æ‰“åŒ…æˆå®‰å“åº”ç”¨çš„èƒ½åŠ›ã€‚</p>\n<h1 id=\"äºŒæŠ€æœ¯é€‰å‹\">äºŒ.æŠ€æœ¯é€‰å‹</h1>\n<p>åœ¨å‰ç«¯ç›¸å…³æ¡†æ¶ä¸­ï¼Œæä¾›å°†H5æ‰“åŒ…æˆå®‰å“åº”ç”¨çš„æ¡†æ¶å¾ˆå¤šã€‚æˆ‘ä»¬ä¸»è¦éœ€è¦çš„æ˜¯èƒ½å¤Ÿè¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œä¸”èƒ½å¤Ÿå¿«é€Ÿè¿›è¡Œæ¥å…¥ã€‚</p>\n<p>å…¶å®ä¸€å¼€å§‹æœ‰æƒ³è¿‡è‡ªå·±å°è£… webview ï¼Œç„¶åå®ç°æ··åˆåº”ç”¨æ¡†æ¶çš„æ–¹æ¡ˆçš„ã€‚ä½†æ˜¯éƒ¨é—¨å†…éƒ¨éƒ½æ²¡æœ‰å®‰å“å¼€å‘çš„ç»éªŒï¼Œä¸”éœ€æ±‚æ—¶é—´è¾ƒç´§ï¼Œé€‰æ‹©ç°æœ‰çš„æ··åˆæ¡†æ¶ç¬¦åˆæˆ‘ä»¬çš„å½“å‰çš„ä¸šåŠ¡åœºæ™¯ã€‚</p>\n<p>æœ€ç»ˆé€‰æ‹©äº† <a href=\"https://capacitorjs.com/\">capacitor</a> è¿™ä¸ªæ¡†æ¶ï¼Œè¿™ä¸ªæ¡†æ¶å¯ä»¥çœ‹ä½œåœ¨ cordova çš„è¿›é˜¶ç‰ˆã€‚åŠŸèƒ½æ¯”è¾ƒé½å…¨ï¼Œä¸”æä¾›äº†å¾ˆå¤šæ’ä»¶ã€‚</p>\n<h1 id=\"ä¸‰-è‡ªåŠ¨åŒ–å®ç°\">ä¸‰. è‡ªåŠ¨åŒ–å®ç°</h1>\n<p>æ‰“åŒ…æˆå®‰å“åº”ç”¨å¾ˆç®€å•ï¼Œcapacitor æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œç„¶åå°†h5æ”¾åˆ°æŒ‡å®šç›®å½•ä¸­ï¼Œç„¶åæ‰§è¡Œç›¸å…³å‘½ä»¤å³å¯ã€‚</p>\n<p>éœ€æ±‚çš„ä¸»è¦éš¾ç‚¹åœ¨äºå¦‚ä½•å®ç°è‡ªåŠ¨åŒ–ï¼Œåç«¯å¯ä»¥é€šè¿‡ java ç›´æ¥è°ƒç”¨æœåŠ¡å™¨æ‰“åŒ…åº”ç”¨ï¼Œç„¶åæä¾›æ¥å£ç»™å‰ç«¯ã€‚æœ€ç»ˆå±•ç¤ºç»™ç”¨æˆ·çš„å°±æ˜¯ä¸€ä¸ªæŒ‰é’®ï¼Œæ‰“åŒ…æˆåŠŸåè‡ªåŠ¨é€šçŸ¥ç”¨æˆ·ï¼Œç”¨æˆ·ä¸‹è½½åº”ç”¨å³å¯ã€‚</p>\n<p>æŸ¥çœ‹äº†ç›¸å…³æ–‡æ¡£ä¹‹åï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œä¸»è¦å°±æ˜¯åœ¨æœåŠ¡å™¨å®‰è£…å®‰å“ç¯å¢ƒï¼Œç„¶åæ‰§è¡Œcapacitorçš„æ‰“åŒ…å³å¯ã€‚</p>\n<h2 id=\"31-å®‰å“ç¯å¢ƒé…ç½®\">3.1 å®‰å“ç¯å¢ƒé…ç½®</h2>\n<p><code>SDKManger</code> æ˜¯ <code>Androdi SDK</code> ç®¡ç†å·¥å…·ï¼Œå¯ä»¥é€šè¿‡ <code>SDKManager</code> ä¸‹è½½  <code>Androdi SDK</code></p>\n<pre><code class=\"language-shell\"># ä¸‹è½½\n\ncurl -O https://dl.google.com/android/repository/commandlinetools-linux-7583922_latest.zip\n\n# è§£å‹åˆ°ç›®å½• å¾—åˆ°æ–‡ä»¶å¤¹ cmdline-tools\n\nunzip commandlinetools-linux-7583922_latest.zip\n\n# æ‰“å¼€åˆ° cmdlin-tools/bin ä¸‹è½½SDK 31ï¼ˆè‹¥éœ€è¦å…¶ä»–ç‰ˆæœ¬sdkï¼Œ å¯æ›´æ¢ç‰ˆæœ¬å·ï¼‰\n\n./sdkmanager --sdk_root=../ --install &quot;build-tools;31.0.0&quot; &quot;platforms;android-31&quot;\n</code></pre>\n<p>è®¾ç½®ç¯å¢ƒå˜é‡ ï¼Œ æŒ‡å®šandroid_home çš„è·¯å¾„ä¸ºcmdline-toolsçš„ç»å¯¹è·¯å¾„</p>\n<pre><code class=\"language-shell\">sudo vim /etc/profile\n\n...\n\n# Android\n\nexport ANDROID_HOME=...\n\nexport PATH=$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools:$PATH\n\n...\n\n# åº”ç”¨\n\nsource /etc/profile\n</code></pre>\n<h2 id=\"32-capacitor-å®‰è£…\">3.2 capacitor å®‰è£…</h2>\n<pre><code class=\"language-shell\">npm init -y\n\n# ä¸‹è½½capacitorä¾èµ– \n\nyarn add @capacitor/core @capacitor/cli @capacitor/android -D\n\n# capacitoråˆå§‹åŒ–\n\nnpx cap init\nnpx cap add android\n# æ–°å»ºwwwç›®å½•å­˜æ”¾ç½‘é¡µ\nmkdir www\n# å¤åˆ¶ç½‘é¡µæ–‡ä»¶åˆ°å®‰å“ ä¸€èˆ¬ç”¨ä¸‹é¢åŒæ­¥å‘½ä»¤å°±å¯ä»¥äº†\nnpx cap copy android\n# åŒæ­¥é…ç½®\nnpx cap sync\n</code></pre>\n<h2 id=\"33-ç­¾åé…ç½®\">3.3 ç­¾åé…ç½®</h2>\n<p>å®‰å“æ­£å¼æ‰“åŒ…éœ€è¦è¿›è¡Œç­¾åï¼Œå› æ­¤éœ€è¦å…ˆç”Ÿæˆç­¾åæ–‡ä»¶, åœ¨ <code>capacitor</code> ç”Ÿæˆå¥½çš„ç›®å½•ä¸­ï¼Œè¿›å…¥å®‰å“ç›®å½•</p>\n<pre><code class=\"language-shell\"># åœ¨androidç›®å½•ä¸‹ æ‰§è¡Œè¯¥å‘½ä»¤\nkeytool -genkey -v -keystore my-release-key.jks -keyalg RSA -keysize 2048 -validity 10000 -alias my-alias\n</code></pre>\n<p>ç”Ÿæˆå¥½ç­¾ååä¼šç”Ÿæˆä¸€ä¸ª <code>my-release-key.jks</code> çš„æ–‡ä»¶</p>\n<p>æ‰“å¼€ <code>app</code> ç›®å½•ï¼Œç¼–è¾‘ <code>build.gradle</code> æ–‡ä»¶</p>\n<pre><code class=\"language-groovy\">android {\n\n...\n\n    // å–æ¶ˆæ ¼å¼æ£€æŸ¥ï¼Œé¿å…æ‰“åŒ…é”™è¯¯\n    lintOptions {\n        checkReleaseBuilds false\n    }\n    // ç­¾åé…ç½®\n    signingConfigs {\n        release {\n            storeFile file(&quot;../my-release-key.jks&quot;)\n            storePassword &quot;password&quot; # è¿™ä¸ªå¯†ç éœ€è¦å¡«ç”Ÿæˆç­¾åæ—¶çš„å¯†ç \n            keyAlias &quot;my-alias&quot;\n            keyPassword &quot;password&quot; # è¿™ä¸ªå¯†ç éœ€è¦å¡«ç”Ÿæˆç­¾åæ—¶çš„å¯†ç \n        }\n    }\n\n    buildTypes {\n        release {\n            signingConfig signingConfigs.release\n            ...\n        }\n    }\n\n...\n\n}\n</code></pre>\n<p>å®Œæˆä¸Šè¿°é…ç½®åï¼Œåœ¨ <code>android</code> ç›®å½•å°±å¯ä»¥æ‰§è¡Œæ‰“åŒ…äº†</p>\n<pre><code class=\"language-shell\">./gradlew assembleRelease\n</code></pre>\n<p>æ‰“åŒ…å®Œæˆåä¼šåœ¨./app/build/outputs/apk/release æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆapp-release.apk æ–‡ä»¶</p>\n<h1 id=\"å››-capacitoré…ç½®\">å››. capacitoré…ç½®</h1>\n<h2 id=\"41-è‡ªå®šä¹‰å¯åŠ¨å›¾å’Œlogo\">4.1 è‡ªå®šä¹‰å¯åŠ¨å›¾å’Œlogo</h2>\n<p> ä¸‹è½½ä¾èµ–åŒ…</p>\n<pre><code>yarn add cordova-res -D\n</code></pre>\n<p>æ‰“åŒ…ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶å¤¹<code> resource/android</code></p>\n<p>é…ç½®å››ä¸ªæ–‡ä»¶, æ™®é€šä½¿ç”¨æ—¶å¯ä»¥å°†<code>icon</code>,<code>icon-backgournd</code>,<code>icon-foreground</code>è®¾ç½®ä¸ºä¸€è‡´å³å¯</p>\n<pre><code>- icon.png // å›¾æ ‡ 1024 * 1024\n- splash.png // å¯åŠ¨å›¾ æœ€å°2732*2732\n- icon-background.png // è‡ªé€‚åº”å›¾æ ‡ æœ€å°432*432\n- icon-foreground.png // è‡ªé€‚åº”å›¾æ ‡ æœ€å°432*432\n</code></pre>\n<p>åœ¨ <code>package.json</code> æ–°å¢å‘½ä»¤</p>\n<pre><code>&quot;icon&quot;: &quot;cordova-res android --skip-config --copy&quot;\n</code></pre>\n<p>æ‰§è¡Œå‘½ä»¤å³å¯ç”Ÿæˆå’Œæ›¿æ¢æºç çš„å›¾æ ‡</p>\n<pre><code>npm run icon\n</code></pre>\n<p>è¿™é‡Œè¸©äº†å¾ˆå¤šå‘ï¼Œåˆ©ç”¨ <code>cordova-res</code> å·¥å…·å¯ä»¥å°† å›¾ç‰‡è£æˆå“åº”å¼çš„å›¾ç‰‡ï¼Œé€‚åˆä¸åŒçš„å±å¹•ã€‚ä½†æ˜¯æˆ‘ä»¬çš„ä¸šåŠ¡éœ€æ±‚å°±å†³å®šäº†ï¼Œæœ€ç»ˆäº§ç‰©æ˜¯å›ºå®šåˆ†è¾¨ç‡çš„å®‰å“è®¾å¤‡ï¼Œå› æ­¤è¿™é‡Œå¯ä»¥ä¸ä½¿ç”¨ä¸Šé¢çš„æ’ä»¶ï¼Œç›´æ¥å°†æ–‡ä»¶å¤åˆ¶åˆ°å®‰å“çš„ res ä¸­å­˜æ”¾å›¾æ ‡å’Œå¯åŠ¨å›¾çš„ç›®å½•å³å¯ï¼Œåˆ é™¤æ‰é‚£äº›é’ˆå¯¹ä¸åŒåˆ†è¾¨ç‡çš„ç›®å½•ï¼Œåªä¿ç•™ä¸€ä¸ªå³å¯.</p>\n<h2 id=\"42-appå¼ºåˆ¶æ¨ªå±\">4.2 APPå¼ºåˆ¶æ¨ªå±</h2>\n<p>é…ç½®<code>AndroidManifest.xml</code></p>\n<pre><code class=\"language-xml\">&lt;activity\n    android:screenOrientation=&quot;landscape&quot;\n</code></pre>\n<h2 id=\"43-ä¿®æ”¹åŒ…å\">4.3 ä¿®æ”¹åŒ…å</h2>\n<p>åŒ…åå†³å®šäº†æ‰‹æœºå®‰è£…åº”ç”¨çš„ç›®å½•ã€‚å¦‚æœæ‰‹æœºå®‰è£…äº†ä¸€ä¸ªåº”ç”¨ï¼Œå†å®‰è£…ä¸€ä¸ªä¸å®ƒåŒ…åä¸€è‡´çš„åº”ç”¨æ—¶ï¼Œä¼šå¯¼è‡´è¦†ç›–åº”ç”¨ã€‚</p>\n<p>å¦‚æœæŠ¥åä¸€è‡´ï¼Œç­¾åè¯ä¹¦ä¸ä¸€è‡´ï¼Œåˆ™å®‰è£…å¤±è´¥ã€‚</p>\n<p>åœ¨<code>./android/app/build.gradle</code> æ–‡ä»¶è¿›è¡Œä¿®æ”¹å³å¯</p>\n<pre><code class=\"language-gradle\">android {\n    ...\n    defaultConfig {\n        applicationId &quot;com.test.app&quot;\n        ...\n    }\n    ...\n}\n</code></pre>\n<h2 id=\"44-å¼ºåˆ¶å…¨å±\">4.4 å¼ºåˆ¶å…¨å±</h2>\n<p>é…ç½® <code>android/app/src/res/value/styles.xml</code></p>\n<pre><code class=\"language-xml\">&lt;style name=&quot;AppTheme.NoActionBar&quot; parent=&quot;Theme.AppCompat.NoActionBar&quot;&gt;\n    ...\n    &lt;item name=&quot;android:windowFullscreen&quot;&gt;true&lt;/item&gt;\n    ...\n&lt;/style&gt;\n</code></pre>\n<h2 id=\"45-ä¿®æ”¹åº”ç”¨åç§°\">4.5 ä¿®æ”¹åº”ç”¨åç§°</h2>\n<p>åœ¨<code>android/app/src/main/res/values/strings.xml</code>ä¿®æ”¹æ–‡ä»¶</p>\n<pre><code class=\"language-xml\">&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39;?&gt;\n&lt;resources&gt;\n     &lt;!-- åº”ç”¨åç§° --&gt;\n    &lt;string name=&quot;app_name&quot;&gt;xx&lt;/string&gt; \n    &lt;string name=&quot;title_activity_main&quot;&gt;xx&lt;/string&gt;\n    &lt;!-- åŒ…å --&gt;\n    &lt;string name=&quot;package_name&quot;&gt;cn.xx.xx&lt;/string&gt;\n     &lt;!-- è‡ªå®šä¹‰åè®® --&gt;\n    &lt;string name=&quot;custom_url_scheme&quot;&gt;cn.xx.xx&lt;/string&gt;\n&lt;/resources&gt;\n</code></pre>\n<h1 id=\"äº”-å‚è€ƒèµ„æ–™\">äº”. å‚è€ƒèµ„æ–™</h1>\n<ol>\n<li><a href=\"https://developer.android.com/docs?hl=zh-cn\">https://developer.android.com/docs?hl=zh-cn</a></li>\n<li><a href=\"https://weread.qq.com/web/reader/73532150723f022f73516a6kc81322c012c81e728d9d180\">ã€Šç¬¬ä¸€è¡Œä»£ç ï¼šAndroidã€‹(ç¬¬ä¸‰ç‰ˆ)</a></li>\n<li><a href=\"https://capacitorjs.com/\">https://capacitorjs.com/</a></li>\n</ol>\n",
        "title": "ç½‘é¡µæ‰“åŒ…å®‰å“åº”ç”¨ï¼Œå®ç°æµç¨‹è‡ªåŠ¨åŒ–",
        "created": "2022-06-18 13:04:22  ",
        "updated": "2022-06-18 13:04:22 ",
        "excerpt": "ä¸€. ä¸šåŠ¡èƒŒæ™¯ éƒ¨é—¨çš„ä¸šåŠ¡ä¸»è¦æ˜¯è¥é”€ç‰©æ–™çš„ç”Ÿäº§ï¼Œå¯ä»¥åˆ†å‘åˆ°ä¸åŒç»ˆç«¯ã€‚æ‰‹æœºå¯ä»¥åœ¨H5ï¼Œå°ç¨‹åºå±•ç¤ºï¼ŒPCå¯ä»¥æ‰“åŒ…æˆ electronåº”ç”¨ï¼Œä½†æ˜¯ç›®å‰åœ¨å®‰å“åº”ç”¨ä¸Šæ˜¯ç©ºç¼ºçš„ã€‚å› æ­¤éœ€è¦æä¾›ç”¨æˆ·å¯ä»¥å°†åˆ¶ä½œçš„ç‰©æ–™ç›´æ¥æ‰“åŒ…æˆå®‰å“åº”ç”¨çš„èƒ½åŠ›ã€‚ äºŒ.æŠ€æœ¯é€‰å‹ åœ¨...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "13"
    },
    "14": {
        "content": "<h1 id=\"ä¸€-å†™åœ¨å‰é¢\">ä¸€. å†™åœ¨å‰é¢</h1>\n<p>ä½œä¸ºå‰ç«¯å¼€å‘ï¼Œ<code>Vue</code> æ˜¯æˆ‘æ—¥å¸¸å·¥ä½œä¸­ä½¿ç”¨æœ€å¤šçš„æ¡†æ¶ï¼Œå„ç§ç‰¹æ€§æˆ‘éƒ½æœ‰è¿›è¡Œäº†è§£ã€‚ä½†æ˜¯å¯¹äºæ¡†æ¶åº•å±‚çš„åŸç†å´çŸ¥ä¹‹ç”šå°‘ï¼ŒçŸ¥é“æ•°æ®åŠ«æŒï¼Œä½†æ˜¯ä¸çŸ¥é“ä¾èµ–æ”¶é›†çš„å…·ä½“è¿‡ç¨‹ã€‚çŸ¥é“ <code>diff</code> ç®—æ³•ï¼Œä½†å¯¹ <code>Vue</code> æ‰€åšçš„ç®—æ³•ä¼˜åŒ–ä¸äº†è§£ã€‚ä¸€å…¥é—¨å°±å­¦ä¹ äº† <code>Vue</code> çš„ç”Ÿå‘½å‘¨æœŸï¼Œå´ä¸äº†è§£ç»„ä»¶å®ä¾‹åŒ–çš„æ•´ä¸ªè¿‡ç¨‹ã€‚</p>\n<p>æ€»çš„æ¥è¯´å°±æ˜¯ä¼¼æ‡‚éæ‡‚ï¼Œéƒ½çŸ¥é“ä¸€äº›ï¼Œéƒ½ä¸æ·±å…¥ã€‚å› æ­¤å­¦ä¹ æºç ï¼Œäº†è§£ <code>Vue</code> çš„æ•´ä½“è®¾è®¡æ˜¯æˆ‘çš„ä¸»è¦ç›®æ ‡ã€‚ä¹Ÿå¸Œæœ›é€šè¿‡ <code>Vue</code> æºç çš„å­¦ä¹ èƒ½è®©æˆ‘åœ¨å·¥ä½œä¸­ä½¿ç”¨ <code>Vue</code> æ›´åŠ çš„å¾—å¿ƒåº”æ‰‹ã€‚</p>\n<h1 id=\"äºŒ-åŸºæœ¬ä»‹ç»\">äºŒ. åŸºæœ¬ä»‹ç»</h1>\n<p><code>Vue</code> çš„æºç è®¾è®¡çš„ä¸œè¥¿å¤ªå¤šäº†ï¼Œæˆ‘å†³å®šæ‹†åˆ†æˆä¸åŒéƒ¨åˆ†å»é˜…è¯»ï¼Œå¸¦æœ‰ç›®çš„å»äº†è§£ã€‚</p>\n<ul>\n<li>æºç åœ°å€ï¼š <a href=\"https://github.com/vuejs/vue\">https://github.com/vuejs/vue</a></li>\n<li>åˆ†æ”¯ï¼š main</li>\n<li>ç‰ˆæœ¬ï¼š v2.7.0</li>\n</ul>\n<p>è¿™é‡Œé€‰æ‹©äº†å½“å‰(2022-06)æœ€æ–°ç‰ˆæœ¬çš„ä»£ç ï¼Œå½“å‰ç‰ˆæœ¬çš„ä»£ç å·²ç»å…¨éƒ¨ä½¿ç”¨ <code>TypeScript</code> è¿›è¡Œé‡å†™ï¼Œèˆå¼ƒäº†ä¹‹å‰çš„ <code>flow</code> æ ‡æ³¨ï¼Œé˜…è¯»ä½“éªŒè¿˜æ˜¯æ¯”è¾ƒå¥½çš„ã€‚</p>\n<p><code>Vue</code> çš„ä»£ç åœ¨ <code>src</code> ç›®å½•ä¸‹ï¼Œç›®å½•ç»“æ„ä¸º</p>\n<pre><code>src\nâ”œâ”€â”€ compiler        # ç¼–è¯‘ç›¸å…³ \nâ”œâ”€â”€ core            # æ ¸å¿ƒä»£ç  \nâ”œâ”€â”€ platforms       # å¤šå¹³å°æ”¯æŒ\nâ”œâ”€â”€ server          # æœåŠ¡ç«¯\nâ”œâ”€â”€ types           # ç±»å‹å£°æ˜\nâ”œâ”€â”€ shared          # å…±äº«å·¥å…·æ–¹æ³•\nâ”œâ”€â”€ v3              # v3çš„ç‰¹æ€§\n</code></pre>\n<p>çœ‹æºç çš„é¡ºåºä¸€èˆ¬ä»å…¥å£æ–‡ä»¶å¼€å§‹ï¼Œ<code>Vue</code> ä½œä¸ºåº“ï¼Œå…¥å£æ–‡ä»¶æ˜¯å®ƒçš„æ„å»ºäº§ç‰©ï¼Œå› æ­¤æˆ‘ä»¬ä»æ‰“åŒ…å‘½ä»¤ä¸­å…¥æ‰‹ã€‚</p>\n<pre><code class=\"language-shell\">&quot;build&quot;: &quot;node scripts/build.js&quot;,\n</code></pre>\n<p>äºæ˜¯æ‰¾åˆ° <code>scripts/build.js</code> æ–‡ä»¶ï¼Œç„¶åæ‰¾åˆ°é…ç½®æ–‡ä»¶ <code>scripts/config.js</code></p>\n<pre><code class=\"language-js\">const builds = {\n    // Runtime only (CommonJS). Used by bundlers e.g. Webpack &amp; Browserify\n    &#39;runtime-cjs-dev&#39;: {\n        entry: resolve(&#39;web/entry-runtime.ts&#39;),\n        dest: resolve(&#39;dist/vue.runtime.common.dev.js&#39;),\n        format: &#39;cjs&#39;,\n        env: &#39;development&#39;,\n        banner\n    },\n    &#39;runtime-cjs-prod&#39;: {\n        entry: resolve(&#39;web/entry-runtime.ts&#39;),\n        dest: resolve(&#39;dist/vue.runtime.common.prod.js&#39;),\n        format: &#39;cjs&#39;,\n        env: &#39;production&#39;,\n        ...\n</code></pre>\n<p>ä»ä¸Šé¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>Vue</code> åœ¨æ‰“åŒ…æ˜¯æ„å»ºæˆä¸åŒçš„ç‰ˆæœ¬ï¼Œæœ‰æ”¯æŒ <code>CommonJS</code> è§„èŒƒ <code>cjs</code>,\nä¹Ÿæœ‰æ”¯æŒ <code>ESM</code> çš„ <code>esm</code>, ä¹Ÿæœ‰å…¼å®¹å¤šæ ¼å¼çš„ <code>UMD</code>ã€‚å…¶ä¸­æœ‰å¸¦ <code>complier</code> çš„ç‰ˆæœ¬ï¼Œä¹Ÿæœ‰ <code>runtime-only</code> çš„ç‰ˆæœ¬ã€‚</p>\n<h1 id=\"ä¸‰-å…¥å£æ–‡ä»¶\">ä¸‰. å…¥å£æ–‡ä»¶</h1>\n<p>ä»é…ç½®æ–‡ä»¶ä¸­æœ‰æ‰¾åˆ° åˆ«åçš„å£°æ˜æ–‡ä»¶ <code>scripts/alias </code></p>\n<pre><code class=\"language-js\">{\n    vue: resolve(&#39;src/platforms/web/entry-runtime-with-compiler&#39;),\n}\n</code></pre>\n<p>ä¹Ÿæœ‰å¾ˆå¤šçš„æ„å»ºç‰ˆæœ¬ä»¥è¯¥æ–‡ä»¶ä½œä¸ºå…¥å£æ–‡ä»¶ï¼Œå› æ­¤ä» <code>src/platforms/web/entry-runtime-with-compiler.ts</code>å¼€å§‹å…¥æ‰‹ã€‚</p>\n<pre><code class=\"language-ts\">import Vue from &#39;./runtime-with-compiler&#39;\nimport * as vca from &#39;v3&#39;\nimport { extend } from &#39;shared/util&#39;\nextend(Vue, vca)\nimport { effect } from &#39;v3/reactivity/effect&#39;\nVue.effect = effect\n\nexport default Vue\n</code></pre>\n<p>å¿½ç•¥æ–°å¢çš„ <code>v3</code> çš„åŠŸèƒ½ä»£ç ï¼Œè¿›å…¥ <code>./runtime-with-compiler</code>æ–‡ä»¶</p>\n<pre><code class=\"language-ts\">const mount = Vue.prototype.$mount\nVue.prototype.$mount = function () {\n    const { render, staticRenderFns } = compileToFunctions(...)\n    options.render = render\n    options.staticRenderFns = staticRenderFns\n}\n</code></pre>\n<p>è¿™ä¸ªæ–‡ä»¶çš„ä»£ç å¾ˆå¤šï¼Œä½†æ˜¯æ ¸å¿ƒé€»è¾‘å°±æ˜¯å¼•å…¥äº† <code>compileToFunctions</code> æ–¹æ³•, æ‰©å±•äº† <code>$mount</code> æ–¹æ³•ï¼Œæ”¯æŒå°† <code>options</code> çš„ <code>template</code> è½¬åŒ–ä¸º <code>render</code> å‡½æ•°ã€‚æ ¹æ®å¯¼å…¥ä¸€ç›´å¯»æ‰¾ï¼Œæˆ‘ä»¬æœ€ç»ˆæ¥åˆ°äº†<code>src/core/index.ts</code></p>\n<pre><code class=\"language-ts\">import Vue from &#39;./instance/index&#39;\ninitGlobalAPI(Vue) // åˆå§‹åŒ–å…¨å±€Api\n</code></pre>\n<p>ç„¶ååœ¨ <code>instance/index</code>æ–‡ä»¶</p>\n<pre><code class=\"language-ts\">function Vue(options) {\n    if (__DEV__ &amp;&amp; !(this instanceof Vue)) {\n        warn(&#39;Vue is a constructor and should be called with the `new` keyword&#39;)\n    }\n    this._init(options)\n}\ninitMixin(Vue)\nstateMixin(Vue)\neventsMixin(Vue)\nlifecycleMixin(Vue)\nrenderMixin(Vue)\n</code></pre>\n<p>åœ¨è¿™é‡Œæˆ‘ä»¬çŸ¥é“ï¼Œ<code>Vue</code> å°±æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œåªèƒ½é€šè¿‡ <code>new Vue</code> è¿›è¡Œå®ä¾‹åŒ–ï¼Œç„¶åé€šè¿‡ä¸åŒå‡½æ•°å¯¹ <code>prototype</code> è¿›è¡Œæ‰©å±•å®ç°åŠŸèƒ½æ¨¡å—åŒ–ï¼Œ</p>\n<h1 id=\"å››-æ€»ç»“\">å››. æ€»ç»“</h1>\n<p>Vue çš„æ•´ä½“é€»è¾‘è¿‡äºåºå¤§ï¼Œæ¶‰åŠåˆ°ç»„ä»¶åŒ–, å“åº”å¼åŸç†ï¼Œç¼–è¯‘ç­‰è¯¸å¤šé€»è¾‘ã€‚å› æ­¤æˆ‘ä¼šä»ä¸åŒçš„éƒ¨åˆ†å»é˜…è¯»å’Œè§£ææºç ã€‚</p>\n<p>æ–‡ç« é“¾æ¥ï¼šTODO</p>\n",
        "title": "Vue æºç å­¦ä¹  (1) - èµ·å§‹ç¯‡",
        "created": "2022-06-26 11:28:17  ",
        "updated": "2022-06-26 11:28:17 ",
        "excerpt": "ä¸€. å†™åœ¨å‰é¢ ä½œä¸ºå‰ç«¯å¼€å‘ï¼ŒVue æ˜¯æˆ‘æ—¥å¸¸å·¥ä½œä¸­ä½¿ç”¨æœ€å¤šçš„æ¡†æ¶ï¼Œå„ç§ç‰¹æ€§æˆ‘éƒ½æœ‰è¿›è¡Œäº†è§£ã€‚ä½†æ˜¯å¯¹äºæ¡†æ¶åº•å±‚çš„åŸç†å´çŸ¥ä¹‹ç”šå°‘ï¼ŒçŸ¥é“æ•°æ®åŠ«æŒï¼Œä½†æ˜¯ä¸çŸ¥é“ä¾èµ–æ”¶é›†çš„å…·ä½“è¿‡ç¨‹ã€‚çŸ¥é“ diff ç®—æ³•ï¼Œä½†å¯¹ Vue æ‰€åšçš„ç®—æ³•ä¼˜åŒ–ä¸äº†è§£ã€‚ä¸€å…¥é—¨å°±å­¦ä¹ ...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "14"
    },
    "15": {
        "content": "<h1 id=\"_init\">_init</h1>\n<p>å½“æˆ‘ä»¬ä½¿ç”¨ <code>Vue 2</code> æ—¶ï¼Œæˆ‘ä»¬ä¼šç”¨ <code>Vue</code> å®ä¾‹åŒ–ä¸€ä¸ªåº”ç”¨</p>\n<pre><code class=\"language-ts\">const app = new Vue({\n    render: h =&gt; h(App)\n}).$mount(&#39;#app&#39;)\n</code></pre>\n<p> <code>Vue</code>  æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå®ä¾‹åŒ–æ—¶ä¼šè°ƒç”¨ <code>this._init(options)</code> æ–¹æ³•.</p>\n<pre><code class=\"language-ts\">function Vue(options) {\n    this._init(options)\n}\n</code></pre>\n<p>æ‰¾åˆ° <code>core/instance/init.ts</code>æ–‡ä»¶ä¸­ï¼Œ<code>initMixin</code>å‡½æ•°æ‰§è¡Œæ—¶æŒ‚è½½äº† <code>_init</code>æ–¹æ³•</p>\n<pre><code class=\"language-ts\">Vue.prototype._init = function (options?: Record&lt;string, any&gt;) {\nconst vm: Component = this\n    // a uid\n    vm._uid = uid++\n    if (options &amp;&amp; options._isComponent) {\n        initInternalComponent(vm, options as any)\n    } else {\n        vm.$options = mergeOptions(\n        resolveConstructorOptions(vm.constructor as any),\n        options || {},\n        vm\n        )\n    }\n    initLifecycle(vm)\n    initEvents(vm)\n    initRender(vm)\n    callHook(vm, &#39;beforeCreate&#39;)\n    initInjections(vm) \n    initState(vm)\n    initProvide(vm) \n    callHook(vm, &#39;created&#39;)\n\n    if (vm.$options.el) {\n        vm.$mount(vm.$options.el)\n    }\n}\n</code></pre>\n<p>è¿™é‡Œçš„é€»è¾‘æˆ‘å¤§è‡´è®²ä¸€ä¸‹ï¼Œ</p>\n<ol>\n<li><code>uid</code> é€’å¢</li>\n<li>å¾€å®ä¾‹ä¸ŠåŠ ä¸€äº›å±æ€§æ ‡è¯†</li>\n<li><code>$options</code> åˆå§‹åŒ–ï¼Œåˆå¹¶ <code>extend</code>, <code>mixin</code> ç­‰</li>\n<li>åˆå§‹åŒ–å£°æ˜å‘¨æœŸï¼Œåˆå§‹åŒ– <code>render</code></li>\n<li><code>beforeCreate</code></li>\n<li>åˆå§‹åŒ– <code>inject</code></li>\n<li>åˆå§‹åŒ– <code>props</code> -&gt; <code>methods</code> -&gt; <code>data</code> -&gt; <code>computed</code> -&gt; <code>watch</code></li>\n<li>åˆå§‹åŒ– <code>provide</code></li>\n<li><code>created</code></li>\n<li>å¼€å§‹ <code>$mount</code></li>\n</ol>\n<h1 id=\"mount\">$mount</h1>\n<p>ä¸Šé¢çš„æµç¨‹å¤§è‡´è¿‡ä¸‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ <code>$mount</code> æ‰§è¡Œçš„è¿‡ç¨‹ã€‚</p>\n<p>åœ¨ <code>web/runtime-with-compiler.ts</code>ä¸­æˆ‘ä»¬è®²è¿‡ï¼Œè¿™é‡Œå°† <code>compileToFunctions</code> å‡½æ•°å¼•å…¥è¿›æ¥ï¼Œç”¨äºè®² <code>template</code> è½¬åŒ–æˆ <code>render</code> å‡½æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬ä¹Ÿè®²ä¸€ä¸‹è¯¦ç»†çš„é€»è¾‘</p>\n<pre><code class=\"language-ts\">// ä¸èƒ½æŒ‚åœ¨åˆ° html æˆ–è€… body ä¸‹\nif (el === document.body || el === document.documentElement)\n    return \nif (!options.render) {\n    // å¦‚æœtemplateå­˜åœ¨\n        // å­—ç¬¦ä¸² \n            // ç›´æ¥è§£æ\n            // é€šè¿‡id è·å–å…ƒç´ ï¼Œç„¶åè·å–innerHTML\n        // å…ƒç´  è·å– innerHTML\n    // å¦‚æœtemplet ä¸å­˜åœ¨ ï¼Œel å­˜åœ¨ è·å– outerHTML\n    \n    // æ‰§è¡ŒcompileToFunctions å¾—åˆ°render\n    \n    // æ‰§è¡Œç¼“å­˜çš„åŸæ–¹æ³•\n    return mount.call(this, el, hydrating)\n}\n</code></pre>\n<p>æ¥åˆ° <code>web/runtime/index.ts</code>ï¼Œ è¿™é‡Œå°±æ˜¯ <code>runtime</code> æ—¶<code> $mount</code> æ–¹æ³•</p>\n<pre><code class=\"language-ts\">Vue.prototype.$mount = function (\n    el?: string | Element,\n    hydrating?: boolean\n\n    ): Component {\n    el = el &amp;&amp; inBrowser ? query(el) : undefined\n    return mountComponent(this, el, hydrating)\n}\n</code></pre>\n<p>è¿™é‡Œè°ƒç”¨äº† <code>core/instance/lifecycle</code>çš„ <code>mountComponent</code> æ–¹æ³•</p>\n<pre><code class=\"language-ts\">export function mountComponent(\nvm: Component,\nel: Element | null | undefined,\nhydrating?: boolean\n): Component {\n    // å£°æ˜ $elï¼Œæ£€æŸ¥render\n    vm.$el = el\n    if (!vm.$options.render) {\n        vm.$options.render = createEmptyVNode\n    }\n    \n    callHook(vm, &#39;beforeMount&#39;)\n    \n    let updateComponent = () =&gt; {\n        vm._update(vm._render(), hydrating)\n    }\n    const watcherOptions: WatcherOptions = {\n        before() {\n            if (vm._isMounted &amp;&amp; !vm._isDestroyed) {\n                callHook(vm, &#39;beforeUpdate&#39;)\n            }\n        }\n    }\n\n    new Watcher(\n        vm,\n        updateComponent,\n        noop,\n        watcherOptions,\n        true /* isRenderWatcher */\n    )\n    if (vm.$vnode == null) {\n        const preWatchers = vm._preWatchers\n        if (preWatchers) {\n            for (let i = 0; i &lt; preWatchers.length; i++) {\n                preWatchers[i].run()\n            }\n        }\n        vm._isMounted = true\n        callHook(vm, &#39;mounted&#39;)\n    }\n\n    return vm\n\n}\n</code></pre>\n<p>è¿™é‡Œå®ä¾‹åŒ–äº†ä¸€ä¸ª æ¸²æŸ“çš„ <code>Watcher</code>, åœ¨å®ƒçš„å›è°ƒä¸­ä¼šè°ƒç”¨ <code>updateComponent</code> æ–¹æ³•ï¼Œæ‰§è¡Œ <code>_render</code>ï¼Œ<code>_update</code> æ›´æ–° <code>DOM</code></p>\n<p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªåˆ¤æ–­ <code>vm.$node === null</code>, è¿™é‡Œ <code>$node</code> è¡¨ç¤ºçˆ¶ <code>vnode</code>ï¼Œä¸º <code>null</code> åˆ™è¡¨ç¤ºä¸ºæ ¹ç»“ç‚¹çš„å®ä¾‹.</p>\n<p>Watcher æˆ‘ä»¬å…ˆä¸çœ‹ï¼Œè¿™ä¸»è¦æ˜¯å“åº”å¼åŸç†å’Œä¾èµ–æ”¶é›†ç›¸å…³çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬ç»§ç»­çœ‹ <code>_render</code> , <code>_update</code> æ–¹æ³•çš„é€»è¾‘.</p>\n<h1 id=\"_render\">_render</h1>\n<p>åœ¨ <code>instance/render.ts</code>ä¸­ï¼Œ<code>renderMixin</code> å‡½æ•°æ³¨å†Œäº† <code>_render</code> æ–¹æ³•.</p>\n<pre><code class=\"language-ts\">Vue.prototype._render = function (): VNode {\n    const vm: Component = this\n    const { render, _parentVnode } = vm.$options\n\n    vm.$vnode = _parentVnode!\n    let vnode = render.call(vm._renderProxy, vm.$createElement)\n    \n    // set parent\n    vnode.parent = _parentVnode\n    return vnode\n}\n</code></pre>\n<p><code>_render</code> å‡½æ•°è°ƒç”¨ <code>render</code> ç”Ÿæˆ <code>vnode</code> è¿›è¡Œè¿”å›</p>\n<p>å¹³æ—¶æˆ‘ä»¬ä½¿ç”¨ <code>render</code> å‡½æ•°æ—¶æ˜¯è¿™ä¹ˆå†™çš„ï¼š</p>\n<pre><code class=\"language-js\">render: h =&gt; h(&#39;div&#39;, {}, &#39;&#39;)\n</code></pre>\n<p>è¿™é‡Œçš„ <code>h</code> å°±å¯¹åº”äº† <code>vm.$reateElement</code>, è€Œ <code>renderProxy</code> å°±æ˜¯å“åº”å¼çš„æ•°æ®</p>\n<p>å…¶ä¸­ <code>vm.$createElement</code> åœ¨ <code>initRender</code> æ—¶è¿›è¡Œäº†æ³¨å†Œï¼Œå®é™…ä¸Šä¹Ÿæ˜¯å¯¹ <code>createElement</code> æ–¹æ³•è¿›è¡Œäº†å°è£…ã€‚</p>\n<h1 id=\"createelement\">createElement</h1>\n<p>åœ¨ <code>core/vdom/create-element.ts</code>ä¸­å®šä¹‰äº† <code>createElement</code> å‡½æ•°ï¼Œè¯¥å‡½æ•°æ˜¯å¯¹ <code>_createElement</code> çš„å°è£…ï¼Œè®©å‚æ•°æ›´åŠ çµæ´»</p>\n<pre><code class=\"language-ts\">export function _createElement(\n    context: Component,\n    tag?: string | Component | Function | Object,\n    data?: VNodeData,\n    children?: any,\n    normalizationType?: number\n): VNode | Array&lt;VNode&gt; {\n\n    // å¤„ç† :is\n    if (isDef(data) &amp;&amp; isDef(data.is)) {\n        tag = data.is\n    }\n\n    if (normalizationType === ALWAYS_NORMALIZE) {\n        children = normalizeChildren(children)\n    } else if (normalizationType === SIMPLE_NORMALIZE) {\n        children = simpleNormalizeChildren(children)\n    }\n\n    let vnode, ns\n    if (typeof tag === &#39;string&#39;) {\n        let Ctor\n        if (config.isReservedTag(tag)) {\n            vnode = new VNode(\n                config.parsePlatformTagName(tag),\n                data,\n                children,\n                undefined,\n                undefined,\n                context\n            )\n\n        } else if (...) {\n            vnode = createComponent(Ctor, data, context, children, tag)\n        } else {\n            vnode = new VNode(tag, data, children, undefined, undefined, context)\n\n        }\n    } else {\n        // direct component options / constructor\n        vnode = createComponent(tag as any, data, context, children)\n    }\n\n    return vnode\n}\n</code></pre>\n<p>è¿™é‡Œä¸»è¦æ‰§è¡Œçš„é€»è¾‘æ˜¯ï¼Œå…ˆå°† <code>children</code> è§„èŒƒä¸º <code>VNode</code> æ•°ç»„ï¼Œ<code>normalizationType</code> æ ‡è¯†è§„èŒƒç±»å‹ã€‚</p>\n<p>ç„¶ååˆ›å»º <code>VNode</code>, å¯¹ <code>tag</code> è¿›è¡Œåˆ¤æ–­,</p>\n<ul>\n<li>. å¦‚æœæ˜¯ <code>tag</code> æ˜¯ <code>string</code> ç±»å‹<ul>\n<li>. å†…ç½® <code>HTML</code> å…ƒç´ çš„è¯ï¼Œç›´æ¥åˆ›å»ºæ™®é€š <code>node</code></li>\n<li>. å·²ç»æ³¨å†Œè¿‡çš„ç»„ä»¶åï¼Œåˆ™ä½¿ç”¨ <code>createComponent</code> åˆ›å»ºç»„ä»¶ <code>VNode</code></li>\n<li>. åˆ›å»ºæœªçŸ¥æ ‡ç­¾çš„ <code>vnode</code></li>\n</ul>\n</li>\n<li>. å¦‚æœæ˜¯ <code>component</code> ç±»å‹ï¼Œç›´æ¥åˆ›å»º <code>component</code> ç»„ä»¶ <code>VNode</code></li>\n</ul>\n<p>åˆ°è¿™é‡Œæˆ‘ä»¬å¤§è‡´è®²å®Œäº† <code>createElement</code> çš„é€»è¾‘äº†ã€‚</p>\n<h1 id=\"update\">update</h1>\n<p>åœ¨ <code>mountComponent</code>æ–¹æ³•ä¸­ï¼Œ<code>_render</code>æ‰§è¡Œå®Œæˆåï¼Œä¼šæ‰§è¡Œ<code>_update</code> æ–¹æ³•</p>\n<pre><code class=\"language-ts\">vm._update(vm._render(), hydrating)\n</code></pre>\n<p>æŸ¥çœ‹ <code>_update</code> æ–¹æ³•</p>\n<pre><code class=\"language-ts\">Vue.prototype._update = function (vnode: VNode, hydrating?: boolean) {\n    const vm: Component = this\n    const prevEl = vm.$el\n    const prevVnode = vm._vnode\n    const restoreActiveInstance = setActiveInstance(vm)\n    vm._vnode = vnode\n\n\n    if (!prevVnode) {\n        // initial render\n        vm.$el = vm.__patch__(vm.$el, vnode, hydrating, false)\n    } else {\n        vm.$el = vm.__patch__(prevVnode, vnode)\n    }\n\n    restoreActiveInstance()\n\n    // update __vue__ reference\n    if (prevEl) {\n    prevEl.__vue__ = null\n    }\n    if (vm.$el) {\n    vm.$el.__vue__ = vm\n    }\n\n    // if parent is an HOC, update its $el as well\n    if (vm.$vnode &amp;&amp; vm.$parent &amp;&amp; vm.$vnode === vm.$parent._vnode) {\n        vm.$parent.$el = vm.$el\n    }\n\n}\n</code></pre>\n<p>è¿™é‡Œçš„æ ¸å¿ƒé€»è¾‘æ˜¯ <code>__patch__</code> æ–¹æ³•. ç”±äº <code>Vue</code> ä¸åªé¢å‘ <code>web</code> å¹³å°ï¼Œ ä¹Ÿä¼šå¤„ç†å…¶ä»–å¹³å°çš„é€»è¾‘ï¼Œä¾‹å¦‚<strong>æ­»å»çš„</strong> <code>Weex</code>. è€Œä¸”åœ¨ <code>Vue SSR</code> æ—¶ï¼Œä¹Ÿæ˜¯ä¸éœ€è¦ <code>patchçš„</code>ã€‚è¿™é‡Œæˆ‘ä»¬çœ‹ <code>web</code> <code>ç«¯çš„patch</code> æ–¹æ³•ã€‚</p>\n<pre><code class=\"language-ts\">\nfunction createPatchFunction({ nodeOps, modules }) {\n    return function patch(oldVnode, vnode, hydrating, removeOnly) {\n\n    let isInitialPatch = false\n    const insertedVnodeQueue: any[] = []\n\n    if (isUndef(oldVnode)) {\n        isInitialPatch = true\n        createElm(vnode, insertedVnodeQueue)\n    } else {\n        const isRealElement = isDef(oldVnode.nodeType)\n        oldVnode = emptyNodeAt(oldVnode)\n        // replacing existing element\n        const oldElm = oldVnode.elm\n        const parentElm = nodeOps.parentNode(oldElm)\n        // create new node\n        createElm(\n            vnode,\n            insertedVnodeQueue,\n            oldElm._leaveCb ? null : parentElm,\n            nodeOps.nextSibling(oldElm)\n        )\n\n        // update parent placeholder node element, recursively\n        if (isDef(vnode.parent)) {\n            let ancestor = vnode.parent\n            const patchable = isPatchable(vnode)\n            while (ancestor) {\n                for (let i = 0; i &lt; cbs.destroy.length; ++i) {\n                    cbs.destroy[i](ancestor)\n                }\n                ancestor.elm = vnode.elm\n\n                if (patchable) {\n                    for (let i = 0; i &lt; cbs.create.length; ++i) {\n                        cbs.create[i](emptyNode, ancestor)\n                    }\n\n                    const insert = ancestor.data.hook.insert\n                    if (insert.merged) {\n                        for (let i = 1; i &lt; insert.fns.length; i++) {\n                            insert.fns[i]()\n                        }\n                    }\n                } else {\n                    registerRef(ancestor)\n                }\n            ancestor = ancestor.parent\n            }\n        }\n\n        if (isDef(parentElm)) {\n            removeVnodes([oldVnode], 0, 0)\n        } else if (isDef(oldVnode.tag)) {\n            invokeDestroyHook(oldVnode)\n        }\n\n        invokeInsertHook(vnode, insertedVnodeQueue, isInitialPatch)\n        return vnode.elm\n    }\n}\n</code></pre>\n<p>è¿™é‡Œä¸»è¦é€šè¿‡ <code>cretateElem</code> åˆ›å»ºå…ƒç´ </p>\n<pre><code class=\"language-ts\">if (isDef(vnode.elm) &amp;&amp; isDef(ownerArray)) {\n    vnode = ownerArray[index] = cloneVNode(vnode)\n}\n\nconst data = vnode.data\nconst children = vnode.children\nconst tag = vnode.tag\nif (isDef(tag)) {\n    vnode.elm = vnode.ns\n    ? nodeOps.createElementNS(vnode.ns, tag)\n    : nodeOps.createElement(tag, vnode)\n    \n    setScope(vnode)\n    createChildren(vnode, children, insertedVnodeQueue)\n    if (isDef(data)) {\n        invokeCreateHooks(vnode, insertedVnodeQueue)\n    }\n    insert(parentElm, vnode.elm, refElm)\n\n} else if (isTrue(vnode.isComment)) {\n    vnode.elm = nodeOps.createComment(vnode.text)\n    insert(parentElm, vnode.elm, refElm)\n} else {\n    vnode.elm = nodeOps.createTextNode(vnode.text)\n    insert(parentElm, vnode.elm, refElm)\n\n}\n</code></pre>\n<p>è¿™é‡Œçš„é€»è¾‘å°±æ˜¯é€šè¿‡ <code>VNode</code> åˆ›å»ºæ­£å¼çš„ <code>DOM</code> ç„¶åæ’å…¥åˆ°å®ƒçš„çˆ¶èŠ‚ç‚¹ä¸­ã€‚</p>\n<p>è¿™é‡Œå…ˆåˆ›å»º <code>elm</code> å…ƒç´ ï¼Œç„¶ååˆ›å»º <code>children</code>ï¼Œéå†å­èŠ‚ç‚¹ï¼Œé€’å½’è°ƒç”¨ <code>createElm</code>, ç„¶åè°ƒç”¨ <code>invokeCreateHook</code>ã€‚</p>\n<p>æœ€åè°ƒç”¨ <code>insert</code> æ–¹æ³•æ’å…¥åˆ° çˆ¶èŠ‚ç‚¹ï¼Œæ‰€ä»¥æ’å…¥èŠ‚ç‚¹çš„é¡ºåºæ˜¯ å­&gt;çˆ¶ çš„ã€‚</p>\n<h1 id=\"æ€»ç»“\">æ€»ç»“</h1>\n<p>æœ€åå›é¡¾ä¸‹æ•´ä¸ª Vue åˆå§‹åŒ–çš„æµç¨‹ï¼š</p>\n<ol>\n<li><code>init</code> åˆå§‹åŒ–å£°æ˜å‘¨æœŸï¼Œæ•°æ®</li>\n<li><code>$mount</code> å¼€å§‹æŒ‚è½½</li>\n<li><code>compile  template to render fn</code></li>\n<li><code>render</code> ç”Ÿæˆ <code>VNode</code></li>\n<li><code>patch VNode</code>  åˆ° <code>DOM</code> ä¸Š</li>\n</ol>\n<p>ä» <code>patch</code> çš„è¿‡ç¨‹æˆ‘ä»¬ä¹ŸçŸ¥é“äº†ä» è™šæ‹ŸèŠ‚ç‚¹ åˆ° DOM çš„ä¸€ä¸ªç”Ÿæˆé€»è¾‘ï¼Œæ‰€ä»¥æœ‰ä¸€ä¸ªå¸¸è§çš„é¢è¯•é¢˜ï¼Œå°±æ˜¯çˆ¶å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆç°åœ¨å°±å¾ˆç®€å•äº†</p>\n<pre><code>çˆ¶äº²ï¼šF  å­ç»„ä»¶ï¼š C\n\nF beforeCreate -&gt; created -&gt; beforeMount -&gt; C beforeCreate -&gt; created -&gt; beforeMount -&gt; Mounted -&gt; F Mounted\n</code></pre>\n<p>ä¸Šé¢æˆ‘ä»¬å¤§è‡´è®²äº†ä¸‹ <code>patch</code> çš„è¿‡ç¨‹ï¼Œå¾ˆå¤šå…³äº æ–°æ—§èŠ‚ç‚¹çš„æ¯”è¾ƒé€»è¾‘ï¼Œdiff ç®—æ³•ä¼˜åŒ–å¹¶æ²¡æœ‰ç»†èŠã€‚åç»­ä¼šæœ‰æ–‡ç« , æˆ‘ä»¬æ¥ç€èŠã€‚</p>\n",
        "title": "Vue æºç å­¦ä¹  (2) - Vue åˆå§‹åŒ–",
        "created": "2022-06-26 11:36:24  ",
        "updated": "2022-07-03 16:39:06 ",
        "excerpt": "_init å½“æˆ‘ä»¬ä½¿ç”¨ Vue 2 æ—¶ï¼Œæˆ‘ä»¬ä¼šç”¨ Vue å®ä¾‹åŒ–ä¸€ä¸ªåº”ç”¨ `ts const app = new Vue({ render: h => h(App) }).$mount('#app') ` Vue æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå®ä¾‹åŒ–æ—¶ä¼š...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "15"
    },
    "16": {
        "content": "<h1 id=\"ä¸€-ä¸šåŠ¡èƒŒæ™¯\">ä¸€. ä¸šåŠ¡èƒŒæ™¯</h1>\n<p>éƒ¨é—¨å®˜ç½‘å’Œä¸»åº”ç”¨æ˜¯ä¸€ä¸ª <code>SPA</code> çš„æœåŠ¡ã€‚ç”±äºä¸šåŠ¡æ‰©å±•ï¼Œå¸Œæœ›èƒ½å¤Ÿè¢«æœç´¢å¼•æ“æ”¶å½•åˆ°ï¼Œæ‰€ä»¥å®˜ç½‘éœ€è¦åš <code>SEO</code>ã€‚</p>\n<h1 id=\"äºŒ-æŠ€æœ¯é€‰å‹\">äºŒ. æŠ€æœ¯é€‰å‹</h1>\n<p>ç”±äºç›´æ¥åœ¨åŸä¸»åº”ç”¨ä¸Šåš <code>SSR</code>ï¼Œæ”¹åŠ¨æˆæœ¬å¤ªå¤§ï¼Œå†³å®šç›´æ¥ä½¿ç”¨ç°æˆçš„ <code>SSR</code> æ¡†æ¶ã€‚</p>\n<p><code>Next.js</code> ä¸ <code>Nuxt</code> éƒ½æ˜¯å‰ç«¯æ¯”è¾ƒæµè¡Œçš„ <code>SSR</code> æ¡†æ¶ï¼Œä¸”éƒ½æ”¯æŒ <code>SSG</code>.ã€‚åŠ ä¸Šæ—§ä»£ç æ˜¯ <code>Vue</code> å†™çš„ï¼Œç›´æ¥è¿ç§»åˆ° <code>Nuxt</code> æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ï¼Œå› æ­¤æœ€ç»ˆé€‰æ‹©äº† <code>Nuxt</code>.</p>\n<p><code>SSR</code> å’Œ <code>SSG</code> éƒ½èƒ½å¤Ÿèµ·åˆ° <code>SEO</code>  çš„ä½œç”¨ï¼Œä½†æ˜¯ <code>SSR</code> éœ€è¦åœ¨æœåŠ¡å™¨ç‰¹æ„å¯åŠ¨ <code>node</code> æœåŠ¡ï¼Œè€Œ <code>SSG</code> åªéœ€è¦éƒ¨ç½²åœ¨ nginx ä»£ç†çš„ç›®å½•ä¸‹å³å¯ã€‚</p>\n<p>å› æ­¤æœ€ç»ˆé€‰å‹ï¼š <code>Nuxt</code> + <code>SSG</code></p>\n<h1 id=\"ä¸‰-å¼€å‘è¿‡ç¨‹\">ä¸‰. å¼€å‘è¿‡ç¨‹</h1>\n<h2 id=\"31-è·¯ç”±å’Œå¸ƒå±€\">3.1 è·¯ç”±å’Œå¸ƒå±€</h2>\n<p><code>Nuxt</code> æ¡†æ¶ä½¿ç”¨çº¦å®šå¼è·¯ç”±ï¼Œå³ <code>pages</code> æ–‡ä»¶å¤¹ä¸‹çš„ <code>Vue</code> ç»„ä»¶ç›´æ¥æˆä¸ºè·¯ç”±ã€‚</p>\n<pre><code class=\"language-shell\">- pages\n    # /\n    - index.vue \n    - foo\n        # /foo/bar\n        - bar.vue \n</code></pre>\n<p>ä»¥ä¸‹åˆ’çº¿å¼€å¤´çš„æ–‡ä»¶ï¼Œæˆä¸º<strong>åŠ¨æ€è·¯ç”±</strong></p>\n<pre><code class=\"language-shell\"># news/:post\n- news\n    - _post.vue\n</code></pre>\n<p>å¸ƒå±€æ–‡ä»¶åœ¨ <code>layouts</code> æ–‡ä»¶ä¸‹, åŒ…è£¹ <code>Nuxt</code> ç»„ä»¶å³å¯</p>\n<pre><code class=\"language-tsx\">// default.vue\n&lt;div&gt;\n    ...\n        &lt;Nuxt&gt;\n    ...\n&lt;/div&gt;\n</code></pre>\n<p>çŸ¥é“è¿™äº›åŸºæœ¬çš„é…ç½®ï¼Œå°†æ—§ä»£ç è¿ç§»è¿‡æ¥ï¼Œä¸€èˆ¬å°±èƒ½ç›´æ¥ç”¨äº†</p>\n<h2 id=\"32-æ’ä»¶\">3.2 æ’ä»¶</h2>\n<p>å½“æˆ‘ä»¬éœ€è¦å¼•å…¥ç¬¬ä¸‰æ–¹åº“æ—¶ï¼Œå¹¶æ²¡æœ‰å‘ <code>Vue</code> ä¸­é‚£æ ·æœ‰ä¸ªå…¥å£æ–‡ä»¶å¯ä»¥ä½¿ç”¨ã€‚æˆ‘ä»¬éœ€è¦åœ¨ <code>plugins</code> æ–‡ä»¶å¤¹ä¸‹å†™æ’ä»¶ã€‚ä¾‹å¦‚éƒ¨åˆ†å¼•å…¥ <code>element-ui</code></p>\n<pre><code class=\"language-ts\">// plugins/element.js\nimport Vue from &#39;vue&#39;\n\nconst components = [...]\n                    \nconst Element = {\n    install(Vue) {\n        components.forEach(c =&gt; Vue.component(c.name, c))\n    }\n}\nVue.use(Element)\n</code></pre>\n<p>ç„¶ååœ¨ <code>nuxt.config.js</code> è¿›è¡Œå¼•å…¥</p>\n<pre><code>plugins: [\n    &#39;./plugins/element.js&#39;\n]\n</code></pre>\n<p>å¦‚æœæˆ‘ä»¬è¦å¯¹ <code>axios</code> åšæ‰©å±•ï¼Œä¹Ÿå¯ä»¥å†™ä¸€ä¸ªæ’ä»¶ </p>\n<pre><code class=\"language-ts\">import host from &#39;../env&#39;\nexport default function({$axios,},) {\n    $axios.setBaseURL(`${host}/...`)\n    $axios.onResponse(res =&gt; {\n        ...\n    })\n}\n</code></pre>\n<p>å½“ç„¶ <code>Nuxt</code> æä¾›çš„æ’ä»¶èƒ½åŠ›å¼ºå¤§ï¼Œ æˆ‘ä»¬å¯ä»¥é€šè¿‡æ’ä»¶å¾€å®ä¾‹ä¸­æ·»åŠ å±æ€§</p>\n<pre><code class=\"language-ts\">export default function({}, inject) {\n    inject(...)\n}\n</code></pre>\n<h2 id=\"33-é¡µé¢æ–‡ä»¶\">3.3 é¡µé¢æ–‡ä»¶</h2>\n<h3 id=\"331-asyncdata\">3.3.1 asyncData</h3>\n<p>å’Œæ™®é€šçš„ <code>Vue</code> å¼€å‘ä¸åŒï¼Œ<code>Nuxt</code> ä¸­ <code>Vue</code> ç»„ä»¶è·å–æ•°æ®éœ€è¦ç”¨ç‰¹å®šçš„æ–¹æ³• <code>asyncData</code>, æ–¹ä¾¿å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½èƒ½ä½¿ç”¨</p>\n<pre><code class=\"language-ts\">async asyncData({params , $axios}) {\n    const { id } = params\n    const data = await $axios.get(`...`)\n    return {\n        data\n    }\n}\n</code></pre>\n<p><code>asyncData</code> è¿”å›çš„æ•°æ®ï¼Œå¯ä»¥é€šè¿‡å®ä¾‹è·å–ï¼Œä¾‹å¦‚ <code>this.data</code>ã€‚</p>\n<p><code>Nuxt</code> åŒæ—¶ä¹Ÿæä¾› <code>fetch</code> å‡½æ•°ç”¨æ¥è·å–æ•°æ®ã€‚</p>\n<h3 id=\"332-processbrowser\">3.3.2 process.browser</h3>\n<p>åœ¨ç»„ä»¶ä¸­ï¼Œå¦‚æœæœ‰äº›æ–¹æ³•éœ€è¦æ”¾åˆ° <code>created</code> å‘¨æœŸå»åšçš„ï¼Œéœ€è¦æ³¨æ„åˆ¤æ–­ä¸‹ç¯å¢ƒï¼Œæ”¯æŒç›®æ ‡ç¯å¢ƒæ”¯æŒçš„æ“ä½œ</p>\n<pre><code class=\"language-ts\">if(process.browser) {\n    ...\n}\n</code></pre>\n<h3 id=\"333-head\">3.3.3 head</h3>\n<p>å¦‚æœå½“å‰é¡µé¢éœ€è¦é¢å¤–çš„ <code>meta</code> ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡ <code>head</code> å‡½æ•°è¿›è¡Œå®šä¹‰</p>\n<pre><code class=\"language-ts\">head() {\n    return {\n        meta: [\n            {\n                hid: &#39;keywords&#39;,\n                name: &#39;keywords&#39;,\n                content: &#39;...&#39;\n            }\n        ]\n    }\n\n}\n</code></pre>\n<h1 id=\"å››-nuxtconfigjs\">å››. nuxt.config.js</h1>\n<p><code>nuxt.config.js</code> æ˜¯ <code>Nuxt</code> åº”ç”¨çš„é…ç½®æ–‡ä»¶,ç°åœ¨åˆç•¥è®²ä¸€ä¸‹é‡è¦çš„å­—æ®µã€‚</p>\n<ol>\n<li><strong>target</strong><br>æ„å»ºçš„ç›®æ ‡ <code>server</code> / <code>static</code> </li>\n<li><strong>head</strong>\nå®šä¹‰ <code>head</code> æ ‡ç­¾ä¸­ä¿¡æ¯,æ”¯æŒå®šä¹‰ <code>meta</code>, <code>link</code>, <code>script</code> ç­‰</li>\n<li><strong>css</strong>\nå…¨å±€ CSS å®šä¹‰</li>\n<li><strong>components</strong>\nç»„ä»¶è‡ªåŠ¨å¯¼å…¥åŠŸèƒ½å¼€å¯ï¼Œä¸éœ€è¦å†™å¼•å…¥è¯­å¥</li>\n<li><strong>env</strong>\nç¯å¢ƒå˜é‡</li>\n<li>** router **\nè·¯ç”±é…ç½®<pre><code class=\"language-ts\">router: {\n base: &#39;&#39;,\n extendRoutes() {}// æ‰©å±•è·¯ç”±\n}\n</code></pre>\nè¿™é‡Œéœ€è¦æ³¨æ„ä¸‹ï¼Œ<code>SSG</code> çš„é¡µé¢å­˜åœ¨è·¯ç”±é—®é¢˜ã€‚å¦‚æœæŸä¸ªè·¯ç”±é¡µé¢åˆ·æ–°ï¼Œä¼šæ‰¾ä¸åˆ°åœ°å€ï¼Œè¿™é‡Œéœ€è¦å¯¹è·¯ç”±å¤„ç†ä¸‹ã€‚\n```ts\nrouter: {\n extendRoutes(routes,) {\n routes.forEach(route =&gt; {\n     const alias  = route.path.length &gt; 1 <code>${route.path}/index.html</code>: &#39;/index.html&#39;\n     route.alias = alias\n \n })\n }</li>\n</ol>\n<p>}</p>\n<pre><code>\n\n7. **build**\n`webpack` çš„å¤„ç†, å¢åŠ è§„åˆ™ï¼Œå¼•å…¥æ’ä»¶ç­‰\n```js\nbuild: {\n    extend(config) {\n        config.module.rules...\n        return config\n    },\n    babel: {\n        plugins: [...]\n    }\n\n}\n</code></pre>\n<ol start=\"8\">\n<li><strong>generate</strong>\né…ç½® <code>SSG</code> çš„é€»è¾‘,ä¾‹å¦‚æˆ‘è¿™é‡Œè¯·æ±‚æ¥å£ç”Ÿæˆè·¯ç”±\n```js\ngenerate: {\n routes() {\n axios.get(&#39;...&#39;).then(res =&gt; {\n     return res.data.map(r =&gt; ({\n         route: <code>/news/${r.id}</code>\n     }))\n \n })\n }</li>\n</ol>\n<p>}</p>\n<p>```\nè¿™é‡Œå£°æ˜äº†è·¯ç”±æ–‡ä»¶çš„æ•°é‡ï¼Œæ„å»ºæ—¶ä¼šè°ƒç”¨å¯¹åº”ç»„ä»¶çš„ <code>asyncData</code> æ–¹æ³•ä¼ å…¥å‚æ•°ï¼Œç„¶åç”Ÿæˆé™æ€æ–‡ä»¶</p>\n<h1 id=\"äº”-æ€»ç»“\">äº”. æ€»ç»“</h1>\n<p>æ€»çš„æ¥è¯´ <code>Nuxt</code> çš„å¼€å‘ä½“éªŒè¿˜æ˜¯æ¯”è¾ƒå¥½çš„ï¼Œæ¯•ç«Ÿæ˜¯æ¡†æ¶ä¸Šé¢çš„æ¡†æ¶ï¼Œå„ç§æ’ä»¶å’Œæ¨¡å—éƒ½æ¯”è¾ƒé½å…¨ã€‚èƒ½å¤Ÿå¿«é€Ÿå®ç° <code>SSR</code> å’Œ <code>SSG</code>, å°±ç®—æ™®é€šå¼€å‘ <code>SPA</code> çš„ä½“éªŒä¹Ÿæ˜¯æ¯”è¾ƒå¥½çš„ã€‚</p>\n",
        "title": "SEOéœ€æ±‚ï¼ŒNuxt SSGç»ƒæ‰‹",
        "created": "2022-06-27 16:33:15  ",
        "updated": "2022-06-27 16:33:15 ",
        "excerpt": "ä¸€. ä¸šåŠ¡èƒŒæ™¯ éƒ¨é—¨å®˜ç½‘å’Œä¸»åº”ç”¨æ˜¯ä¸€ä¸ª SPA çš„æœåŠ¡ã€‚ç”±äºä¸šåŠ¡æ‰©å±•ï¼Œå¸Œæœ›èƒ½å¤Ÿè¢«æœç´¢å¼•æ“æ”¶å½•åˆ°ï¼Œæ‰€ä»¥å®˜ç½‘éœ€è¦åš SEOã€‚ äºŒ. æŠ€æœ¯é€‰å‹ ç”±äºç›´æ¥åœ¨åŸä¸»åº”ç”¨ä¸Šåš SSRï¼Œæ”¹åŠ¨æˆæœ¬å¤ªå¤§ï¼Œå†³å®šç›´æ¥ä½¿ç”¨ç°æˆçš„ SSR æ¡†æ¶ã€‚ Next.js ä¸ ...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "16"
    },
    "17": {
        "content": "<h1 id=\"ä¸€-createcomponent\">ä¸€. createComponent</h1>\n<p>Vue å¼€å‘å°±æ˜¯å¼€å‘ç»„ä»¶ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ç»„ä»¶å½¢æˆ VNode çš„é€»è¾‘ã€‚</p>\n<p>åœ¨ <code>_createElement</code> æ–¹æ³•ä¸­, åœ¨ä¸¤ç§åœºæ™¯ä¼šè°ƒç”¨ createComponent æ–¹æ³•</p>\n<pre><code class=\"language-ts\">// tag æ˜¯å·²ç»å£°æ˜è¿‡çš„ components æ—¶\nvnode = createComponent(Ctor, data, context, children, tag)\n// tag ä¸ä¸ºå­—ç¬¦ä¸²æ—¶\nvnode = createComponent(tag as any, data, context, children)\n</code></pre>\n<p>åˆå§‹åŒ–æ—¶æˆ‘ä»¬ä¼ å…¥çš„å€¼éƒ½ä¸º options å¯¹è±¡ï¼Œå¯¹åº”çš„å®ç°ä¸º</p>\n<pre><code class=\"language-ts\">export function createComponent(\nCtor: typeof Component | Function | ComponentOptions | void,\ndata: VNodeData | undefined,\ncontext: Component,\nchildren?: Array&lt;VNode&gt;,\ntag?: string\n): VNode | Array&lt;VNode&gt; | void {\n    // baseCtor å°±æ˜¯ Vue\n    const baseCtor = context.$options._base\n    // å°†å½“å‰çš„ Ctor ä¼ å…¥ Vue.extend å¾—åˆ°æ–°çš„ Ctor\n    if (isObject(Ctor)) {\n        Ctor = baseCtor.extend(Ctor as typeof Component)\n    }\n\n    data = data || {}\n    resolveConstructorOptions(Ctor as typeof Component)\n    \n    const propsData = extractPropsFromVNodeData(data, Ctor, tag)\n    const listeners = data.on\n    data.on = data.nativeOn\n\n    installComponentHooks(data)\n\n    const name = Ctor.options.name || tag\n    const vnode = new VNode(\n        `vue-component-${Ctor.cid}${name ? `-${name}` : &#39;&#39;}`,\n        data,\n        undefined,\n        undefined,\n        undefined,\n        context,\n        { Ctor, propsData, listeners, tag, children },\n        asyncFactory\n    )\n    return vnode\n}\n</code></pre>\n<p>è¿™é‡Œå…ˆå°†ä¼ å…¥çš„ Ctor é€šè¿‡ Vue.extend è¿›è¡Œæ‰©å±•</p>\n<pre><code class=\"language-ts\">Vue.extend = function (extendOptions: any): typeof Component {\n    extendOptions = extendOptions || {}\n    const Super = this\n    const SuperId = Super.cid\n    const cachedCtors = extendOptions._Ctor || (extendOptions._Ctor = {})\n\n    if (cachedCtors[SuperId]) {\n        return cachedCtors[SuperId]\n    }\n\n    const name = extendOptions.name || Super.options.name\n    const Sub = function VueComponent(this: any, options: any) {\n\n        this._init(options)\n\n    } as unknown as typeof Component\n    \n    // é€šè¿‡åŸå‹è¿›è¡Œç»§æ‰¿\n    // Sub.prototype.__proto__ = Suer.prototype\n    Sub.prototype = Object.create(Super.prototype)\n    Sub.prototype.constructor = Sub\n    \n    Sub.cid = cid++\n    Sub.options = mergeOptions(Super.options, extendOptions)\n    Sub[&#39;super&#39;] = Super\n\n    if (Sub.options.props) {\n        initProps(Sub)\n    }\n\n    if (Sub.options.computed) {\n        initComputed(Sub)\n    }\n\n    Sub.extend = Super.extend\n    Sub.mixin = Super.mixin\n    Sub.use = Super.use\n\n\n    ASSET_TYPES.forEach(function (type) {\n        Sub[type] = Super[type]\n    })\n\n    // enable recursive self-lookup\n    if (name) {\n        Sub.options.components[name] = Sub\n    }\n  \n    Sub.superOptions = Super.options\n    Sub.extendOptions = extendOptions\n    Sub.sealedOptions = extend({}, Sub.options)\n    // cache constructor\n    cachedCtors[SuperId] = Sub\n    return Sub\n}\n</code></pre>\n<p>Vue.extend å‡½æ•°å…è®¸æˆ‘ä»¬è®² options è½¬åŒ–ä¸ºæ„é€ å‡½æ•°ï¼Œå¹³æ—¶å¼€å‘æ—¶ä¹Ÿä¼šè¿›è¡Œä½¿ç”¨ã€‚</p>\n<p>è¿™é‡Œ Vue.extend åˆ›å»ºäº† Vue çš„å­ç±»ï¼Œå¹¶å¯¹å­ç±»è¿›è¡Œç¼“å­˜ã€‚</p>\n<p>åœ¨ create-component æ–¹æ³•ä¸­ è¿˜æœ‰ä¸ª <code>installComponentHooks</code> æ–¹æ³•ï¼Œæˆ‘ä»¬çœ‹çœ‹å®ƒçš„é€»è¾‘</p>\n<pre><code class=\"language-ts\">const hooksToMerge = Object.keys(componentVNodeHooks)\n\nfunction installComponentHooks(data: VNodeData) {\n    const hooks = data.hook || (data.hook = {})\n    for (let i = 0; i &lt; hooksToMerge.length; i++) {\n        const key = hooksToMerge[i]\n        const existing = hooks[key]\n        const toMerge = componentVNodeHooks[key]\n        if (existing !== toMerge &amp;&amp; !(existing &amp;&amp; existing._merged)) {\n            hooks[key] = existing ? mergeHook(toMerge, existing) : toMerge\n\n        }\n    }\n}\n</code></pre>\n<p>è¿™é‡Œä¸»è¦æ˜¯åˆå¹¶è‡ªèº«çš„ hook å’Œç»„ä»¶è‡ªå¸¦çš„ hook ,ç»„ä»¶è‡ªå¸¦çš„hookæœ‰è¿™äº›</p>\n<pre><code class=\"language-ts\">const componentVNodeHooks = {\n    init(){}, // å¤„ç†keep-aliveé€»è¾‘ å’Œ æŒ‚è½½å­ç»„ä»¶\n    prepatch(){}, // æ›´æ–°å­ç»„ä»¶\n    insert(){}, // mountedäº‹ä»¶ï¼Œ å¤„ç†keep-alive activateç›¸å…³\n    destroy(){}, // ç»„ä»¶é”€æ¯\n}\n</code></pre>\n<p>åœ¨ patch æ–¹æ³•ä¸­ä¼šå…ˆå¯¹ vnode è¿›è¡Œä¸€ä¸ªåˆ¤æ–­ï¼Œå¦‚æœè¿”å›ä¸º true å°±ä¸æ‰§è¡Œä¸‹æ–¹çš„æ’å…¥é€»è¾‘äº†</p>\n<pre><code class=\"language-ts\">if (createComponent(vnode, insertedVnodeQueue, parentElm, refElm)) {\nreturn\n}\n</code></pre>\n<p>æ‰€ä»¥æ¥çœ‹çœ‹è¿™ä¸ª patch å†…éƒ¨å®šä¹‰çš„ createComponent æ–¹æ³•</p>\n<pre><code class=\"language-ts\">function createComponent(vnode, insertedVnodeQueue, parentElm, refElm) {\n    let i = vnode.data\n    if (isDef(i)) {\n        if (isDef((i = i.hook)) &amp;&amp; isDef((i = i.init))) {\n            i(vnode, false /* hydrating */)\n        }\n        if (isDef(vnode.componentInstance)) {\n            initComponent(vnode, insertedVnodeQueue)\n            insert(parentElm, vnode.elm, refElm)\n            return true\n        }\n    }\n}\n</code></pre>\n<p>è¿™é‡Œåˆ¤æ–­ å¦‚æœ vnode æœ‰dataçš„è¯ï¼Œä»£è¡¨å®ƒæ˜¯ä¸€ä¸ªç»„ä»¶ã€‚ç„¶åæ‰§è¡Œ componentVNodeHooks ä¸­å®šä¹‰çš„ init æ–¹æ³•</p>\n<pre><code class=\"language-ts\">...\nvnode.componentInstance = createComponentInstanceForVnode(\nvnode,\nactiveInstance\n))\n...\n\n// createComponentInstanceForVnode\nconst options: InternalComponentOptions = {\n_isComponent: true,\n_parentVnode: vnode,\nparent\n}\n\nreturn new vnode.componentOptions.Ctor(options)\n</code></pre>\n<p>è¿™ä¸ªæ–¹æ³•ä¸­ æ‰§è¡Œ createComponentæ–¹æ³•ï¼Œ å°† options çš„ _isComponent è®¾ä¸º trueã€‚ ç„¶åå®ä¾‹åŒ–æ„é€ å‡½æ•°ï¼Œæ‰§è¡Œ _initæ–¹æ³•,\nèµ°äº†  initInternalComponent å‡½æ•°çš„é€»è¾‘</p>\n<pre><code class=\"language-ts\">if (options &amp;&amp; options._isComponent) {\n    initInternalComponent(vm, options as any)\n}\n</code></pre>\n<p>è¿™ä¸ªå‡½æ•°å°±æ˜¯ä¸ºäº†å®ä¾‹å†…éƒ¨å­ç»„ä»¶åˆå§‹åŒ–ä½¿ç”¨çš„ï¼Œä¼˜åŒ–åˆå¹¶é…ç½®çš„ä½“éªŒ</p>\n<pre><code class=\"language-ts\">export function initInternalComponent(\nvm: Component,\noptions: InternalComponentOptions\n) {\n    // ç›´æ¥è·å– æ„é€ å‡½æ•°çš„ options\n    const opts = (vm.$options = Object.create((vm.constructor as any).options))\n    \n    const parentVnode = options._parentVnode\n    opts.parent = options.parent // çˆ¶ç»„ä»¶å®ä¾‹\n    opts._parentVnode = parentVnode // çˆ¶Vnode\n\n\n    const vnodeComponentOptions = parentVnode.componentOptions!\n    opts.propsData = vnodeComponentOptions.propsData\n    opts._parentListeners = vnodeComponentOptions.listeners\n    opts._renderChildren = vnodeComponentOptions.children\n    opts._componentTag = vnodeComponentOptions.tag\n    if (options.render) {\n        opts.render = options.render\n        opts.staticRenderFns = options.staticRenderFns\n    }\n\n}\n</code></pre>\n<p>å›åˆ°ç»„ä»¶ init hook,è¿™é‡Œç»„ä»¶ä¼šè¿›è¡Œæ‰‹åŠ¨æŒ‚è½½</p>\n<pre><code class=\"language-ts\">child.$mount(hydrating ? vnode.elm : undefined, hydrating)\n\n// åœ¨å®¢æˆ·ç«¯\nchild.$mount( undefined, false)\n</code></pre>\n<p>åœ¨render æ—¶</p>\n<pre><code class=\"language-ts\">Vue.prototype._render = function (): VNode {\n    const { render, _parentVnode } = vm.$options\n    vm.$vnode = _parentVnode!\n    vnode = render.call(vm._renderProxy, vm.$createElement)\n    ...\n    vnode.$parent = _parentVnode\n}\n</code></pre>\n<p>æˆ‘çœ‹äº†æ¥ä¸‹æ¥çš„æµç¨‹ï¼Œ å­ç»„ä»¶ä¹‹æ‰€ä»¥ä¼šæŒæœ‰çˆ¶èŠ‚ç‚¹ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨</p>\n<ol>\n<li>å¾€çˆ¶ç»„ä»¶çš„ $children ä¸­push å½“å‰å®ä¾‹<pre><code class=\"language-ts\">parent.$children.push(vm)\nvm.$parent = parent\n</code></pre>\n</li>\n<li>æ’å…¥dom<pre><code class=\"language-ts\">insert(parentElm, vnode.elm, refElm)\n</code></pre>\n</li>\n</ol>\n<p>æœ€åæˆ‘ä»¬æ€»ç»“ patch ä¸­ createElmæ–¹æ³•ï¼š</p>\n<blockquote>\n<p>å¦‚æœä¼ å…¥çš„<code>vnode</code>Â ä¸ªæ™®é€šå…ƒç´ ï¼ŒÂ <code>createComponent(vnode, insertedVnodeQueue, parentElm, refElm)</code>Â çš„è¿”å›å€¼æ˜¯ falseã€‚æ¥ä¸‹æ¥çš„è¿‡ç¨‹å°±å’Œæˆ‘ä»¬ä¸Šä¸€ç« ä¸€æ ·äº†ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªçˆ¶èŠ‚ç‚¹å ä½ç¬¦ï¼Œç„¶åå†éå†æ‰€æœ‰å­ VNode é€’å½’è°ƒç”¨Â <code>createElm</code>ï¼Œåœ¨éå†çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°å­ VNode æ˜¯ä¸€ä¸ªç»„ä»¶çš„ VNodeï¼Œå°±èµ°ç»„ä»¶åˆå§‹åŒ–å’ŒæŒ‚è½½çš„é€»è¾‘ï¼Œé€šè¿‡ä¸€ä¸ªé€’å½’çš„æ–¹å¼å°±å¯ä»¥å®Œæ•´åœ°æ„å»ºäº†æ•´ä¸ªç»„ä»¶æ ‘ã€‚</p>\n</blockquote>\n<h1 id=\"äºŒ-é…ç½®å¤„ç†\">äºŒ. é…ç½®å¤„ç†</h1>\n<p>å½“æˆ‘ä»¬å¹³æ—¶å¼€å‘ç»„ä»¶æ—¶ï¼Œä¼šå£°æ˜å¾ˆå¤šå±æ€§ï¼Œä¹Ÿä¼šä½¿ç”¨ extends, mixin ç­‰æœç”¨é€»è¾‘ã€‚è€Œæˆ‘ä»¬è®¿é—®å±æ€§æ—¶ç›´æ¥ä» vm ä¸Šå°±èƒ½è®¿é—®çš„åˆ°ï¼Œé‚£ä¹ˆ Vue æ˜¯æ€ä¹ˆå®ç°è¿™ä¸ªé…ç½®åˆå¹¶åˆ°ç»„ä»¶çš„å‘¢ï¼Ÿ è¯·æ¥ç€å¾€ä¸‹çœ‹ã€‚</p>\n<h2 id=\"2-1å®ä¾‹åœºæ™¯\">2. 1å®ä¾‹åœºæ™¯</h2>\n<p>ä½¿ç”¨ mergeOptions å°†æ„é€ å™¨çš„ options å’Œ ä¼ å…¥çš„ options è¿›è¡Œåˆå¹¶</p>\n<pre><code class=\"language-ts\">vm.$options = mergeOptions(\n    resolveConstructorOptions(vm.constructor as any),\n    options || {},\n    vm\n)\n</code></pre>\n<p>æ„é€ å™¨çš„ options åŒ…æ‹¬å…¨å±€çš„ä¸€äº› components, directives, filtersç­‰</p>\n<p>æ¥ç€çœ‹çœ‹ mergeOptions çš„å®é™…é€»è¾‘</p>\n<pre><code class=\"language-ts\">export function mergeOptions(\nparent: Record&lt;string, any&gt;,\nchild: Record&lt;string, any&gt;,\nvm?: Component | null\n): ComponentOptions {\n\nif (isFunction(child)) {\n    child = child.options\n}\n\n  \nnormalizeProps(child, vm)\nnormalizeInject(child, vm)\nnormalizeDirectives(child)\n  \nif (!child._base) {\n    if (child.extends) {\n        parent = mergeOptions(parent, child.extends, vm)\n    }\n    if (child.mixins) {\n        for (let i = 0, l = child.mixins.length; i &lt; l; i++) {\n            parent = mergeOptions(parent, child.mixins[i], vm)\n        }\n    }\n}\n\nconst options: ComponentOptions = {} as any\n\nlet key\n\nfor (key in parent) {\n    mergeField(key)\n}\n\nfor (key in child) {\n    if (!hasOwn(parent, key)) {\n        mergeField(key)\n    }\n\n}\n\nfunction mergeField(key: any) {\n    const strat = strats[key] || defaultStrat\n    options[key] = strat(parent[key], child[key], vm, key)\n\n}\n\nreturn options\n\n}\n</code></pre>\n<p>è¿™é‡Œçš„æ­¥éª¤æœ‰ï¼š</p>\n<ol>\n<li>å¤„ç† props, inject, directives, åˆå¹¶åˆ°child.options<ol>\n<li>è¿™é‡Œchild optinos æœ€ç»ˆä¼šç”±äºåˆå¹¶ç­–ç•¥ ç›´æ¥åˆå¹¶åˆ°options</li>\n</ol>\n</li>\n<li>å°† extends å’Œ mixins åˆå¹¶åˆ° parent</li>\n<li>ç„¶åéå†parent, mergeField åˆ° optionsä¸Š</li>\n<li>éå†child, å°†ä¸åœ¨ parentä¸Šçš„å±æ€§åˆå¹¶åˆ° options</li>\n<li>æœ€åè¿”å›options, æŒ‚è½½åˆ° vm.options</li>\n</ol>\n<p>mergeField å‡½æ•°é’ˆå¯¹ä¸åŒçš„ key å€¼ä¹Ÿæœ‰ä¸åŒçš„åˆå¹¶ç­–ç•¥</p>\n<pre><code class=\"language-ts\">const strats = config.optionMergeStrategies\nstrats.props = strats.methods = strats.inject = strats.computed = ...\n\nstrats[hook] = ...\n</code></pre>\n<p>å…·ä½“æ¯ä¸ªå±æ€§çš„åˆå¹¶ç­–ç•¥ï¼Œæˆ‘ä»¬åç»­æœ‰å…´è¶£å¯ä»¥ä»”ç»†çœ‹çœ‹ã€‚</p>\n<h2 id=\"22-ç»„ä»¶åœºæ™¯\">2.2 ç»„ä»¶åœºæ™¯</h2>\n<p>å†…éƒ¨ç»„ä»¶éƒ½æ˜¯é€šè¿‡ Vue.extend æ‰©å±•ä¸º Vue çš„å­ç±», ç°åœ¨æˆ‘ä»¬å†çœ‹çœ‹ initInternalComponet çš„å…·ä½“é€»è¾‘</p>\n<pre><code class=\"language-ts\">export function initInternalComponent(\nvm: Component,\noptions: InternalComponentOptions\n) {\n    const opts = (vm.$options = Object.create((vm.constructor as any).options))\n\n    const parentVnode = options._parentVnode\n    opts.parent = options.parent\n    opts._parentVnode = parentVnode\n    const vnodeComponentOptions = parentVnode.componentOptions!\n    opts.propsData = vnodeComponentOptions.propsData\n    opts._parentListeners = vnodeComponentOptions.listeners\n    opts._renderChildren = vnodeComponentOptions.children\n    opts._componentTag = vnodeComponentOptions.tag\n\n    if (options.render) {\n        opts.render = options.render\n        opts.staticRenderFns = options.staticRenderFns\n\n    }\n\n}\n</code></pre>\n<p>è¿™é‡Œçš„é€»è¾‘å°±æ˜¯</p>\n<ol>\n<li>å°†vm.$options çš„åŸå‹æŒ‡å‘ æ„é€ å™¨çš„options</li>\n<li>ç„¶åä¿ç•™ çˆ¶å®ä¾‹ï¼Œçˆ¶ VNode, è¿˜ä¿å­˜propsDataç­‰å±æ€§</li>\n</ol>\n<p>è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œç»„ä»¶ç”Ÿæˆçš„å®ä¾‹ä¸»è¦è¿˜æ˜¯ä»¥åŸå‹é“¾ä¸ºåŸºç¡€ï¼Œç»“åˆç®€å•çš„å¯¹è±¡å¼•ç”¨èµ‹å€¼ï¼Œç›¸æ¯”äºç›´æ¥å®ä¾‹åŒ– Vue, ä¸éœ€è¦è¿›è¡Œé‚£ä¹ˆå¤š é…ç½®çš„åˆå¹¶ï¼Œé€’å½’å’Œå¤„ç†ã€‚æ‰€ä»¥å®˜æ–¹æ³¨é‡Šä¹Ÿæ˜¯è¿™ä¹ˆè¯´çš„</p>\n<blockquote>\n<p>optimize internal component instantiation\nsince dynamic options merging is pretty slow, and none of the\n internal component options needs special treatment.</p>\n</blockquote>\n<p> å†…éƒ¨ç»„ä»¶çš„é…ç½®åˆå§‹åŒ–è¦æ¯” åº”ç”¨ç›´æ¥åˆå§‹åŒ–è¦å¿«çš„å¤šï¼Œè€Œä¸”ç»“åˆç¼“å­˜ï¼Œè¿™å¯¹æ€§èƒ½æœ‰æå¤§çš„å¸®åŠ©</p>\n<h1 id=\"ä¸‰-ç»„ä»¶æ³¨å†Œ\">ä¸‰. ç»„ä»¶æ³¨å†Œ</h1>\n<p>å¹³æ—¶æ³¨å†Œç»„ä»¶æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯é€šè¿‡ <code>Vue.component</code> æ³¨å†Œå…¨å±€ç»„ä»¶ï¼Œè¿˜æœ‰ä¸­æ˜¯åœ¨ç»„ä»¶å†…éƒ¨æ³¨å†Œå±€éƒ¨ç»„ä»¶. å…¶å®åŸç†åº”è¯¥å¾ˆç®€å•çš„ï¼Œå…¨å±€æ³¨å†Œå°±æ³¨å†Œåˆ° <code>Vue.options.components</code>é‡Œï¼Œå±€éƒ¨æ³¨å†Œå°±ç›´æ¥ æ³¨å†Œåˆ° <code>vm.$options.components</code>é‡Œ. ç„¶åç»„ä»¶åˆå§‹åŒ–æ—¶æ··å…¥æ„é€ å™¨é€»è¾‘ï¼Œå°±å¯ä»¥è¯»å–åˆ°å…¨å±€ç»„ä»¶äº†ã€‚</p>\n<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å…·ä½“é€»è¾‘ï¼Œé¦–å…ˆæ˜¯ å…¨å±€æ³¨å†Œ</p>\n<h2 id=\"31-å…¨å±€æ³¨å†Œ\">3.1 å…¨å±€æ³¨å†Œ</h2>\n<pre><code class=\"language-ts\">// &gt; src/core/global-api/asset.ts\n\nexport function initAssetRegisters(Vue: GlobalAPI) {\n    ASSET_TYPES.forEach(type =&gt; {\n        Vue[type] = function (\n        id: string,\n        definition?: Function | Object\n        ): Function | Object | void {\n            if (type === &#39;component&#39; &amp;&amp; isPlainObject(definition)) {\n                definition.name = definition.name || id\n                definition = this.options._base.extend(definition)\n            }\n            this.options[type + &#39;s&#39;][id] = definition\n            return definition\n        }\n    })\n}\n</code></pre>\n<p>è¿™é‡Œæ³¨å†Œäº† <code>Vue.component</code>,<code>Vue.directive</code>, <code>Vue.filter</code>ä¸‰ä¸ªé™æ€æ–¹æ³•ï¼Œæˆ‘ä»¬çœ‹ä¸‹ <code>Vue.component</code>çš„é€»è¾‘ã€‚</p>\n<ol>\n<li>é€šè¿‡ <code>Vue.extend</code>å°†ç»„ä»¶æ‰©å±•ä¸º ç»„ä»¶æ„é€ å™¨</li>\n<li>å­˜å…¥ <code>Vue.options</code> ä¸­\nè¿™æ ·åº”ç”¨ä¸‹çš„æ¯ä¸ªç»„ä»¶åœ¨å®ä¾‹åŒ–æ—¶ï¼Œåˆå¹¶é…ç½®ï¼Œéƒ½å¯ä»¥ä½¿ç”¨åˆ°è¿™ä¸ªç»„ä»¶</li>\n</ol>\n<h2 id=\"32-å±€éƒ¨æ³¨å†Œ\">3.2 å±€éƒ¨æ³¨å†Œ</h2>\n<p>å±€éƒ¨æ³¨å†Œå°±æ˜¯å®ä¾‹åŒ–åˆå¹¶ <code>option</code> æ—¶ï¼Œ å°† <code>components</code> åˆå¹¶åˆ° <code>vm.$options.components</code> ä¸Šï¼Œè¿™æ ·åœ¨ç»„ä»¶ä¸­å°±å¯ä»¥ä½¿ç”¨æ³¨å†Œçš„ç»„ä»¶äº†</p>\n<h1 id=\"å››-æ€»ç»“\">å››. æ€»ç»“</h1>\n<p>ç»„ä»¶è¿™ä¸€ç¯‡æˆ‘æ˜¯çœ‹çš„æ¯”è¾ƒéš¾å—çš„ï¼Œä¸€å¼€å§‹å¾ˆéš¾ç†è§£å†…éƒ¨ç»„ä»¶çš„æ•´ä½“çš„åˆ›å»ºæµç¨‹ã€‚ç»“åˆç½‘ä¸Šçš„æ–‡ç« å’Œæºç æ‰æ–­æ–­ç»­ç»­è¯»åˆ°å·®ä¸å¤šã€‚ä½†æ˜¯å¯¹äºæ•´ä¸ªæµç¨‹è¿˜æ˜¯æœ‰ç‚¹è¿·ç³Šï¼Œåç»­ä¼šç»˜åˆ¶å®Œæ•´çš„æµç¨‹å›¾ï¼Œæ–¹ä¾¿ç†è§£ã€‚</p>\n",
        "title": "Vue æºç å­¦ä¹  (3) - ç»„ä»¶",
        "created": "2022-07-03 16:42:09  ",
        "updated": "2022-07-03 16:42:09 ",
        "excerpt": "ä¸€. createComponent Vue å¼€å‘å°±æ˜¯å¼€å‘ç»„ä»¶ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ç»„ä»¶å½¢æˆ VNode çš„é€»è¾‘ã€‚ åœ¨ _createElement æ–¹æ³•ä¸­, åœ¨ä¸¤ç§åœºæ™¯ä¼šè°ƒç”¨ createComponent æ–¹æ³• `ts // tag æ˜¯å·²ç»å£°...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "17"
    },
    "18": {
        "content": "<h1 id=\"ä¸€-æ•°æ®åˆå§‹åŒ–\">ä¸€. æ•°æ®åˆå§‹åŒ–</h1>\n<p>å¦‚æœæœ‰äººé—® Vue çš„å“åº”å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå¤§å¤šæ•°äººä¼šå›ç­” é€šè¿‡æ•°æ®åŠ«æŒï¼Œåˆ©ç”¨ <code>Object.defineProperty</code> åŠ«æŒ getter å’Œ setter å®ç°çš„ã€‚æ•°æ®èµ‹å€¼æ—¶ï¼Œæ›´æ–°è§†å›¾ã€‚ç„¶åæ•°ç»„ é€šè¿‡é‡å†™æ•°ç»„çš„ prototype æ–¹æ³•å®ç°åŠ«æŒã€‚</p>\n<p>ä¸Šé¢çš„è¯´æ³•å…¶å®ä¹Ÿæ²¡å¤šé”™ï¼Œä½†æ˜¯ä¸å¤Ÿç»†èŠ‚ã€‚ä¾‹å¦‚ä¾èµ–æ—¶æ€ä¹ˆæ”¶é›†çš„ï¼Œæ•°æ®å˜åŒ–æ—¶ï¼Œæ€ä¹ˆçŸ¥é“è¯¥æ›´æ–°å“ªäº›æ•°æ®ï¼Ÿå®šä¹‰åœ¨ option ä¸Šçš„æ•°æ®ï¼Œä¸ºä½•é€šè¿‡ this å¯ä»¥ç›´æ¥è®¿é—®çš„åˆ°ï¼Ÿ å¸¦ç€è¿™äº›ç–‘é—®ï¼Œæˆ‘ä»¬ç»§ç»­æºç æ¢ç´¢ä¹‹æ—…ã€‚</p>\n<p>é¦–å…ˆæ¥åˆ°æ•°æ®åˆå§‹åŒ–çš„é€»è¾‘</p>\n<pre><code class=\"language-ts\">// &gt; src/core/instance/state.ts\nexport function initState(vm: Component) {\n    const opts = vm.$options\n    if (opts.props) initProps(vm, opts.props)\n        initSetup(vm)\n    if (opts.methods) initMethods(vm, opts.methods)\n    if (opts.data) {\n        initData(vm)\n    } else {\n        const ob = observe((vm._data = {}))\n        ob &amp;&amp; ob.vmCount++\n    }\n    if (opts.computed) initComputed(vm, opts.computed)\n    if (opts.watch &amp;&amp; opts.watch !== nativeWatch) {\n        initWatch(vm, opts.watch)\n    }\n}\n</code></pre>\n<h2 id=\"11-initprops\">1.1 initProps</h2>\n<pre><code class=\"language-ts\">function initProps(vm: Component, propsOptions: Object) {\n    const propsData = vm.$options.propsData || {}\n    const props = (vm._props = shallowReactive({}))\n    const keys: string[] = (vm.$options._propKeys = [])\n    const isRoot = !vm.$parent\n\n    if (!isRoot) {\n        toggleObserving(false)\n    }\n    for (const key in propsOptions) {\n        keys.push(key)\n        const value = validateProp(key, propsOptions, propsData, vm)\n        defineReactive(props, key, value)\n\n        if (!(key in vm)) {\n            proxy(vm, `_props`, key)\n        }\n\n    }\n    toggleObserving(true)\n}\n</code></pre>\n<ol>\n<li>è°ƒç”¨ <code>defineReactive</code> å°†æ¯ä¸ª prop key å˜æˆå“åº”å¼</li>\n<li>é€šè¿‡ proxy æ–¹æ³•å°† vm._props.* ä»£ç†åˆ° vm.* ä¸Š</li>\n</ol>\n<p>è¿™é‡Œæœ‰ä¸€ä¸ª propsData ï¼Œè¿™æ˜¯ç»™ç»„ä»¶ä¼ å…¥çš„ props å€¼</p>\n<h1 id=\"12-initdata\">1.2 initData</h1>\n<pre><code class=\"language-ts\">function initData(vm: Component) {\n    let data: any = vm.$options.data\n    data = vm._data = isFunction(data) ? getData(data, vm) : data || {}\n    // proxy data on instance\n    const keys = Object.keys(data)\n    let i = keys.length\n\n    while (i--) {\n        const key = keys[i]\n         if (!isReserved(key)) {\n            proxy(vm, `_data`, key)\n        }\n    }\n\n    // observe data\n    const ob = observe(data)\n    ob &amp;&amp; ob.vmCount++\n}\n</code></pre>\n<p>è¿™é‡Œé€šè¿‡ proxy æ–¹æ³•å°† data ä¸­çš„ key ä»£ç†åˆ° vmä¸Šï¼Œè¿˜æœ‰é€šè¿‡ observe æ–¹æ³•è§‚æµ‹æ•´ä¸ª dataæ•°æ®ã€‚</p>\n<p>æ•°æ®åˆå§‹åŒ–å°±å…ˆè®² initProps å’Œ initState, é€šè¿‡è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬äº†è§£åˆ°äº†ä¸‰ä¸ªé‡è¦å‡½æ•° ï¼ŒdefineReactive , proxy, oberve ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸‹è¿™ä¸‰ä¸ªå‡½æ•°çš„ä¸»è¦é€»è¾‘ã€‚</p>\n<h1 id=\"13-proxy\">1.3 proxy</h1>\n<p>proxy ä»£ç†å±æ€§åˆ° vm ä¸Šï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å†™åœ¨ option ä¸­çš„é…ç½®ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ this è®¿é—®çš„åˆ°åŸå› ã€‚</p>\n<pre><code class=\"language-ts\">const sharedPropertyDefinition = {\n    enumerable: true,\n    configurable: true,\n    get: noop,\n    set: noop\n}\n\n\nexport function proxy(target: Object, sourceKey: string, key: string) {\n    sharedPropertyDefinition.get = function proxyGetter() {\n        return this[sourceKey][key]\n    }\n    sharedPropertyDefinition.set = function proxySetter(val) {\n        this[sourceKey][key] = val\n    }\n    Object.defineProperty(target, key, sharedPropertyDefinition)\n}\n</code></pre>\n<p>é€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡ Object.defineProperty åŠ«æŒå±æ€§çš„è®¿é—®ï¼Œå°†å¯¹vmçš„æ“ä½œï¼Œæ˜ å°„ä¸ºè¢«ä»£ç†æ•°æ®çš„æ“ä½œã€‚</p>\n<h1 id=\"14-observe\">1.4 observe</h1>\n<pre><code class=\"language-ts\">export function observe(value: any, shallow?: boolean): Observer | void {\n    let ob: Observer | void\n     if (\n\n        shouldObserve &amp;&amp;\n        !isServerRendering() &amp;&amp;\n        (isArray(value) || isPlainObject(value)) &amp;&amp;\n        Object.isExtensible(value) &amp;&amp;\n        !value.__v_skip\n    ) {\n        ob = new Observer(value, shallow)\n    }\n    return ob\n}\n</code></pre>\n<p>ç¬¦åˆæ¡ä»¶æ—¶ï¼Œå®ä¾‹åŒ–ä¸€ä¸ª Observer å¯¹è±¡å®ä¾‹</p>\n<pre><code class=\"language-ts\">export class Observer {\n    dep: Dep\n    vmCount: number \n\n    constructor(public value: any, public shallow = false) {\n        this.dep = new Dep()\n        this.vmCount = 0\n        def(value, &#39;__ob__&#39;, this)\n        if (isArray(value)) {\n            protoAugment(value, arrayMethods)\n            if (!shallow) {\n                this.observeArray(value)\n            }\n\n        } else {\n            this.walk(value, shallow)\n        }\n    }\n\n    walk(obj: object, shallow: boolean) {\n        const keys = Object.keys(obj)\n        for (let i = 0; i &lt; keys.length; i++) {\n            const key = keys[i]\n            defineReactive(obj, key, NO_INIITIAL_VALUE, undefined, shallow)\n        }\n\n    }\n  \n    observeArray(items: Array&lt;any&gt;) {\n        for (let i = 0, l = items.length; i &lt; l; i++) {\n            observe(items[i])\n        }\n    }\n\n}\n</code></pre>\n<p>è¿™é‡Œçš„é€»è¾‘ä¸»è¦æ˜¯å¯¹ Array å’Œ Object è¿›è¡Œæ•°æ®åŠ«æŒ</p>\n<ol>\n<li>å¦‚æœæ˜¯æ•°ç»„ï¼Œå°±åŠ«æŒåŸå‹æ–¹æ³•ï¼Œç„¶åå¯¹æ¯ä¸€é¡¹è¿›è¡Œé€’å½’ observe</li>\n<li>å¦‚æœæ˜¯å¯¹è±¡ï¼Œå°±å¯¹æ¯ä¸€ä¸ªå±æ€§æ‰§è¡Œ defineReactive</li>\n</ol>\n<h1 id=\"15-definereactive\">1.5 defineReactive</h1>\n<p>initProps å’Œ initData å®è´¨ä¸Šéƒ½ä½¿ç”¨åˆ°äº†è¿™ä¸ªæ–¹æ³•ï¼Œç°åœ¨çœ‹çœ‹å®ƒçš„é€»è¾‘</p>\n<pre><code class=\"language-ts\">export function defineReactive(\n    obj: object,\n    key: string,\n    val?: any,\n    customSetter?: Function | null,\n    shallow?: boolean\n) {\n\n    const dep = new Dep()\n    const property = Object.getOwnPropertyDescriptor(obj, key)\n\n    const getter = property &amp;&amp; property.get\n    const setter = property &amp;&amp; property.set\n\n\n    let childOb = !shallow &amp;&amp; observe(val)\n    Object.defineProperty(obj, key, {\n        enumerable: true,\n        configurable: true,\n        get: function reactiveGetter() {\n            const value = getter ? getter.call(obj) : val\n            if (Dep.target) {\n                dep.depend()\n                if (childOb) {\n                    childOb.dep.depend()\n                    if (isArray(value)) {\n                    dependArray(value)\n                    }\n                }\n            }\n            return isRef(value) ? value.value : value\n        },\n\n        set: function reactiveSetter(newVal) {\n            const value = getter ? getter.call(obj) : val\n            if (!hasChanged(value, newVal)) {\n                return\n            }\n\n            if (setter) {\n                setter.call(obj, newVal)\n            } else if (getter) {\n                return\n            } else if (isRef(value) &amp;&amp; !isRef(newVal)) {\n                value.value = newVal\n                return\n            } else {\n                val = newVal\n            }\n\n            childOb = !shallow &amp;&amp; observe(newVal)\n            dep.notify()\n        }\n\n    })\n    return dep\n\n}\n</code></pre>\n<p>è¿™é‡Œæ‰§è¡Œçš„é€»è¾‘ä¸ºï¼š</p>\n<ol>\n<li>æ‹¿åˆ°åŸå§‹çš„ getterå’Œ setter,æ–¹ä¾¿åç»­åŠ«æŒæ—¶ä½¿ç”¨</li>\n<li>å¦‚æœä¸æ˜¯ shallow, å°±Observeå½“å‰æ•°æ®</li>\n<li>getterå‡½æ•°ä¸­ï¼Œå¦‚æœDep.target å­˜åœ¨ï¼Œå°±æ‰§è¡Œdepend<ol>\n<li>è‡ªèº«depend</li>\n<li>childOb çš„depend</li>\n</ol>\n</li>\n<li>setterå‡½æ•°ä¸­<ol>\n<li>åˆ©ç”¨åŸå§‹getterå¾—åˆ°åŸå§‹å€¼ï¼Œå’Œæ–°å€¼æ¯”è¾ƒï¼Œå¦‚æœä¸å˜å°± return</li>\n<li>æ‰§è¡Œèµ‹å€¼é€»è¾‘ï¼Œé‡æ–°å¯¹å½“å‰å±æ€§observe</li>\n<li>æ‰§è¡Œ notify</li>\n</ol>\n</li>\n</ol>\n<p>è¿™ä¸ªå‡½æ•°ä¹Ÿæ˜¯é€šè¿‡é€’å½’å¯¹æ•´ä¸ªå¯¹è±¡è¿›è¡ŒåŠ«æŒï¼Œè¿™æ ·ä¿è¯äº†æ— è®ºæ˜¯å¤šæ·±çš„æ•°æ®ç»“æ„ï¼Œä»»ä½•å€¼å˜åŒ–éƒ½èƒ½æ‰§è¡Œ notifyçš„é€»è¾‘</p>\n<p>ä¸Šé¢çš„æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ° Dep è¿™ä¸ªç±»ï¼Œåœ¨æ‰§è¡Œgetteræ—¶ï¼Œä¼šè§¦å‘ dep.depend æ¥è¿›è¡Œä¾èµ–æ”¶é›† ï¼Œsetter æ—¶ä¼šè§¦å‘ dep.notifyæ–¹æ³•è¿›è¡Œæ´¾å‘æ›´æ–°ã€‚å…¶å®è¿™å°±æ˜¯ Vue å“åº”å¼çš„åŸºæœ¬åŸç†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸‹ Dep è¿™ä¸ªç±»</p>\n<h1 id=\"äºŒ-dep\">äºŒ. Dep</h1>\n<p>Dep ç±»çš„å®šä¹‰</p>\n<pre><code class=\"language-ts\">export interface DepTarget extends DebuggerOptions {\n    id: number\n    addDep(dep: Dep): void\n    update(): void\n}\n\nexport default class Dep {\n    static target?: DepTarget | null\n    id: number\n    subs: Array&lt;DepTarget&gt;\n\n    constructor() {\n        this.id = uid++\n        this.subs = []\n    }\n    addSub(sub: DepTarget) {\n        this.subs.push(sub)\n    }\n    removeSub(sub: DepTarget) {\n        remove(this.subs, sub)\n    }\n    depend() {\n        if (Dep.target) {\n            Dep.target.addDep(this)\n        }\n    }\n    notify() {\n        const subs = this.subs.slice()\n        for (let i = 0, l = subs.length; i &lt; l; i++) {\n            subs[i].update()\n        }\n    }\n}\n</code></pre>\n<p>Dep æ‹¥æœ‰ä¸€ä¸ªé™æ€å±æ€§ target, å…¨å±€å”¯ä¸€ã€‚åœ¨ä½¿ç”¨ dependæ–¹æ³•æ—¶ å®é™…ä¸Šæ˜¯å¯¹å½“å‰ target æ·»åŠ  addDep. åœ¨ä½¿ç”¨ notify æ–¹æ³•ä¼šå¯¹å½“å‰æ‰€æœ‰çš„è®¢é˜…æ‰§è¡Œæ›´æ–°æ–¹æ³•ã€‚</p>\n<p>æ‰€ä»¥ä¸€åˆ‡çš„å…³é”®éƒ½åœ¨äº target.addDep çš„æ–¹æ³•æ‰§è¡Œçš„é€»è¾‘ã€‚</p>\n<p>å®é™…ä¸Š Dep å’Œ Watcher ç›¸è¾…ç›¸æˆï¼Œtarget æŒ‡å‘çš„ä¸€èˆ¬æ˜¯ watcher, subsä¹Ÿæ˜¯ watcheræ•°ç»„ã€‚</p>\n<h1 id=\"ä¸‰-watcher\">ä¸‰. Watcher</h1>\n<p>åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°æœ‰æ¸²æŸ“ watcher,ã€‚</p>\n<p>æˆ‘ä»¬å¹³æ—¶åœ¨ options æ—¶å¯ä»¥è‡ªå®šä¹‰ watcher , è¿˜æœ‰æˆ‘ä»¬ä½¿ç”¨çš„ computed ï¼Œå®ƒæœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ª watcherã€‚</p>\n<p>æ€»çš„æ¥è¯´ï¼ŒVue çš„å“åº”å¼çš„å®ç°å°±æ˜¯ä¾èµ– Watcher çš„ã€‚ç°åœ¨æˆ‘ä»¬å°±æ¥çœ‹çœ‹ Watcher çš„é€»è¾‘ã€‚</p>\n<pre><code class=\"language-ts\">&gt; core/observer/watcher.ts\n\nexport default class Watcher implements DepTarget {\n    vm?: Component | null\n    expression: string\n    cb: Function\n    id: number\n    deep: boolean\n    user: boolean\n    lazy: boolean\n    sync: boolean\n    dirty: boolean\n    active: boolean\n    deps: Array&lt;Dep&gt;\n    newDeps: Array&lt;Dep&gt;\n    depIds: SimpleSet\n    newDepIds: SimpleSet\n    before?: Function\n    onStop?: Function\n    noRecurse?: boolean\n    getter: Function\n    value: any\n\n    constructor(\n    vm: Component | null,\n    expOrFn: string | (() =&gt; any),\n    cb: Function,\n    options?: WatcherOptions | null,\n    isRenderWatcher?: boolean\n    ) {\n        recordEffectScope(this, activeEffectScope || (vm ? vm._scope : undefined))\n        if ((this.vm = vm)) {\n\n            if (isRenderWatcher) {\n\n            vm._watcher = this\n\n            }\n\n        }\n        if (options) {\n            this.deep = !!options.deep\n            this.user = !!options.user\n            this.lazy = !!options.lazy\n            this.sync = !!options.sync\n            this.before = options.before\n        } else {\n            this.deep = this.user = this.lazy = this.sync = false\n        }\n\n        this.cb = cb\n        this.id = ++uid // uid for batching\n        this.active = true\n        this.dirty = this.lazy // for lazy watchers\n        this.deps = []\n        this.newDeps = []\n        this.depIds = new Set()\n        this.newDepIds = new Set()\n        this.expression = &#39;&#39;\n\n        if (isFunction(expOrFn)) {\n            this.getter = expOrFn\n        } else {\n            this.getter = parsePath(expOrFn)\n        }\n        this.value = this.lazy ? undefined : this.get()\n    }\n\n  \n\n    get() {\n        pushTarget(this)\n        let value\n        const vm = this.vm\n        try {\n            value = this.getter.call(vm, vm)\n        } finally {\n            if (this.deep) {\n                traverse(value)\n            }\n            popTarget()\n            this.cleanupDeps()\n        }\n        return value\n    }\n\n    addDep(dep: Dep) {\n        const id = dep.id\n        if (!this.newDepIds.has(id)) {\n            this.newDepIds.add(id)\n            this.newDeps.push(dep)\n            if (!this.depIds.has(id)) {\n                dep.addSub(this)\n            }\n        }\n\n    }\n\n  \n\n    cleanupDeps() {\n        let i = this.deps.length\n\n        while (i--) {\n            const dep = this.deps[i]\n            if (!this.newDepIds.has(dep.id)) {\n                dep.removeSub(this)\n            }\n        }\n\n        let tmp: any = this.depIds\n        this.depIds = this.newDepIds\n        this.newDepIds = tmp\n        this.newDepIds.clear()\n\n        tmp = this.deps\n        this.deps = this.newDeps\n        this.newDeps = tmp\n        this.newDeps.length = 0\n    }\n\n  \n\n    update() {\n        if (this.lazy) {\n            this.dirty = true\n        } else if (this.sync) {\n            this.run()\n        } else {\n            queueWatcher(this)\n\n        }\n\n    }\n\n    run() {\n        if (this.active) {\n            const value = this.get()\n            if (\n                value !== this.value ||\n            isObject(value) ||\n            this.deep\n            ) {\n            const oldValue = this.value\n            this.value = value\n            if (this.user) {\n                const info = `callback for watcher &quot;${this.expression}&quot;`\n                invokeWithErrorHandling(\n                    this.cb,\n                    this.vm,\n                    [value, oldValue],\n                    this.vm,\n                    info\n                )\n\n                } else {\n                    this.cb.call(this.vm, value, oldValue)\n                }\n            }\n        }\n    }\n\n    evaluate() {\n        this.value = this.get()\n        this.dirty = false\n    }\n\n    depend() {\n        let i = this.deps.length\n        while (i--) {\n            this.deps[i].depend()\n        }\n    }\n\n    teardown() {\n        if (this.vm &amp;&amp; !this.vm._isBeingDestroyed) {\n            remove(this.vm._scope.effects, this)\n        }\n        if (this.active) {\n            let i = this.deps.length\n            while (i--) {\n                this.deps[i].removeSub(this)\n            }\n            this.active = false\n            if (this.onStop) {\n                this.onStop()\n            }\n\n        }\n\n    }\n\n}\n</code></pre>\n<p>åœ¨ Watcher ç±»ä¸­ï¼Œæœ‰å‡ ä¸ªå±æ€§éœ€è¦æ³¨æ„</p>\n<pre><code class=\"language-ts\">deps: Array&lt;Dep&gt; // ä¾èµ–æ•°ç»„\nnewDeps: Array&lt;Dep&gt; // ä¾èµ–æ•°ç»„\ndepIds: SimpleSet // ä¾èµ–id set\nnewDepIds: SimpleSet // ä¾èµ–id set\n</code></pre>\n<h2 id=\"31-ä¾èµ–æ”¶é›†å’Œæ´¾å‘æ›´æ–°\">3.1 ä¾èµ–æ”¶é›†å’Œæ´¾å‘æ›´æ–°</h2>\n<p>åœ¨ Watcher åˆå§‹åŒ–æ—¶ï¼Œä¼šæ‰§è¡Œè‡ªå·±çš„ getæ–¹æ³•</p>\n<pre><code class=\"language-ts\">\nthis.getter = expOrFn\nthis.value = this.lazy ? undefined : this.get()\n}\n\nget() {\n    pushTarget(this)\n    let value\n    const vm = this.vm\n    ...\n    value = this.getter.call(vm, vm)\n    ...\n    if (this.deep) {\n        traverse(value)\n    }\n    popTarget()\n    this.cleanupDeps()\n    return value\n\n}\n</code></pre>\n<p>get æ–¹æ³•ä¸­ä¼šæ‰§è¡Œ pushTarget å’Œ popTarget æ–¹æ³•</p>\n<pre><code class=\"language-ts\">export function pushTarget(target?: DepTarget | null) {\n    targetStack.push(target)\n    Dep.target = target\n}\nexport function popTarget() {\n    targetStack.pop()\n    Dep.target = targetStack[targetStack.length - 1]\n}\n</code></pre>\n<p>pushTarget æ–¹æ³•å°±æ˜¯æŠŠå½“å‰çš„ watcher è®¾ä¸º Dep.targetå¹¶å‹æ ˆ</p>\n<p>ç„¶åæ‰§è¡Œ this.getter æ–¹æ³•ï¼Œä¼šæƒ³ <code>mountComponent</code> æ–¹æ³•ï¼Œåœ¨å®ä¾‹åŒ– åœ¨æ¸²æŸ“ <code>watcher</code> ä¸­ï¼Œ <code>getter</code> æ–¹æ³•ä¼ å…¥çš„æ˜¯ <code>updateCompontent</code></p>\n<pre><code class=\"language-ts\">updateComponent = () =&gt; {\n    vm._update(vm._render(), hydrating)\n}\n</code></pre>\n<p>è¿™é‡Œ vm.render() ç”Ÿæˆ VNode æ—¶ä¼šè§¦å‘ vmä¸Šå“åº”å¼æ•°æ®çš„ getter , ä¹Ÿå› æ­¤è°ƒç”¨Â <code>dep.depend()</code>Â æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯Â <code>Dep.target.addDep(this)</code>ï¼Œä¹Ÿå°±æ˜¯å½“å‰ watcher æ‰§è¡Œ addDepæ–¹æ³•</p>\n<pre><code class=\"language-ts\">addDep(dep: Dep) {\n    const id = dep.id\n    if (!this.newDepIds.has(id)) {\n        this.newDepIds.add(id)\n        this.newDeps.push(dep)\n        if (!this.depIds.has(id)) {\n            dep.addSub(this)\n        }\n    }\n}\n</code></pre>\n<p>è¿™é‡Œ watcher æ”¶é›†äº†æ•°æ®çš„ä¾èµ–ï¼Œæ•°æ®çš„ä¾èµ–ä¹Ÿæ”¶é›†äº† watcher çš„ä¾èµ–ã€‚ç„¶åæ‰§è¡Œ popTarget å°†å½“å‰Dep.tareget æ¢å¤æˆä¸Šä¸€æ¬¡çš„çŠ¶æ€</p>\n<pre><code class=\"language-ts\">popTarget()\nthis.cleanupDeps()\n</code></pre>\n<p>è¿™é‡Œé™¤äº† popTarget ä¹‹å¤–ï¼Œ è¿™é‡Œè¿˜æ‰§è¡Œäº† this.cleanupDesp æ–¹æ³•</p>\n<pre><code class=\"language-ts\">cleanupDeps() {\n    let i = this.deps.length\n    while (i--) {\n        const dep = this.deps[i]\n        if (!this.newDepIds.has(dep.id)) {\n            dep.removeSub(this)\n        }\n    }\n    let tmp: any = this.depIds\n    this.depIds = this.newDepIds\n    this.newDepIds = tmp\n    this.newDepIds.clear()\n    tmp = this.deps\n    this.deps = this.newDeps\n    this.newDeps = tmp\n    this.newDeps.length = 0\n}\n</code></pre>\n<p>è¿™é‡Œçš„é€»è¾‘å°±æ˜¯å°†æ²¡æœ‰ä¾èµ–è¿›è¡Œæ›´æ–°ï¼Œå¯¹æ²¡æœ‰ç”¨åˆ°çš„ä¾èµ–è¿›è¡Œç§»é™¤ã€‚</p>\n<p>æ‰€ä»¥é€šè¿‡ watcher å’Œ Dep.depend  åœ¨ç»„ä»¶è¿›è¡Œæ¸²æŸ“æ—¶ï¼Œè§¦å‘æ•°æ®çš„getterï¼Œè¿›è¡Œä¾èµ–çš„æ”¶é›†ã€‚è¿™é‡Œwatcher ä¹Ÿæ”¶é›†äº†ä¾èµ–ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ¯æ¬¡æ›´æ–°èƒ½å¤Ÿç§»é™¤ä¸å†éœ€è¦çš„ä¾èµ–ï¼Œä½¿æ›´æ–°æ›´åŠ é¢—ç²’åº¦ã€‚</p>\n<p>æ‰€ä»¥å½“æ•°æ®æ›´æ–°ï¼Œè§¦å‘ setter æ—¶ï¼Œä¼šè§¦å‘å½“å‰æ•°æ®çš„ <code>dep.notify</code>, ç„¶åå°† dep æ‰€æœ‰çš„ä¾èµ– subï¼Œè§¦å‘ sub.update. ä¹Ÿå°±æ˜¯å½“å‰ æ¸²æŸ“ watcher çš„ update æ–¹æ³•</p>\n<pre><code class=\"language-ts\">update() {\n    if (this.lazy) {\n        this.dirty = true\n    } else if (this.sync) {\n        this.run()\n    } else {\n        queueWatcher(this)\n    }\n\n}\n</code></pre>\n<p>è¿™é‡Œ æ¸²æŸ“ watcher ä¼šèµ° queueWatcher çš„é€»è¾‘ï¼Œè‡³äº lazy å’Œ sync ä¼šå’Œå…¶ä»–åŠŸèƒ½çš„å®ç°æœ‰å…³ç³»ï¼Œæˆ‘ä»¬åé¢å†ä¸“é—¨å»è®²ã€‚</p>\n<pre><code class=\"language-ts\">export function queueWatcher(watcher: Watcher) {\n    const id = watcher.id\n    if (has[id] != null) {\n        return\n    }\n    if (watcher === Dep.target &amp;&amp; watcher.noRecurse) {\n        return\n    }\n    has[id] = true\n    if (!flushing) {\n        queue.push(watcher)\n    } else {\n        let i = queue.length - 1\n        while (i &gt; index &amp;&amp; queue[i].id &gt; watcher.id) {\n            i--\n        }\n        queue.splice(i + 1, 0, watcher)\n    }\n\n    if (!waiting) {\n        waiting = true\n        nextTick(flushSchedulerQueue)\n    }\n}\n</code></pre>\n<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„é€»è¾‘å°±æ˜¯è®²å½“å‰çš„watcher push åˆ°é˜Ÿåˆ—ä¸­ï¼Œç„¶ååœ¨ nextTick çš„å›è°ƒä¸­æ‰§è¡Œ flushSchedulerQueueæ–¹æ³•ã€‚å› æ­¤æˆ‘ä»¬å¯çŸ¥ï¼Œå¹¶ä¸æ˜¯æ¯æ¬¡æ•°æ®æ›´æ–°ï¼Œè§†å›¾éƒ½ä¼šæ›´æ–°ï¼Œè€Œæ˜¯push åˆ°é˜Ÿåˆ—ä¸­ï¼Œè¿›è¡Œæ‰¹é‡æ›´æ–°ã€‚</p>\n<pre><code class=\"language-ts\">function flushSchedulerQueue() {\n    currentFlushTimestamp = getNow()\n    flushing = true\n    let watcher, id\n    queue.sort((a, b) =&gt; a.id - b.id)\n    for (index = 0; index &lt; queue.length; index++) {\n        watcher = queue[index]\n        if (watcher.before) {\n            watcher.before()\n        }\n        id = watcher.id\n        has[id] = null\n        watcher.run()\n    }\n\n    const activatedQueue = activatedChildren.slice()\n    const updatedQueue = queue.slice()\n    resetSchedulerState()\n    // è§¦å‘hook\n    callActivatedHooks(activatedQueue)\n    callUpdatedHooks(updatedQueue)\n}\n</code></pre>\n<p>flushSchedulerQueue é€»è¾‘ä¸ºï¼š</p>\n<ol>\n<li>å¯¹queueè¿›è¡Œæ’åº<ol>\n<li>ä¿è¯ çˆ¶ç»„ä»¶æ¯”å­ç»„ä»¶å…ˆæ›´æ–°</li>\n<li>ç”¨æˆ·è‡ªå®šä¹‰ watcher æ¯” æ¸²æŸ“ watcher å…ˆæ‰§è¡Œ</li>\n<li>å¦‚æœä¸€ä¸ªç»„ä»¶è¢«çˆ¶ç»„ä»¶ watcher æ‰§è¡Œæ—¶é”€æ¯ï¼Œé‚£ä¹ˆè¯¥ç»„ä»¶çš„watcher å¯ä»¥ä¸è¢«æ‰§è¡Œ</li>\n</ol>\n</li>\n<li>åœ¨éå†ä¸­æ‰§è¡Œwachter.run çš„æ–¹æ³•ï¼Œè€Œä¸”åœ¨watcher æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šæ·»åŠ æ–°çš„watcheråˆ°é˜Ÿåˆ—ï¼Œæ‰€ä»¥è¿™é‡Œç”¨äº†ä¼ ç»Ÿçš„ for å¾ªç¯ï¼Œæ¯æ¬¡éƒ½ä¼šåˆ¤æ–­ length<pre><code class=\"language-ts\">let i = queue.length - 1\nwhile (i &gt; index &amp;&amp; queue[i].id &gt; watcher.id) {\n i--\n}\nqueue.splice(i + 1, 0, watcher)\n</code></pre>\n</li>\n<li>æ‰§è¡Œ resetSchedulerState å‡½æ•°ï¼Œé‡ç½®çŠ¶æ€å’Œé˜Ÿåˆ—<pre><code class=\"language-ts\">function resetSchedulerState() {\n index = queue.length = activatedChildren.length = 0\n has = {}\n waiting = flushing = false\n}\n</code></pre>\n</li>\n</ol>\n<p>åœ¨ watcher.run å‡½æ•°ä¸­</p>\n<pre><code class=\"language-ts\">run() {\n    if (this.active) {\n        const value = this.get()\n        if (\n            value !== this.value ||\n            isObject(value) ||\n            this.deep\n        ) {\n            const oldValue = this.value\n            this.value = value\n            this.cb.call(this.vm, value, oldValue)\n        }\n    }\n}\n</code></pre>\n<p>run æ–¹æ³•ï¼Œå…ˆæ‰§è¡Œ get æ–¹æ³•ï¼Œç„¶åæ‰§è¡Œ å›è°ƒã€‚ å¯¹äºæ¸²æŸ“ watcher å°±æ˜¯æ‰§è¡Œ udpateComponent æ–¹æ³•ï¼Œå¯¹äºç”¨æˆ·è‡ªå®šä¹‰çš„watcher, ä¹Ÿå°±æ˜¯æ‰§è¡Œæˆ‘ä»¬å®šä¹‰æ‰§è¡Œçš„å›è°ƒã€‚</p>\n<h1 id=\"å››-å“åº”å¼å­˜åœ¨çš„é—®é¢˜\">å››. å“åº”å¼å­˜åœ¨çš„é—®é¢˜</h1>\n<p>åœ¨è¿›è¡Œä¸šåŠ¡å¼€å‘æ—¶ï¼Œæˆ‘ä»¬çŸ¥é“ç»™å¯¹è±¡æ·»åŠ æ–°çš„keyå€¼ï¼Œè§†å›¾ä¸ä¼šæ›´æ–°ï¼Œè¿™æ˜¯å› ä¸ºå½“å‰çš„key å€¼å¹¶æœªè¢«åŠ«æŒ, ä¸èƒ½è§¦å‘setter.</p>\n<p>è€Œæ•°ç»„æ”¹åŠ¨æŸä¸€é¡¹çš„å€¼ä¹Ÿå­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œè€Œæ•°ç»„æ˜¯å› ä¸ºåŠ«æŒçš„æ˜¯åŸå‹æ–¹æ³•ï¼Œç›´æ¥æ ¹æ®ç´¢å¼•æ”¹å€¼ä¹Ÿä¸ä¼šè§¦å‘ dep.notify çš„é€»è¾‘ã€‚</p>\n<p>è€Œæˆ‘ä»¬é’ˆå¯¹è¿™ç§æƒ…å†µä¼šä½¿ç”¨ $set å‡½æ•°è§£å†³è¿™ç§æƒ…å†µã€‚</p>\n<pre><code class=\"language-ts\">export function set(\ntarget: any[] | Record&lt;string, any&gt;,\nkey: any,\nval: any\n): any {\n\n\n    if (isArray(target) &amp;&amp; isValidArrayIndex(key)) {\n        target.length = Math.max(target.length, key)\n        target.splice(key, 1, val)\n        return val\n    }\n\n    if (key in target &amp;&amp; !(key in Object.prototype)) {\n        target[key] = val\n        return val\n    }\n\n    const ob = (target as any).__ob__\n\n    if ((target as any)._isVue || (ob &amp;&amp; ob.vmCount)) {\n        return val\n    }\n\n    if (!ob) {\n        target[key] = val\n        return val\n    }\n\n    defineReactive(ob.value, key, val)\n    ob.dep.notify()\n    return val\n}\n</code></pre>\n<ol>\n<li>å¦‚æœæ˜¯æ”¹å˜æ•°ç»„çš„å€¼ï¼Œå°±ä½¿ç”¨ splice æ–¹æ³•ï¼Œè§¦å‘æ›´æ–°</li>\n<li>å¦‚æœæœ¬èº«åœ¨targetä¸Šï¼Œç›´æ¥å¤åˆ¶å¹¶è¿”å›</li>\n<li>å¦‚æœ target ä¸æ˜¯å“åº”å¼å¯¹è±¡ï¼Œç›´æ¥èµ‹å€¼</li>\n<li>å¯¹å½“å‰target çš„ key å€¼è¿›è¡Œå“åº”å¼å¤„ç†</li>\n<li>é€šçŸ¥ dep æ›´æ–°</li>\n</ol>\n<h1 id=\"äº”-æ€»ç»“\">äº”. æ€»ç»“</h1>\n<p>çœ‹åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬çŸ¥é“äº† æ•°æ®åˆå§‹åŒ–æ—¶ æ˜¯å¦‚ä½•å˜æˆ å“åº”å¼æ•°æ®çš„ï¼Œç„¶åçŸ¥é“äº† ä¾èµ–å¦‚ä½•æ”¶é›†å’Œæ›´æ–°å¦‚ä½•æ´¾å‘ã€‚ è€Œä¸” æ•°æ®è§¦å‘æ›´æ–°ï¼Œå¹¶ä¸ä¼šç›´æ¥æ›´æ–°ï¼Œè€Œæ˜¯è¿›å…¥åˆ°é˜Ÿåˆ—ä¸­ï¼Œåœ¨nextTickçš„å›è°ƒä¸­è¿›è¡Œæ›´æ–°æ“ä½œã€‚</p>\n<p>åé¢æ–‡ç« ä¼šè®²ä¸‹ nextTick çš„é€»è¾‘ï¼Œè¿˜æœ‰åœ¨ watcher ä¸­æˆ‘ä»¬æ¼æ‰çš„é€»è¾‘ï¼Œè¿™ä¹Ÿä¼šæ¶‰åŠåˆ° computed å’Œ ç”¨æˆ·è‡ªå®šä¹‰ watcher çš„å®ç°ã€‚</p>\n<p>è¿™é‡Œè¡¥ä¸€å¼  æ€»ä½“çš„æµç¨‹å›¾\n<img src=\"https://ustbhuangyi.github.io/vue-analysis/assets/reactive.png\" alt=\"\"></p>\n",
        "title": "Vue æºç å­¦ä¹  (4) - å“åº”å¼ç¯‡",
        "created": "2022-07-03 16:42:54  ",
        "updated": "2022-07-03 16:42:54 ",
        "excerpt": "ä¸€. æ•°æ®åˆå§‹åŒ– å¦‚æœæœ‰äººé—® Vue çš„å“åº”å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå¤§å¤šæ•°äººä¼šå›ç­” é€šè¿‡æ•°æ®åŠ«æŒï¼Œåˆ©ç”¨ Object.defineProperty åŠ«æŒ getter å’Œ setter å®ç°çš„ã€‚æ•°æ®èµ‹å€¼æ—¶ï¼Œæ›´æ–°è§†å›¾ã€‚ç„¶åæ•°ç»„ é€šè¿‡é‡å†™æ•°ç»„çš„ pro...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "18"
    },
    "19": {
        "content": "<h1 id=\"å†™åœ¨å‰é¢\">å†™åœ¨å‰é¢</h1>\n<p>åœ¨å¹³æ—¶å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æ›´æ–°æ•°æ®åï¼Œéœ€è¦é€šè¿‡ nextTick çš„å›è°ƒä¸­æ‰èƒ½è·å–DOMã€‚</p>\n<pre><code class=\"language-ts\">this.value = 1\nthis.$nextTick(() =&gt; {\n    ...\n})\n</code></pre>\n<p>é€šè¿‡å‰é¢çš„æ–‡ç« æˆ‘ä»¬çŸ¥é“ï¼Œè¿™æ˜¯å› ä¸º Vueä¸­æ•°æ®æ›´æ–°åï¼Œè§†å›¾å¹¶ä¸æ˜¯ç«‹å³æ›´æ–°ï¼Œè€Œæ˜¯è¿›å…¥æ‰¹é‡æ›´æ–°çš„é˜Ÿåˆ—ä¸­ï¼Œè€Œæ‰¹é‡æ›´æ–°çš„é˜Ÿåˆ—ä¹Ÿæ˜¯åœ¨ nextTick çš„å›è°ƒï¼Œæ‰€ä»¥å½“ æ›´æ–°çš„å›è°ƒæ‰§è¡Œå®Œæˆåï¼Œæˆ‘ä»¬æ“ä½œdomçš„å›è°ƒæ‰§è¡Œæ—¶æ‰èƒ½æ­£ç¡®è·å–åˆ°DOMçš„çŠ¶æ€ã€‚</p>\n<p>æ‰€ä»¥æ¥çœ‹çœ‹nextTick</p>\n<h1 id=\"nexttick\">nextTick</h1>\n<pre><code class=\"language-ts\">export function nextTick(cb?: (...args: any[]) =&gt; any, ctx?: object) {\n    let _resolve\n    callbacks.push(() =&gt; {\n        if (cb) {\n        cb.call(ctx)\n        } else if (_resolve) {\n        _resolve(ctx)\n        }\n\n    })\n    if (!pending) {\n        pending = true\n        timerFunc()\n    }\n    if (!cb &amp;&amp; typeof Promise !== &#39;undefined&#39;) {\n    return new Promise(resolve =&gt; {\n        _resolve = resolve\n    })\n\n    }\n\n}\n</code></pre>\n<p>nextTick æ–¹æ³•å¯ä»¥å°† å›è°ƒå‡½æ•°æ¨å…¥åˆ° callbacks æ•°ç»„ä¸­ï¼Œå¦‚æœæœªä¼ å…¥ cbï¼Œ åˆ™ä¼šæ‰§è¡Œ resolveï¼Œ ä¿è¯ nextTickåçš„ thenå›è°ƒè¢«æ‰§è¡Œã€‚</p>\n<p>è¿™é‡Œä¼šæ‰§è¡Œ timeFunc å‡½æ•°</p>\n<pre><code class=\"language-ts\">const p = Promise.resolve()\ntimerFunc = () =&gt; {\n    p.then(flushCallbacks)\n    if (isIOS) setTimeout(noop)\n}\n...\ntimerFunc = () =&gt; {\n    setImmediate(flushCallbacks)\n}\n...\ntimerFunc = () =&gt; {\n    setTimeout(flushCallbacks, 0)\n}\n</code></pre>\n<p>è¿™é‡Œåšäº†å¾ˆå¤šå…¼å®¹ï¼Œæœ‰ä½¿ç”¨Promise çš„å¾®ä»»åŠ¡å›è°ƒç‰ˆæœ¬ï¼Œä¹Ÿæœ‰å®šæ—¶å™¨ç‰ˆæœ¬çš„å®ä»»åŠ¡ç‰ˆæœ¬ã€‚</p>\n<p>è¿™é‡Œä¿è¯nextTick å›è°ƒçš„æ‰§è¡Œå®é™…åœ¨ ä»»åŠ¡é˜Ÿåˆ—ä¸­å®Œæˆï¼Œæ‰§è¡Œ flushCallbacks</p>\n<pre><code class=\"language-ts\">function flushCallbacks() {\n    pending = false\n    const copies = callbacks.slice(0)\n    callbacks.length = 0\n    for (let i = 0; i &lt; copies.length; i++) {\n        copies[i]()\n    }\n}\n</code></pre>\n<p>å¹³æ—¶æˆ‘ä»¬ä½¿ç”¨çš„ $nextTick å°±æ˜¯ è¿™ä¸ªé€»è¾‘</p>\n<pre><code class=\"language-ts\">Vue.nextTick = nextTick\nVue.prototype.$nextTick = function (fn: (...args: any[]) =&gt; any) {\n    return nextTick(fn, this)\n}\n</code></pre>\n<h1 id=\"æ€»ç»“\">æ€»ç»“</h1>\n<p>é€šè¿‡å¯¹ nextTick çš„æºç å­¦ä¹ ï¼Œæˆ‘ä»¬çŸ¥é“äº† Vue çš„æ‰¹é‡æ›´æ–°æ˜¯ ä¸æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„é€»è¾‘é‡Œé¢ï¼Œè€Œæ˜¯åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­æ‰§è¡Œç›¸å…³çš„é€»è¾‘ã€‚</p>\n",
        "title": "Vue æºç å­¦ä¹  (5) - nextTick",
        "created": "2022-07-03 16:43:36  ",
        "updated": "2022-07-03 16:43:36 ",
        "excerpt": "å†™åœ¨å‰é¢ åœ¨å¹³æ—¶å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æ›´æ–°æ•°æ®åï¼Œéœ€è¦é€šè¿‡ nextTick çš„å›è°ƒä¸­æ‰èƒ½è·å–DOMã€‚ `ts this.value = 1 this.$nextTick(() => { ... }) ` é€šè¿‡å‰é¢çš„æ–‡ç« æˆ‘ä»¬çŸ¥é“ï¼Œè¿™æ˜¯å› ä¸º Vueä¸­æ•°...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "19"
    },
    "20": {
        "content": "<h1 id=\"ä¸€-å†™åœ¨å‰é¢\">ä¸€. å†™åœ¨å‰é¢</h1>\n<p>React ç”Ÿæ€çš„çŠ¶æ€ç®¡ç†åº“æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚Redux ï¼ŒRecoil ï¼ŒMobxï¼Œè‡ªèº«çš„ context  ä¹Ÿå¯ä»¥ç”¨æ¥è¿›è¡ŒçŠ¶æ€ç®¡ç†ã€‚</p>\n<p>é¦–å…ˆ Redux å®åœ¨è¯´ä¸ä¸Šæ˜¯ä¸€ä¸ªåˆæ ¼çš„çŠ¶æ€ç®¡ç†åº“ï¼ŒåŠŸèƒ½å¤ªåŸºç¡€ï¼Œç»“åˆä¸šåŠ¡å¿…é¡»ä½¿ç”¨æ’ä»¶ã€‚è€Œä¸”éœ€è¦å†™çš„æ¨¡ç‰ˆä»£ç å¤ªå¤šäº†ï¼Œå¼€å‘ä½“éªŒä¸€èˆ¬èˆ¬ã€‚</p>\n<p>è€Œ Mobx ä¹Ÿä¸å¤ªè¡Œï¼Œåœ¨ class ç»„ä»¶æµè¡Œæ—¶ï¼Œé€šè¿‡è£…é¥°å™¨å†™ Mobx è¿˜æ˜¯å¾ˆçˆ½çš„ã€‚ä½†æ˜¯ hooks æµè¡Œçš„ä»Šå¤©ï¼Œå‘ƒï¼Œå°±è¿™æ ·å§ã€‚</p>\n<p><a href=\"https://github.com/pmndrs/zustand\">Zustand</a> æ˜¯è¿™ä¹ˆå¤šçŠ¶æ€ç®¡ç†åº“ä¸­è®©æˆ‘çœ¼å‰ä¸€äº®çš„åº“ã€‚å®ƒçš„ä»£ç å¾ˆå°‘ï¼ŒåŠŸèƒ½å¾ˆå¤šã€‚</p>\n<h1 id=\"äºŒ-å®‰è£…\">äºŒ. å®‰è£…</h1>\n<pre><code class=\"language-shell\">npm install zustand \n</code></pre>\n<h1 id=\"ä¸‰-å¿«é€Ÿä½¿ç”¨\">ä¸‰. å¿«é€Ÿä½¿ç”¨</h1>\n<h2 id=\"31-å®šä¹‰store\">3.1 å®šä¹‰store</h2>\n<pre><code class=\"language-ts\">import create from &#39;zustand&#39;\n\nconst useStore = create((set) =&gt; ({\n  bears: 0,\n  increasePopulation: () =&gt; set((state) =&gt; ({ bears: state.bears + 1 })),\n  removeAllBears: () =&gt; set({ bears: 0 }),\n}))\n</code></pre>\n<p>åœ¨ create æ—¶ï¼Œ set æœ‰å‡ ç§ç”¨æ³•</p>\n<ul>\n<li><code>set(obj)</code>  obj ä¼šåˆå¹¶åˆ° stateä¸­</li>\n<li><code>set(state =&gt; obj)</code>  å‡½æ•°è¿”å›å€¼åˆå¹¶åˆ° state ä¸­</li>\n<li><code>set(obj, true) </code> obj ä¼šå–ä»£å½“å‰ state</li>\n</ul>\n<p>create å‡½æ•°ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ <code>get</code>ï¼Œ æˆ‘ä»¬å¯ä»¥é€šè¿‡ get è·å–å½“å‰çš„ state</p>\n<h2 id=\"32-åœ¨ç»„ä»¶ä¸­ä½¿ç”¨\">3.2 åœ¨ç»„ä»¶ä¸­ä½¿ç”¨</h2>\n<pre><code class=\"language-ts\">function BearCounter() {\n  const bears = useStore((state) =&gt; state.bears)\n  return &lt;h1&gt;{bears} around here ...&lt;/h1&gt;\n}\n\nfunction Controls() {\n  const increasePopulation = useStore((state) =&gt; state.increasePopulation)\n  return &lt;button onClick={increasePopulation}&gt;one up&lt;/button&gt;\n}\n</code></pre>\n<p>ä¸Šé¢éƒ½æ˜¯æˆ‘ä»å®˜ç½‘ä¸­ copy çš„ä»£ç ï¼Œå®é™…å¼€å‘ä¹Ÿå°±æ˜¯è¿™ä¹ˆå†™çš„ã€‚å¯ä»¥çœ‹å‡ºï¼Œå®ƒçš„ä»£ç çœŸçš„éå¸¸çš„å°‘ï¼Œæˆ‘éœ€è¦ä»€ä¹ˆï¼Œæˆ‘å°±å®šä¹‰ä»€ä¹ˆã€‚</p>\n<h1 id=\"å››-ä¼˜åŠ¿\">å››. ä¼˜åŠ¿</h1>\n<p>å’Œ redux æ¯”ï¼š</p>\n<ol>\n<li>ç®€å•</li>\n<li>hooks å‹å¥½</li>\n<li>ä¸éœ€è¦ context provider</li>\n<li>å¯ä»¥å’Œç»„ä»¶æ¸²æŸ“è§£è€¦ï¼Œåªæ›´æ”¹çŠ¶æ€\n```ts\nconst useStore = create(set =&gt; ({ scratches: 0, ... }))</li>\n</ol>\n<p>function Component() {\n  const scratchRef = useRef(useStore.getState().scratches)\n  useEffect(() =&gt; useStore.subscribe(\n    state =&gt; (scratchRef.current = state.scratches)\n  ), [])</p>\n<pre><code>\nå’Œ context æ¯”ï¼š\n1. æ›´å°‘çš„æ¨¡ç‰ˆä»£ç \n2. åªåœ¨æ•°æ®å˜åŒ–æ—¶æ›´æ–°ç»„ä»¶\n3. é›†ä¸­çš„ã€åŸºäºæ“ä½œçš„çŠ¶æ€ç®¡ç†\n\n# äº”. æ’ä»¶\n```ts\nconst log = (config) =&gt; (set, get, api) =&gt;\n  config(\n    (...args) =&gt; {\n      console.log(&#39;  applying&#39;, args)\n      set(...args)\n      console.log(&#39;  new state&#39;, get())\n    },\n    get,\n    api\n  )\n\nconst useStore = create(\n  log((set) =&gt; ({\n    bees: false,\n    setBees: (input) =&gt; set({ bees: input }),\n  }))\n)\n</code></pre>\n<p><code>Zustand</code>çš„æ’ä»¶ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯å®šä¹‰ä¸€ä¸ªå‡½æ•°ã€‚ ä¸Šé¢è¿™ä¸ª log æ’ä»¶ä¹Ÿé€»è¾‘å¾ˆæ¸…æ™°ï¼Œåœ¨create å†…æ‰§è¡Œæ—¶ï¼Œå¯¹set æ–¹æ³•è¿›è¡Œè¦†å†™ï¼Œå®ç° log çš„æ•ˆæœ</p>\n<p>æˆ‘åœ¨RN ä¸­å¼€å‘ä¸­éœ€è¦å¯¹æ•°æ®è¿›è¡ŒæŒä¹…åŒ–ï¼Œäºæ˜¯æˆ‘å¯ä»¥è¿™ä¹ˆå†™</p>\n<pre><code class=\"language-ts\">TODO\n</code></pre>\n<h1 id=\"å…­-æ€»ç»“\">å…­. æ€»ç»“</h1>\n<p>Zustand æ˜¯ä¸€ä¸ªä¼˜ç§€çš„æ•°æ®ç®¡ç†åº“ï¼Œå¯ä»¥å¾ˆå¥½çš„ç®¡ç†åº”ç”¨çš„çŠ¶æ€ã€‚é€»è¾‘ç®€å•ï¼Œå¯å®šåˆ¶åŒ–å¼ºã€‚å¼€å‘ React åº”ç”¨ï¼ŒZustand æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚</p>\n",
        "title": "ç®€å•åˆå¼ºå¤§çš„çŠ¶æ€ç®¡ç† - Zustand",
        "created": "2022-07-07 16:11:21  ",
        "updated": "2022-07-07 16:11:21 ",
        "excerpt": "ä¸€. å†™åœ¨å‰é¢ React ç”Ÿæ€çš„çŠ¶æ€ç®¡ç†åº“æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚Redux ï¼ŒRecoil ï¼ŒMobxï¼Œè‡ªèº«çš„ context ä¹Ÿå¯ä»¥ç”¨æ¥è¿›è¡ŒçŠ¶æ€ç®¡ç†ã€‚ é¦–å…ˆ Redux å®åœ¨è¯´ä¸ä¸Šæ˜¯ä¸€ä¸ªåˆæ ¼çš„çŠ¶æ€ç®¡ç†åº“ï¼ŒåŠŸèƒ½å¤ªåŸºç¡€ï¼Œç»“åˆä¸šåŠ¡å¿…é¡»ä½¿ç”¨æ’ä»¶ã€‚è€Œä¸”éœ€è¦...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "20"
    },
    "21": {
        "content": "<h1 id=\"hooks-å‡ºç°çš„åŸå› \">hooks å‡ºç°çš„åŸå› </h1>\n<ol>\n<li><p>class è‡ªèº«å­˜åœ¨çš„é—®é¢˜</p>\n<ol>\n<li>ç»„ä»¶é€»è¾‘å¤ç”¨å›°éš¾ï¼Œå°½ç®¡æ‹¥æœ‰HOC å’Œrender props ï¼Œé€»è¾‘å¤ç”¨è¿˜æ˜¯æ¯”è¾ƒå›°éš¾ã€‚</li>\n<li>åœ¨ä¸åŒç”Ÿå‘½å‘¨æœŸä¸­æ‰§è¡Œä¸åŒçš„é€»è¾‘ï¼Œç»„ä»¶ä¼šå˜å¾—è¶Šæ¥è¶Šå¤æ‚ã€‚ç›¸å…³çš„é€»è¾‘ä¸å¥½æŠ½ç¦»</li>\n<li>ä½¿ç”¨Class ç»„ä»¶åªä¸ºäº†ç»„ä»¶å®šä¹‰çŠ¶æ€ï¼Œè§†å›¾å’Œé€»è¾‘ï¼Œå…¶å®æ²¡æœ‰ç”¨åˆ°Class çš„å¤ªå¤šåŠŸèƒ½ã€‚è€Œä¸”è¿˜éœ€è¦å¤„ç† thisçš„ç»‘å®š</li>\n<li>é€šè¿‡this è¯»å–çŠ¶æ€ï¼Œæ˜¯æœ‰å‰¯ä½œç”¨çš„ã€‚å¹¶ä¸èƒ½ç¡®ä¿çŠ¶æ€çš„æ­£ç¡®æ€§\n```tsx\nclass ProfilePage extends React.Component { \n showMessage = () =&gt; {\n alert(&#39;Followed &#39; + this.props.user); \n };</li>\n</ol>\n<p> handleClick = () =&gt; { \n     setTimeout(this.showMessage, 3000); \n }; \n render() {\n     return &lt;button onClick{this.handleClick}&gt;\n         Follow</button>; \n }</p>\n</li>\n</ol>\n<p>}</p>\n<pre><code>ä¾‹å¦‚è¿™ä¸ªç»„ä»¶ï¼Œç‚¹å‡»å‘ç”Ÿåï¼Œå¦‚æœpropsæ”¹å˜ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„å¼¹å‡ºçš„æ•°æ®å¹¶ä¸ç¬¦åˆç‚¹å‡»æ—¶çš„é¢„æœŸ\n\n2. å¢å¼ºå‡½æ•°ç»„ä»¶\n\nä¹‹å‰ç‰ˆæœ¬çš„å‡½æ•°ç»„ä»¶å¤ªè¿‡é¸¡è‚‹ï¼Œåªèƒ½ç”¨äºå±•ç¤ºï¼Œè‡ªèº«ä¸æ‹¥æœ‰çŠ¶æ€ã€‚\n\n\n# hooks å­˜åœ¨çš„é—®é¢˜\n## ä½¿ç”¨åœºæ™¯é™åˆ¶\n\nReact hook ä¸èƒ½åœ¨åˆ¤æ–­è¯­å¥ä¸­ä½¿ç”¨\n```ts\ncosnt [count, setCount] = useState(0)\nif(count == 2) {\n   const [num, setNum] = useState(1)\n}\n...\n</code></pre>\n<p>å…·ä½“åŸå› æ˜¯å’Œ hook çš„åŸç†æœ‰å…³ã€‚ hook é€šè¿‡é—­åŒ…ç»´æŠ¤çŠ¶æ€ï¼Œç„¶åå°†æ¯ä¸ªhooksæ³¨å†Œåˆ°ä¸€ä¸ªé“¾è¡¨ä¸­è¿›è¡Œå­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯è¯´ hook æœ¬èº«å–å€¼æ˜¯æœ‰é¡ºåºçš„ã€‚ </p>\n<p>å½“ç»„ä»¶æ›´æ–°æ—¶ï¼Œhooké‡æ–°æ‰§è¡Œï¼Œå¦‚æœé€šè¿‡æ¡ä»¶è¯­å¥æ–°å¢æˆ–è€…å‡å°‘ hook éƒ½ä¼šå½±å“åˆ°åŸæœ‰é“¾è¡¨çš„é¡ºåºï¼Œé€ æˆå–å€¼å¼‚å¸¸ã€‚</p>\n<h2 id=\"é—­åŒ…é™·é˜±\">é—­åŒ…é™·é˜±</h2>\n<p>å½“æˆ‘ä»¬ä½¿ç”¨ useEffect æ—¶ï¼Œä¸åŒçš„ä¾èµ–é¡¹ä¼šæœ‰ä¸åŒçš„æ•ˆæœã€‚ å½“æˆ‘ä»¬ä¼ å…¥ç©ºæ•°ç»„æ—¶ï¼Œ æ­¤æ—¶çš„ useEffect ç›¸å½“äº componentDidMount. åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚ç»“åˆå‡½æ•°ä½¿ç”¨æ—¶ï¼Œå°±æœ‰å¯èƒ½äº§ç”Ÿçš„é—®é¢˜ã€‚</p>\n<pre><code class=\"language-ts\">export default function App() {\n  const [count, setCount] = useState(0);\n  useEffect(() =&gt; {\n    const timer = setInterval(() =&gt; {\n      console.log(count);\n    }, 3000);\n  }, []);\n  return (\n    &lt;div className=&quot;App&quot;&gt;\n      &lt;h1&gt; {count}&lt;/h1&gt;\n      &lt;h2 onClick={() =&gt; setCount(count + 1)}&gt;\n        Start editing to see some magic happen!\n      &lt;/h2&gt;\n    &lt;/div&gt;\n  );\n}\n</code></pre>\n<p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œ å®šæ—¶å™¨é€šè¿‡é—­åŒ…è·å–çš„å˜é‡æ°¸è¿œéƒ½æ˜¯ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶çš„ countï¼Œ å¯¼è‡´æ‰“å°çš„éƒ½æ˜¯ 0.</p>\n<p>å…¶å®ä¸æ­¢å®šæ—¶å™¨ï¼Œè¿˜æœ‰åœ¨ useEffect å¤–éƒ¨å®šä¹‰çš„å‡½æ•°ï¼Œéƒ½æœ‰å¯èƒ½äº§ç”Ÿè¿™ä¸ªé—®é¢˜ã€‚</p>\n<p>è§£å†³åŠæ³•ï¼š</p>\n<ol>\n<li>useEffect æ·»åŠ ä¾èµ–ï¼Œå†…éƒ¨å‡½æ•°ä½¿ç”¨åˆ°äº†å“ªä¸ªå˜é‡ï¼Œå°±åŠ å…¥åˆ°ä¾èµ–é¡¹ã€‚å‡½æ•°ä¹Ÿæ˜¯å¦‚æ­¤<pre><code class=\"language-ts\"> const [count, setCount] = useState(0);\n  useEffect(() =&gt; {\n const timer = setInterval(() =&gt; {\n   console.log(count);\n }, 3000);\n return () =&gt; {\n   clearInterval(timer)\n }\n  }, [count]);\n</code></pre>\n</li>\n<li>ä½¿ç”¨useRef, ç”±äº refæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„ current æ‰æŒ‡å‘çœŸå®çš„å€¼ã€‚æ‰€ä»¥å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜</li>\n</ol>\n",
        "title": "æˆ‘æ‰€ç†è§£çš„ React Hooks ",
        "created": "2022-07-09 09:28:43  ",
        "updated": "2022-07-09 16:05:44 ",
        "excerpt": "hooks å‡ºç°çš„åŸå›  class è‡ªèº«å­˜åœ¨çš„é—®é¢˜ ç»„ä»¶é€»è¾‘å¤ç”¨å›°éš¾ï¼Œå°½ç®¡æ‹¥æœ‰HOC å’Œrender props ï¼Œé€»è¾‘å¤ç”¨è¿˜æ˜¯æ¯”è¾ƒå›°éš¾ã€‚ åœ¨ä¸åŒç”Ÿå‘½å‘¨æœŸä¸­æ‰§è¡Œä¸åŒçš„é€»è¾‘ï¼Œç»„ä»¶ä¼šå˜å¾—è¶Šæ¥è¶Šå¤æ‚ã€‚ç›¸å…³çš„é€»è¾‘ä¸å¥½æŠ½ç¦» ä½¿ç”¨Class ç»„ä»¶åªä¸ºäº†...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "21"
    },
    "22": {
        "content": "<h1 id=\"å†™åœ¨å‰é¢\">å†™åœ¨å‰é¢</h1>\n<p>ä»Šå¹´æ˜¯æ¯•ä¸šçš„ç¬¬ä¸‰å¹´ï¼Œä¹Ÿæ˜¯æˆ‘ä»äº‹å‰ç«¯å¼€å‘çš„ç¬¬ä¸‰å¹´ã€‚ç›¸æ¯”äºåˆšæ¯•ä¸šæ—¶ç”¨ Vue éƒ½ä¸å¤ªç†Ÿç»ƒçš„æ–°æ‰‹ï¼Œç°åœ¨çš„æˆ‘å¯ä»¥ç®—çš„ä¸Šæ˜¯ä¸€åé è°±çš„å‰ç«¯å¼€å‘ã€‚å¯¹äºå‰ç«¯è¿™ä¸€é¢†åŸŸï¼Œæˆ‘ä¹Ÿæœ‰äº†ä¸€äº›è‡ªå·±çš„æ€è€ƒã€‚</p>\n<h1 id=\"å­¦ä¹ \">å­¦ä¹ </h1>\n<p>å†…å·è¿™ä¸ªè¯è¯­æ˜¯è¿‘å‡ å¹´çš„çƒ­è¯ã€‚ä½œä¸ºç¨‹åºå‘˜ï¼Œæˆ‘ä»æŠ€æœ¯ç½‘ç«™ï¼Œç¤¾äº¤å¹³å°ç»å¸¸ä¼šæ¥æ”¶åˆ°å„ç§æ¸²æŸ“ç„¦è™‘ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ä¼šé€¼ç€æˆ‘ä»¬å†…å·ï¼Œå­¦ä¹ ã€‚</p>\n<p>æˆ‘ä¸€ç›´è¦æ±‚è‡ªå·±æˆä¸ºä¸å¯æ›¿ä»£çš„é‚£ç§æŠ€æœ¯äººæ‰ï¼Œè€Œä¸æ˜¯ CRUD boyï¼Œä¸ºæ­¤æˆ‘ä¹Ÿåšäº†å¾ˆå¤šåŠªåŠ›ã€‚åŸºæœ¬ä¸Šçš„æ—¶é—´éƒ½æ˜¯åœ¨å­¦ä¹ ï¼Œçœ‹æŠ€æœ¯è§†é¢‘ï¼Œåšå®¢ã€‚ä½†æ˜¯å­¦ä¹ çœŸçš„ç”±å‡è½»è‡ªå·±çš„å¿ƒé‡Œå‹åŠ›å—ï¼Œèƒ½å¤Ÿä¿è¯è‡ªå·±æœªæ¥ä¸å¤±ä¸šï¼Œä¸35å²é€å¤–å–å—ï¼Ÿ </p>\n<p>å…¶å®ä¸èƒ½ï¼è‡³å°‘å¯¹äºæˆ‘æ¥è¯´æ˜¯ä¸èƒ½çš„ï¼Œæˆ‘ä¾æ—§æ„Ÿè§‰åˆ°ç„¦è™‘ï¼Œä¾æ—§å¯¹æœªæ¥æ²¡æœ‰å¸Œæœ›ã€‚æˆ‘ä¼šå› ä¸ºæŠ€æœ¯ç„¦è™‘ä¹°ä¸€äº›è¯¾ç¨‹ï¼Œæˆ–è€…å­¦ä¹ ç›®å‰æ ¹æœ¬ç”¨ä¸åˆ°çš„ä¸œè¥¿ï¼ˆ3Dæ¸²æŸ“ï¼ŒC++, Flutterï¼‰ï¼Œä½†æ˜¯éƒ½æ²¡æœ‰å¾ˆå¥½çš„å­¦ä¹ ä¸‹å»ã€‚</p>\n<p>å‰ç«¯çš„æŠ€æœ¯æ›´è¿­å¾ˆå¿«ï¼Œå„ç§åŒ…ç®¡ç†ï¼Œæ„å»ºå·¥å…·ï¼Œè¯­è¨€ï¼Œæ¡†æ¶å±‚å‡ºä¸ç©·ã€‚ä»Šå¤©æˆ‘çœ‹äº†è¿™ä¸ªæºç ï¼Œæ˜å¤©å­¦ä¼šäº†é‚£ä¸ªå·¥å…·ã€‚è¿½é€æŠ€æœ¯çš„è¿‡ç¨‹æ˜¯æ¯”è¾ƒç´¯çš„ã€‚</p>\n<p>ç°åœ¨çš„æˆ‘ç†è§£åˆ°ï¼Œåªæœ‰çœŸæ­£çš„ä¸šåŠ¡å®è·µæ‰æ˜¯æœ€å¥½çš„å­¦ä¹ æ–¹æ³•ï¼Œ è€Œæˆ‘æ›´åº”è¯¥æŒæ¡çš„æ˜¯å¦‚ä½•å¿«é€Ÿå­¦ä¹ çš„èƒ½åŠ›ã€‚</p>\n<p>æ¯”å¦‚æˆ‘è´Ÿè´£çš„ä¸€ä¸ªç§»åŠ¨ç«¯APPçš„å¼€å‘éœ€æ±‚ï¼Œä»æŠ€æœ¯é¢„ç ”ï¼Œç›¸å…³æ¡†æ¶å’Œè¯­è¨€å­¦ä¹ ï¼Œåˆ°åé¢åŒæ­¥ç»™åŒäº‹å­¦ä¹ ï¼Œå¿«é€Ÿå¼€å‘ä¸šåŠ¡ã€‚æ•´ä½“çš„æ—¶é—´èŠ±è´¹æ˜¯æ¯”è¾ƒå°‘çš„ï¼Œå› ä¸ºæˆ‘çŸ¥é“äº†å¦‚ä½•å¿«é€Ÿçš„å»å­¦ä¹ ã€‚</p>\n<p>å…³äºå­¦ä¹ çš„æ–¹å‘ï¼Œæˆ‘ç°åœ¨æ˜¯æ¯”è¾ƒæ˜ç¡®çš„ã€‚JS/TS ç¼–ç¨‹è¯­è¨€ç²¾é€šï¼ŒUIæ¡†æ¶ç†Ÿç»ƒæŒæ¡ï¼Œæ‰©å±•è‡ªå·±ç§»åŠ¨ç«¯åŸç”Ÿå¼€å‘çš„èƒ½åŠ›ï¼Œç†Ÿæ‚‰åç«¯çš„æŠ€æœ¯ã€‚æ€»çš„æ¥è¯´å°±æ˜¯ å‰ç«¯æœ‰æ·±åº¦ï¼ŒæŠ€æœ¯æœ‰å¹¿åº¦ã€‚</p>\n<h1 id=\"å’Œåç«¯çš„æ¯”è¾ƒ\">å’Œåç«¯çš„æ¯”è¾ƒ</h1>\n<p>å¾ˆå¤šäººè¯´å‰ç«¯æ˜¯å¨±ä¹åœˆï¼Œæ²¡æœ‰ä»€ä¹ˆæŠ€æœ¯é—¨æ§›ã€‚åˆšå…¥é—¨æ—¶æˆ‘å¬åˆ°è¿˜æ˜¯ä¼šæœ‰ç‚¹ä¸å¼€å¿ƒçš„ï¼Œè§‰å¾—è‡ªå·±çš„å·¥ä½œè¢«äººè´¬ä½ï¼Œè€Œä¸”ä½œä¸ºéç§‘ç­å‡ºèº«ï¼Œä¸å¯é¿å…ä¼šæœ‰ä¸è‡ªä¿¡çš„å¿ƒæ€ã€‚</p>\n<p>è€Œå¯¹äºç°åœ¨çš„æˆ‘æ¥è¯´ï¼Œæˆ‘åè€Œåº†å¹¸å‰ç«¯çš„é—¨æ§›ä½ã€‚æˆ‘èƒ½é€šè¿‡è‡ªå­¦å¿«é€Ÿçš„æ‰¾åˆ°ä¸€ä»½å‰ç«¯çš„å·¥ä½œï¼Œè€Œä¸”åœ¨å·¥ä½œä¸­è·å¾—æŒç»­çš„æˆå°±æ„Ÿã€‚åˆ°ç°åœ¨ä¸‰å¹´äº†ï¼Œæˆ‘åœ¨å·¥ä½œä¸­è·å¾—çš„æˆå°±æ„Ÿä»æœªä¸­æ–­ã€‚</p>\n<p>åç«¯çš„ç¡®æ¯”å‰ç«¯å¤æ‚ï¼Œåç«¯çš„å¼€å‘ä½“éªŒå’Œå¼€å‘æµç¨‹ååˆ†çš„å®Œæ•´ï¼Œå·¥ä¸šåŒ–ç¨‹åº¦ååˆ†çš„é«˜ã€‚å‰ç«¯å…¶å®èµ·åŠ¿ä¹Ÿå°±è¿™åå‡ å¹´ï¼ŒJSå˜æˆä¸€é—¨è¿˜ç®—å¯ä»¥çš„è¯­è¨€ä¹Ÿå°±è¿™å‡ å¹´ã€‚è€Œä¸”å¯¹äºå¤šäººç»´æŠ¤çš„é¡¹ç›®æ¥è¯´ï¼ŒJSç®—ä¸å¾—ä¸Šæ˜¯å¥½è¯­è¨€ï¼Œçµæ´»çš„ä¼˜ç‚¹å¸¦æ¥çš„ç¼ºç‚¹æ›´å¤šã€‚è¿˜å¥½æˆ‘ä»¬æœ‰TSï¼Œ æˆ‘å¯ä»¥è‡ªä¿¡çš„è¯´ï¼ŒTS æ”¹å˜äº†å‰ç«¯ã€‚</p>\n<p>å¯èƒ½å¯¹äºå¾ˆå¤šé¡¹ç›®æ¥è¯´ï¼Œå¤æ‚çš„ä¸šåŠ¡é€»è¾‘éƒ½ç”±åç«¯æ¥å¤„ç†ï¼Œå‰ç«¯åšçš„éƒ½æ˜¯ä¸€äº›é¡µé¢äº¤äº’ï¼Œæ²¡æœ‰<strong>å«é‡‘é‡</strong>ã€‚å¯¹ä¹Ÿä¸å®Œå…¨å¯¹ï¼Œç”¨æˆ·äº¤äº’åœ¨æˆ‘çœ‹æ¥å’ŒåŠŸèƒ½æ¥è¯´ä¸€æ ·é‡è¦ã€‚å¾ˆå¤šæ—¶å€™äº§å“æƒ³çš„å’Œç”¨æˆ·å®é™…ä½¿ç”¨çš„æ ¹æœ¬å¯¹ä¸ä¸Šï¼Œäº¤äº’æ˜¯äº§å“å’Œç”¨æˆ·äº¤æµçš„ç¬¬ä¸€çº¿ï¼Œå¥½çš„äº¤äº’æœ‰åˆ©äºæˆå°±ä¼Ÿå¤§çš„äº§å“ã€‚å‰ç«¯å¹³æ—¶å¼€å‘æ—¶ä¹Ÿåº”è¯¥å¤šæƒ³æƒ³äº¤äº’ï¼ŒæŠŠè‡ªå·±ä½œä¸ºç¬¬ä¸€ä¸ªæµ‹è¯•å’Œç”¨æˆ·æ¥ä½“éªŒäº§å“ã€‚å†™å‡ºæ¶å¿ƒäººçš„äº¤äº’æ˜¯å¯¹å‰ç«¯å·¥ä½œçš„ä¾®è¾±ã€‚</p>\n<p>å¯¹äºç°åœ¨çš„å‰ç«¯ï¼Œå…¶å®ä¸šåŠ¡é€»è¾‘ä¹Ÿä¸ç®€å•ã€‚æˆ‘åšè¿‡ä¸šåŠ¡åŒ…å«ç¼–è¾‘å™¨ï¼Œå¤§éƒ¨åˆ†çš„ä¸šåŠ¡é€»è¾‘éƒ½åœ¨å‰ç«¯ã€‚åç«¯çš„ä¸šåŠ¡åªæœ‰æ•°æ®å­˜å‚¨å’Œæ–‡ä»¶å†™å…¥ã€‚è€Œä¸”ç°åœ¨å¾ˆå¤šåœ¨çº¿æ–‡æ¡£ï¼Œç¬”è®°æˆ–è€…å…¶ä»–å·¥å…·ï¼Œå®ƒä»¬çš„å‰ç«¯ä¸šåŠ¡ä¹Ÿå¾ˆå¤æ‚ã€‚æ¡Œé¢åº”ç”¨ç½‘é¡µåŒ–æ˜¯æ½®æµæ‰€å‘ï¼Œæ‰€ä»¥å‰ç«¯ä¸ä»…åªæœ‰é¡µé¢ï¼Œæˆ‘ä»¬çš„æœªæ¥æ˜¯ä¸€ç¯‡è“æµ·ã€‚</p>\n<h2 id=\"æˆ‘çš„å›°æƒ‘\">æˆ‘çš„å›°æƒ‘</h2>\n<p>å‰é¢è®²äº†å¾ˆå¤šä¸œè¥¿ï¼Œç°åœ¨æˆ‘è®²ä¸€ä¸‹æˆ‘çš„ä¸€äº›ç–‘æƒ‘ç‚¹å§ï¼Œå¸Œæœ›æœªæ¥çš„è‡ªå·±èƒ½å¤Ÿè§£ç­”è¿™äº›é—®é¢˜</p>\n<ol>\n<li>ç»„ä»¶å’Œæ ·å¼çš„è¾¹ç•Œåœ¨å“ªé‡Œï¼Œå¦‚æœåªæ˜¯æ ·å¼ä¸€è‡´ï¼Œæœ‰å¿…è¦æŠ½ç¦»æˆç»„ä»¶å—ï¼Ÿ</li>\n<li>å¾ˆå¤šå¼€å‘éƒ½æ¸æ¸å˜æˆäº† chrome å‰ç«¯å·¥ç¨‹å¸ˆï¼Œè¿™ç§è¶‹åŠ¿å¥½å—ï¼Ÿ</li>\n<li>CSSçš„å…¼å®¹é—®é¢˜ï¼Œå¦‚æœä¸€ç§å†™æ³•æœ‰ 90% çš„ç”¨æˆ·æ˜¾ç¤ºæ­£å¸¸ï¼Œæ˜¯å¦éœ€è¦å¯¹10% å†™æ›´å¤šçš„hackä»£ç ï¼Ÿ</li>\n<li>utility css ç±»æ¡†æ¶ä¾‹å¦‚ tailwind css å˜å¾—æµè¡Œï¼Œä½†æ˜¯å¼€å‘çš„ä»£ç å¦‚ä½•å»ç»´æŠ¤ï¼Ÿ</li>\n</ol>\n",
        "title": "å·¥ä½œä¸‰å¹´ï¼Œæˆ‘å¯¹å‰ç«¯é¢†åŸŸçš„å›°æƒ‘",
        "created": "2022-07-30 15:42:12  ",
        "updated": "2022-10-07 13:01:22 ",
        "excerpt": "å†™åœ¨å‰é¢ ä»Šå¹´æ˜¯æ¯•ä¸šçš„ç¬¬ä¸‰å¹´ï¼Œä¹Ÿæ˜¯æˆ‘ä»äº‹å‰ç«¯å¼€å‘çš„ç¬¬ä¸‰å¹´ã€‚ç›¸æ¯”äºåˆšæ¯•ä¸šæ—¶ç”¨ Vue éƒ½ä¸å¤ªç†Ÿç»ƒçš„æ–°æ‰‹ï¼Œç°åœ¨çš„æˆ‘å¯ä»¥ç®—çš„ä¸Šæ˜¯ä¸€åé è°±çš„å‰ç«¯å¼€å‘ã€‚å¯¹äºå‰ç«¯è¿™ä¸€é¢†åŸŸï¼Œæˆ‘ä¹Ÿæœ‰äº†ä¸€äº›è‡ªå·±çš„æ€è€ƒã€‚ å­¦ä¹  å†…å·è¿™ä¸ªè¯è¯­æ˜¯è¿‘å‡ å¹´çš„çƒ­è¯ã€‚ä½œä¸ºç¨‹åºå‘˜ï¼Œæˆ‘ä»æŠ€æœ¯...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "22"
    },
    "23": {
        "content": "<h1 id=\"ä¸€-å†™åœ¨å‰é¢\">ä¸€. å†™åœ¨å‰é¢</h1>\n<p>ä¹‹å‰æ–‡ç« è®²äº† SDKå¼€å‘çš„èƒŒæ™¯ï¼Œå’Œå…·ä½“å°è£…çš„é€»è¾‘ã€‚æœ€è¿‘æœ‰ç”¨æˆ·ä½¿ç”¨æˆ‘çš„SDKè¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œå¯¹æ¥çš„è¿‡ç¨‹ä¸­æˆ‘å‘ç°SDKå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚ ä½¿ç”¨æ–¹å¼ï¼Œå¯¹æ¥æ–¹å¼ã€‚å› æ­¤æˆ‘æ ¹æ®è¿™äº›é—®é¢˜ï¼Œå°†SDKè¿›è¡Œäº†é‡æ„ã€‚</p>\n<h1 id=\"äºŒ-é‡æ„\">äºŒ. é‡æ„</h1>\n<p>æ¡†æ¶é€šè¿‡æš´éœ²å…¨å±€å‡½æ•°çš„æ–¹å¼æ¥æš´éœ²èƒ½åŠ›ï¼Œç¬¬ä¸‰æ–¹é€šè¿‡è¦†å†™å¯¹åº”çš„å‡½æ•°æ¥å®ç°èƒ½åŠ›çš„è°ƒç”¨ã€‚</p>\n<p>æˆ‘å¼€å‘çš„SDKè®²è¿™äº›å…¨å±€å‡½æ•°å†æ¬¡è¿›è¡Œå°è£…ï¼Œé€šè¿‡ å‘å¸ƒè®¢é˜… çš„è®¾è®¡æ¨¡å¼è¿›è¡Œé€šä¿¡ã€‚ä½†æ˜¯SDK çš„æš´éœ²æ–¹å¼è¿˜æ˜¯é€šè¿‡å…¨å±€å¯¹è±¡è¿›è¡Œæš´éœ²ï¼Œç¬¬ä¸‰æ–¹åœ¨è¿›è¡ŒäºŒæ¬¡å¼€å‘æ—¶ï¼Œéœ€è¦è®²ä»–ä»¬çš„JS æ”¾åˆ° æˆ‘ä»¬çš„JS é€»è¾‘ä¹‹ä¸‹æ‰èƒ½è¿è¡Œã€‚è€Œä¸”é€š\nè¿‡å…¨å±€å˜é‡è¿™ç§æ–¹å¼ï¼Œæ— æ³•è¿›è¡Œå‹å¥½çš„ç±»å‹æç¤ºï¼Œæ ¹æ®æ–‡æ¡£è¿›è¡Œå¼€å‘ï¼Œå¼€å‘ä½“éªŒä¸æ˜¯å¾ˆå‹å¥½ã€‚</p>\n<p>æ‰€ä»¥æˆ‘å¯¹SDKè¿›è¡Œäº†æŠ½ç¦»ï¼Œå˜ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ NPM åŒ…ã€‚ç¬¬ä¸‰æ–¹å¼€å‘æ—¶å¯ä»¥é€šè¿‡å¼•å…¥NPMåŒ…çš„å½¢å¼è¿›è¡Œå¼€å‘ã€‚</p>\n<h2 id=\"2-1-ç¯å¢ƒ\">2. 1 ç¯å¢ƒ</h2>\n<ul>\n<li>æ„å»ºå·¥å…· ï¼š Vite</li>\n<li>æ’ä»¶ï¼š <a href=\"https://www.npmjs.com/package/rollup-plugin-typescript2\">rollup-plugin-typescript2</a></li>\n<li>è¯­è¨€ï¼šTypeScript</li>\n</ul>\n<p>ä½¿ç”¨ <code>rollup-plugin-typescript2</code> å¯ä»¥åœ¨æ‰“åŒ…æ—¶ç”Ÿæˆ <code>.d.ts</code> æ–‡ä»¶ï¼Œå…¶ä»–äººåœ¨ä½¿ç”¨æˆ‘ä»¬çš„åŒ…æ—¶ï¼Œé€šè¿‡JSå¼€å‘ä¹Ÿèƒ½è·å¾—ç±»å‹æé†’ï¼Œä½¿ç”¨ä½“éªŒååˆ†çš„å‹å¥½ã€‚</p>\n<h2 id=\"22-ç±»å‹ä½“æ“\">2.2 ç±»å‹ä½“æ“</h2>\n<p>å…¶å®é€šè¿‡ TypeScript å¼€å‘å’Œ JavaScript å¼€å‘åŒºåˆ«å¹¶ä¸å¤§ï¼Œæ— éå°±æ˜¯åŠ ä¸€äº›ç±»å‹æ³¨è§£ã€‚ä½†æ˜¯æˆ‘ä¹‹æ‰€ä»¥ä½¿ç”¨ TypeScript ï¼Œè¿˜æ˜¯å¸Œæœ›é€šè¿‡ TypeScript å¼ºå¤§çš„ç±»å‹æç¤ºå¯ä»¥è®©ç”¨æˆ·å‡å°‘çœ‹æ–‡æ¡£çš„æ—¶é—´ã€‚</p>\n<p>ä¸¾ä¸ªä¾‹å­ï¼ŒSDK é€šè¿‡ å‘å¸ƒè®¢é˜… åˆ†å‘äº‹ä»¶ï¼Œä¸åŒçš„äº‹ä»¶çš„è¿”å›å€¼æ˜¯ä¸åŒçš„ã€‚ æˆ‘æƒ³å®ç°çš„æ•ˆæœæ˜¯ç”¨æˆ·è®¢é˜…ä¸åŒçš„äº‹ä»¶æ—¶ï¼Œç±»å‹æé†’å¯ä»¥è¿”å›å¯¹åº”äº‹ä»¶çš„å€¼ã€‚</p>\n<p>çµæ„Ÿæ¥æºï¼š <a href=\"https://twitter.com/mattpocockuk/status/1549721729630625799\">https://twitter.com/mattpocockuk/status/1549721729630625799</a></p>\n<p>æƒ³æ³•å¾ˆç®€å•ï¼Œå®ç°æœ‰ç‚¹éš¾ã€‚è¿™é‡Œæˆ‘å‚è€ƒäº†ä¸Šé¢æ¨æ–‡çš„ä¾‹å­ï¼š<a href=\"https://www.typescriptlang.org/play?#code/JYWwDg9gTgLgBAbzgMTgXzgMyhEcBEMAzgLQwQQA2ARgKaUz4DcAUCzAJ5i1wBCAhkVoAlCAFcYtKAGEIAO0zAA5nAC8cYbQDG0ACYAeIjCjA5SgDSI4Q-lC0ALAPwAua8dNKA2gF10APlYWHTkjOBB+AGsRcUkoNTh9ABVZBWU4WgAPSTldIj5BaIkpFMUlPwAKFjg4AH1g0tdkADoAOVscAHckkuU-cxYASjU-RCq4KFoYMSg5UerqpQhEiFck0SL0rNocvKiOCEw4ZPlSy0SAZVpbB3jj1K9E9clvT3wbO3t8bwqx+fGY2iuR4A-p-arvBwuI6Xa72TbZXJuExmHy-MGOKyeGEfAAKtn4eFM0KuH08cjEIDoUG83ihRmRKjQaL+rjktAAblJQfMhqoRghmXBKJM4GyOk8eOpzu4zOUcEUBoEwXBgIdyhD7EMBcrqmKJXAANTqMVwACqwgAMtiHHioASiJUdfMNXBBBptHpDDKLEiPH1BdUBk1yNKGeVFYKmcqOqZdBAOk1KBAtPwYMB5E17BNDsbaOKAaw-mhuWhWKW2MFQvLJHl1OEohKoOVtQQAPT4VwIYtjfCt3SCezUCC2XQdubOkkOVyvMD8JS0fCWfDcKB4+eLghEXCTeweL4l-poCMsau0IhNRbLcq9-tEQfDqCjywt2fz1z4ACMi7GW5AO4877fkegSnuel4QNe7YRkAA\">makeRouter</a>ï¼Œè¿™ä¸ªä¾‹å­é€šè¿‡ è·¯ç”±é…ç½® è®©è¿”å›çš„è·¯ç”±å®ä¾‹èƒ½å¤Ÿæ­£ç¡®æé†’è·¯ç”±æ‰€å¯¹åº”çš„query.</p>\n<p>æˆ‘æœ€ç»ˆå®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-ts\">import { F } from &quot;ts-toolbelt&quot;;\n\ntype BaseEventConfig = Record&lt;string, string[]&gt;\n\nconst makeEvents= &lt;TConfig extends BaseEventConfig&gt;(_config: F.Narrow&lt;TConfig&gt;) =&gt; ({\n    $on: &lt;EventName extends keyof TConfig, Response = TConfig[EventName]&gt;(eventName: EventName, callback: ResCallback&lt; Response extends string[] ? { [SearchParam in Response[number]]?: string } : never, EventName&gt; ):void =&gt; {\n    \n    }\n\n})\n\ntype ResCallback&lt;T, E&gt; = (e: {\n    data: T\n    preventDefault: () =&gt; void\n    type: E\n}) =&gt; void\n\n// test\n\nlet emitter = makeEvents({\n    &#39;page:change1&#39;: [&quot;pageName&quot;,&quot;pageParams&quot;,&quot;pageTitle&quot;,&quot;rid&quot;],\n    &#39;page:change2&#39;: [&quot;aadfa1&quot;,&quot;bbb1&quot;]\n})\n\nemitter.$on(&#39;page:change1&#39;, e =&gt; {\n    e.data.pageName\n    e.data.pageParams\n    e.data.pageTitle\n    e.data.rid\n})\n\nemitter.$on(&#39;page:change2&#39;, e =&gt; {\n    e.data.aadfa1\n    e.data.bbb1\n})\n</code></pre>\n<p>åˆ©ç”¨ ç±»å‹æ”¶ç´§å’Œæ³›å‹ï¼Œæˆ‘åœ¨ TypeScript ä¼ å…¥ç›¸å…³äº‹ä»¶çš„é…ç½®ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨æ—¶å°±èƒ½ä»ä¸åŒçš„äº‹ä»¶å¾—åˆ°ä¸é€šçš„ç±»å‹æç¤ºï¼Œthat&#39;s  cool!</p>\n<h2 id=\"23-ä½¿ç”¨åœºæ™¯\">2.3 ä½¿ç”¨åœºæ™¯</h2>\n<p>ç”¨æˆ·åœ¨ä½¿ç”¨SDKæ—¶ä¸€èˆ¬æœ‰ä¸¤ç§åœºæ™¯ï¼Œä¸€ç§æ˜¯åœ¨ç°æœ‰HTMLé‡ŒåµŒå…¥è‡ªèº«é€»è¾‘ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯é€šè¿‡ iframe åµŒå…¥æˆ‘ä»¬çš„ç‰©æ–™ï¼Œç„¶ååœ¨ iframe å¤–éƒ¨å†™è‡ªå·±çš„é€»è¾‘ã€‚</p>\n<p>ç¬¬ä¸€ç§æ–¹å¼SDKæ˜¯èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨çš„ï¼Œä½†æ˜¯é€šè¿‡ iframe æ–¹å¼ï¼ŒSDKå¹¶ä¸èƒ½ç”Ÿæ•ˆã€‚å› ä¸ºæˆ‘ä»¬çš„SDKæ˜¯é€šè¿‡æ‹¦æˆª window ä¸Šçš„äº‹ä»¶è¿›è¡Œé‡å†™ï¼Œåœ¨è¿›è¡Œäº‹ä»¶åˆ†å‘ã€‚iframe æ¨¡å¼çš„ window å¹¶ä¸ä¸€è‡´ï¼Œæ‰€ä»¥SDKæ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚</p>\n<p>å…¼å®¹ä¹Ÿå¾ˆç®€å•ï¼Œæä¾›ä¸€ä¸ªæ–¹æ³•è¿›è¡Œåˆå§‹åŒ–</p>\n<pre><code class=\"language-ts\">SDK.init()\n</code></pre>\n<p>ä¸ä¼ å€¼çš„æƒ…å†µå°±ä½¿ç”¨å½“å‰ windowï¼Œæ‹¦æˆªç›¸å…³å‡½æ•°ã€‚ ä¼ å€¼æ—¶å°±ä¼ å…¥å¯¹åº”çš„iframe DOMå³å¯ã€‚</p>\n<pre><code class=\"language-ts\">SDK.init(iframe)\n//\ninit(iframe) {\n    let global = window\n    if(iframe) {\n        global = iframe.contentWindow\n    } \n    registProxy(global)\n}\n</code></pre>\n<p>è¿™æ ·æˆ‘ä»¬çš„SDKæ—¢èƒ½æ”¯æŒå½“å‰ç‰©æ–™çš„å¼€å‘ï¼Œä¹Ÿèƒ½æ”¯æŒiframeåµŒå…¥</p>\n<h2 id=\"24-å‘å¸ƒ\">2.4 å‘å¸ƒ</h2>\n<p>ä½œä¸ºSDK,é€šè¿‡å…¨å±€å˜é‡çš„å½¢å¼æš´éœ²å¯¹äºå¼€å‘è€…æ˜¯ä¸å‹å¥½çš„ï¼Œæ›´å¥½çš„æ–¹å¼æ˜¯å‘å¸ƒåˆ° npm ä¸Šæä¾›ç»™å¼€å‘è€…ä¸‹è½½</p>\n<ol>\n<li>æ³¨å†Œè´¦å·ï¼Œå¯ä»¥æ·»åŠ ç»„ç»‡ï¼Œè®©åŒ…åæ‹¥æœ‰scope</li>\n<li>package.json é…ç½®åŒ…ä¿¡æ¯ï¼Œå…¥å£æ–‡ä»¶</li>\n<li>é…ç½®.npmignore, å¿½ç•¥ä¸Šä¼ æ–‡ä»¶</li>\n<li>npm login</li>\n<li>npm publish(ç»„ç»‡åŒ…ï¼Œéœ€è¦æ‰§è¡Œ npm publish --access public)</li>\n</ol>\n<p>æ›´æ–°ç‰ˆæœ¬æ—¶ï¼Œå…ˆ npm version patch å† publish</p>\n<h1 id=\"ä¸‰-æ–‡æ¡£\">ä¸‰. æ–‡æ¡£</h1>\n<p>å…¶å®æœ‰äº† TypeScript å’Œç›¸å…³æ³¨é‡Šï¼Œç”¨æˆ·åœ¨è¿›è¡Œå¼€å‘æ—¶ä¸å€ŸåŠ©æ–‡æ¡£ä¹Ÿèƒ½å¤Ÿå¾ˆå¥½çš„å¼€å‘ã€‚ä½†æ˜¯æ–‡æ¡£è¿˜æ˜¯å¾ˆé‡è¦çš„ã€‚</p>\n<p>å½“ç”¨æˆ·æƒ³æ¥å…¥æˆ‘ä»¬çš„SDKæ—¶ï¼Œä»–æ¥è§¦çš„ç¬¬ä¸€ä¸ªä¸œè¥¿è‚¯å®šæ˜¯æ–‡æ¡£ã€‚æ–‡æ¡£å¯ä»¥å‘Šè¯‰ä»– SDK èƒ½å¤Ÿæä¾›çš„èƒ½åŠ›ï¼Œå·²ç»å¦‚ä½•è¿›è¡Œæ¥å…¥ã€‚</p>\n<p>å†™æ–‡æ¡£çš„ç¡®å¾ˆçƒ¦ï¼Œä½†å½“æˆ‘ä»¬è‡ªå·±å¼€å‘æ—¶åˆå¸Œæœ›å…¶ä»–äººå†™æ–‡æ¡£ã€‚å¾ˆçŸ›ç›¾ï¼Œåˆå¾ˆçœŸå®ã€‚</p>\n<p>æ–‡æ¡£çš„ç»“æ„æˆ‘å€Ÿé‰´äº†å¸¸ç”¨çš„æ–‡æ¡£æ¨¡å¼ã€‚</p>\n<ol>\n<li>åŠŸèƒ½ä»‹ç»</li>\n<li>å®‰è£…</li>\n<li>å¿«é€Ÿä½¿ç”¨</li>\n<li>äº‹ä»¶</li>\n<li>æ¨¡å—</li>\n</ol>\n<p>å†™å®Œè¿™äº›ï¼Œå¿«é€Ÿå¯¹æ¥åŸºæœ¬ä¸Šæ²¡å•¥é—®é¢˜äº†ã€‚</p>\n<h1 id=\"å››-ç•Œé™\">å››. ç•Œé™</h1>\n<p>å†™ SDK çš„ä¸»è¦ç›®çš„æ—¶æš´éœ²è‡ªèº«çš„èƒ½åŠ›ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ³¨æ„èƒ½åŠ›çš„ç•Œé™ã€‚</p>\n<p>ä¾‹å¦‚ç”¨æˆ·åœ¨ä½¿ç”¨æˆ‘ä»¬çš„SDKæ—¶æƒ³è¦è¿›è¡Œæ•°æ®åŸ‹ç‚¹ï¼Œè·å–è®¿é—®ç”¨æˆ·çš„IP. è¿™ä¸ªèƒ½åŠ›å°±ä¸åº”è¯¥ç”±æˆ‘ä»¬æä¾›ï¼Œè€Œæ˜¯ç”¨æˆ·è‡ªå·±ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æ¥å¼€å‘ã€‚</p>\n<p>SDKçš„ç›®çš„å°±æ˜¯é™ä½è€¦åˆï¼Œå³ä½¿SDKå†…éƒ¨æœ‰æŸäº›èƒ½åŠ›ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿè¦è€ƒè™‘æ˜¯å¦éœ€è¦å¼€æ”¾ã€‚</p>\n<h1 id=\"äº”-å†™åœ¨æœ€å\">äº”. å†™åœ¨æœ€å</h1>\n<p>SDK çš„å¼€å‘ç»éªŒè¿˜æ˜¯å¾ˆå®è´µçš„ï¼Œæˆ‘ä¹Ÿä»ä¸­å­¦ä¹ åˆ°äº†å¾ˆå¤šä¸œè¥¿ã€‚æˆ‘ä¹Ÿé€šè¿‡è¿™ä¸ªä¸šåŠ¡å°†å¹³æ—¶æ‰€å­¦åˆ°çš„ä¸œè¥¿è¿›è¡Œäº†å®è·µã€‚</p>\n",
        "title": "æä¾›ä¸šåŠ¡èƒ½åŠ›ï¼ŒSDKçš„å¼€å‘ï¼ˆäºŒï¼‰",
        "created": "2022-08-07 03:55:39  ",
        "updated": "2022-08-09 15:15:54 ",
        "excerpt": "ä¸€. å†™åœ¨å‰é¢ ä¹‹å‰æ–‡ç« è®²äº† SDKå¼€å‘çš„èƒŒæ™¯ï¼Œå’Œå…·ä½“å°è£…çš„é€»è¾‘ã€‚æœ€è¿‘æœ‰ç”¨æˆ·ä½¿ç”¨æˆ‘çš„SDKè¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œå¯¹æ¥çš„è¿‡ç¨‹ä¸­æˆ‘å‘ç°SDKå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚ ä½¿ç”¨æ–¹å¼ï¼Œå¯¹æ¥æ–¹å¼ã€‚å› æ­¤æˆ‘æ ¹æ®è¿™äº›é—®é¢˜ï¼Œå°†SDKè¿›è¡Œäº†é‡æ„ã€‚ äºŒ. é‡æ„ æ¡†æ¶é€šè¿‡æš´éœ²å…¨å±€å‡½...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "23"
    },
    "24": {
        "content": "<h1 id=\"å†™åœ¨å‰é¢\">å†™åœ¨å‰é¢</h1>\n<p>å›½åº†å‡æœŸåŸºæœ¬æ²¡å‡ºå»ç©ï¼Œå­¦ä¹ äº†ä¸‹Astro å’Œ Solidã€‚è¿™ç¯‡æ–‡ç« å°±æ¥å…·ä½“è®²ä¸‹ Solid  çš„å¼€å‘ä½“éªŒï¼Œè¿˜æœ‰å’ŒVue ,Reactçš„æ¡†æ¶åŒºåˆ«</p>\n<h1 id=\"react-like\">React Like</h1>\n<pre><code class=\"language-tsx\">const [count, setCount] = createSignal(0)\n</code></pre>\n<p>çœ‹åˆ°è¯­æ³•çš„ç¬¬ä¸€çœ¼ï¼Œå°±ä¼šæ„Ÿåˆ°ååˆ†çœ¼ç†Ÿã€‚è¿™ä¸æ˜¯ Reactå—ï¼Ÿ </p>\n<p>ä»è¯­æ³•ä¸Šæ¥è¯´ï¼ŒSolid å’Œ React ååˆ†ç›¸ä¼¼ï¼Œä½†ç¡®æœ‰æ ¹æœ¬ä¸Šçš„ä¸åŒã€‚</p>\n<p>åœ¨ Solid ä¸­å£°æ˜å“åº”å¼å˜é‡éœ€è¦ç”¨åˆ° <code>createSignal</code>.  ä¸ React çš„ <code>useState</code> ä¸åŒçš„æ˜¯ï¼Œè¿”å›çš„ç¬¬ä¸€ä¸ªå€¼ä¸ºå‡½æ•°ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå€¼ã€‚</p>\n<p>React ä¸ºäº†å®ç°ç»„ä»¶ä¸­æ•°æ®çš„æ›´æ–°ï¼Œåˆ©ç”¨å¤šæ¬¡é—­åŒ…åŠ é“¾è¡¨å®ç°äº† Hooks ,ä½†æ˜¯ Hooks å­˜åœ¨çš„é—­åŒ…é™·é˜±å’Œå¿…é¡»é¡¶å±‚ä½¿ç”¨æ˜¯æ— æ³•è¿›è¡Œé¿å…çš„ã€‚</p>\n<p>Solid ä¸­ç›´æ¥è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨å‡½æ•°è·å–çœŸå®çš„å€¼ï¼Œå®Œå…¨æ²¡æœ‰ React hook å­˜åœ¨çš„é—®é¢˜ã€‚è¿™é‡Œæœ‰ç‚¹åƒ Vue3 ï¼Œä½†æ˜¯æ¯” Vue3  æ›´ç®€æ´ã€‚</p>\n<h1 id=\"reactive\">Reactive</h1>\n<p>åœ¨ç»„ä»¶æ›´æ–°ä¸Šï¼ŒSolidçš„å¤„ç†æ–¹å¼å’Œ React æœ‰å¾ˆå¤§çš„åŒºåˆ«</p>\n<p>React å‡½æ•°ç»„ä»¶ä¸­ï¼Œ é€šè¿‡ setState è§¦å‘å‡½æ•°å†æ¬¡æ‰§è¡Œå‡½æ•°ï¼Œå®ç°ç»„ä»¶æ›´æ–°ã€‚</p>\n<p>è€Œ Solid å‡½æ•°ç»„ä»¶ä¸­çš„ä»£ç åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œç»„ä»¶çš„æ›´æ–°ä¾èµ–äºå“åº”å¼æ•°æ®ã€‚Solid å®ç°äº†å’ŒVue ç±»ä¼¼çš„æ–¹å¼ï¼Œè¿›è¡Œäº†ä¾èµ–æ”¶é›†ã€‚å½“æ•°æ®å˜åŒ–æ—¶ï¼Œç»„ä»¶å°±ä¼šè¿›è¡Œæ›´æ–°ã€‚</p>\n<pre><code class=\"language-tsx\">...\nconst [count, setCount] = createSignal(0)\n\nreturn &lt;div onClick={() =&gt; setCount(prev =&gt; prev+1)}&gt;{count()}&lt;/div&gt;\n...\n</code></pre>\n<p>ç”±äºæ˜¯ç›´æ¥ä½¿ç”¨å‡½æ•°ï¼Œ<code>useMemo</code> åœ¨Solid ä¸­å˜å¾—å¾ˆç®€å•</p>\n<pre><code class=\"language-tsx\">const [count, setCount] = createSignal(0)\nconst doubleCount = () =&gt; count() * 2\n\nreturn &lt;div onClick={() =&gt; setCount(prev =&gt; prev+1)}&gt;{doubleCount()}&lt;/div&gt;\n</code></pre>\n<p>ä¸å¾—ä¸è¯´ï¼Œè¿™æ ·çš„å®ç°ååˆ†ä¼˜ç¾</p>\n<h1 id=\"âŒ-virtual-dom\">âŒ Virtual DOM</h1>\n<p>Solid è¿˜æ¯”è¾ƒä¸åŒçš„åœ°æ–¹ï¼Œå°±åœ¨äºDOMçš„æ›´æ–°ç­–ç•¥ä¸Šã€‚</p>\n<p>Solid å¹¶æ²¡æœ‰ä½¿ç”¨ è™šæ‹ŸDOM, è€Œæ˜¯åŸºäºçœŸå®DOMè¿›è¡Œæ“ä½œã€‚Solid å°†DOMçš„å˜åŒ–é¢—ç²’åŒ–ï¼Œå“åº”å¼æ•°æ®çš„å˜åŒ–åªå¯¹ä¾èµ–çš„Nodeèµ·ä½œç”¨ã€‚è€Œä¸æ˜¯åƒè™šæ‹ŸDOM ä¸€æ ·ç»„ä»¶é‡æ–°æ›´æ–°å†æ¯”è¾ƒå·®å¼‚è¿›è¡Œ patch</p>\n<p>è¿™æ˜¯ä¸€æ®µSolid ä»£ç </p>\n<pre><code class=\"language-tsx\">function Counter() {\n    const [count, setCount] = createSignal(0);\n    const increment = () =&gt; setCount(count() + 1);\n      \n    return (\n    &lt;button type=&quot;button&quot; onClick={increment}&gt;\n        {count()}\n        &lt;span&gt;{count() * 2}&lt;/span&gt;\n    &lt;/button&gt;\n    );\n\n}\n</code></pre>\n<p>ç¼–è¯‘åçš„ä»£ç </p>\n<pre><code class=\"language-ts\">const _tmpl$ = /*#__PURE__*/template(`&lt;button type=&quot;button&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/button&gt;`, 4);\nfunction Counter() {\n    const [count, setCount] = createSignal(0);\n    const increment = () =&gt; setCount(count() + 1);\n    return (() =&gt; {\n        const _el$ = _tmpl$.cloneNode(true),\n        \n        _el$2 = _el$.firstChild;\n        \n        _el$.$$click = increment;\n        \n        insert(_el$, count, _el$2);\n        insert(_el$2, () =&gt; count() * 2);\n    return _el$;\n    })();\n\n}\n</code></pre>\n<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå…¶å®å‡½æ•°ç»„ä»¶å°±è¿”å›äº†ä¸€ä¸ªDOMã€‚åç»­æ•°æ®çš„å˜åŒ–åªä¼šå½±å“åˆ°æ”¶é›†åˆ°DOMï¼Œè¿™ä¸€ç‚¹ååˆ†å·§å¦™ã€‚</p>\n<h1 id=\"å†™åœ¨æœ€å\">å†™åœ¨æœ€å</h1>\n<p>ä½¿ç”¨è¿‡Vue, Reactåï¼Œæ¥å­¦ä¹  Solid æœ‰ä¸€ç§å¥‡å¦™çš„æ„Ÿè§‰ã€‚Solid ä½¿ç”¨äº†ä¸¤ä¸ªå‰è¾ˆçš„å„è‡ªä¼˜ç‚¹ï¼Œåˆæœ‰è‡ªå·±çš„ç‹¬ç‰¹ä¹‹å¤„ã€‚</p>\n<p>ç¬¬ä¸€çœ¼çœ‹åˆ° Solid æ—¶ï¼Œæ„Ÿè§‰æ˜¯React. å…·ä½“è¿›è¡Œä½¿ç”¨æ—¶ï¼Œåˆæ„Ÿè§‰æ˜¯ Vue. åˆ°äº†æœ€åï¼Œæ‰å‘ç°Solid å°±æ˜¯ Solid.</p>\n<p>è¿™ç¯‡æ–‡ç« å¤§æ¦‚è®²äº†ä¸‹ Solid, å…¶å®ä¹Ÿæ²¡æœ‰è®²å…·ä½“ç”¨æ³•ã€‚åç»­ä¼šæ›´æ–°å…·ä½“çš„ä½¿ç”¨å’Œç›¸å…³ç”Ÿæ€ã€‚</p>\n",
        "title": "Solid ä½¿ç”¨ä½“éªŒ",
        "created": "2022-10-07 12:50:24  ",
        "updated": "2022-10-07 12:50:24 ",
        "excerpt": "å†™åœ¨å‰é¢ å›½åº†å‡æœŸåŸºæœ¬æ²¡å‡ºå»ç©ï¼Œå­¦ä¹ äº†ä¸‹Astro å’Œ Solidã€‚è¿™ç¯‡æ–‡ç« å°±æ¥å…·ä½“è®²ä¸‹ Solid çš„å¼€å‘ä½“éªŒï¼Œè¿˜æœ‰å’ŒVue ,Reactçš„æ¡†æ¶åŒºåˆ« React Like `tsx const [count, setCount] = cr...",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "24"
    },
    "25": {
        "content": "<p>WIP</p>\n",
        "title": "Module Federation è¯¦è§£",
        "created": "2022-10-24 11:50:59  ",
        "updated": "2022-10-24 11:50:59 ",
        "excerpt": "WIP",
        "avatar": "https://avatars.githubusercontent.com/u/26271337?v=4",
        "id": "25"
    }
}